diff --git a/node_modules/@sendbird/uikit-react/App.js b/node_modules/@sendbird/uikit-react/App.js
index 36ac9a0..d1fd121 100644
--- a/node_modules/@sendbird/uikit-react/App.js
+++ b/node_modules/@sendbird/uikit-react/App.js
@@ -86,7 +86,7 @@ import './ThreadProvider-ab67609d.js';
 import './Thread/context/types.js';
 import './ui/DateSeparator.js';
 import './ui/MessageInput.js';
-import 'react-dom/server';
+import 'react-dom/server.js';
 import './ui/MessageContent.js';
 import './ui/MessageItemMenu.js';
 import './ui/MessageItemReactionMenu.js';
diff --git a/node_modules/@sendbird/uikit-react/CHANGELOG.md b/node_modules/@sendbird/uikit-react/CHANGELOG.md
index 33133f3..04830e4 100644
--- a/node_modules/@sendbird/uikit-react/CHANGELOG.md
+++ b/node_modules/@sendbird/uikit-react/CHANGELOG.md
@@ -268,7 +268,7 @@ Dev. Env:
 * Install `testing-library` (`@testing-library/react` and `@testing-library/jest-dom`)
 * Migrate every tests with `testing-library` instead of the `enzyme` and `react-test-renderer
 * Replace node-sass with sass(Dart Sass)
-* Reduce bundle size by treating react-dom/server as external
+* Reduce bundle size by treating react-dom/server.js as external
 
 ## [v3.1.3] (Sep 19 2022)
 
diff --git a/node_modules/@sendbird/uikit-react/Channel.js b/node_modules/@sendbird/uikit-react/Channel.js
index c65d958..35a64d0 100644
--- a/node_modules/@sendbird/uikit-react/Channel.js
+++ b/node_modules/@sendbird/uikit-react/Channel.js
@@ -48,7 +48,7 @@ import '@sendbird/chat';
 import './ui/DateSeparator.js';
 import './color-36e07432.js';
 import './ui/MessageInput.js';
-import 'react-dom/server';
+import 'react-dom/server.js';
 import './ui/Button.js';
 import './ui/MentionUserLabel.js';
 import './ui/MessageContent.js';
diff --git a/node_modules/@sendbird/uikit-react/Channel/components/ChannelUI.js b/node_modules/@sendbird/uikit-react/Channel/components/ChannelUI.js
index 8b8dd08..ebd7e29 100644
--- a/node_modules/@sendbird/uikit-react/Channel/components/ChannelUI.js
+++ b/node_modules/@sendbird/uikit-react/Channel/components/ChannelUI.js
@@ -51,7 +51,7 @@ import '@sendbird/chat';
 import '../../ui/DateSeparator.js';
 import '../../color-36e07432.js';
 import '../../ui/MessageInput.js';
-import 'react-dom/server';
+import 'react-dom/server.js';
 import '../../ui/Button.js';
 import '../../ui/MentionUserLabel.js';
 import '../../ui/MessageContent.js';
diff --git a/node_modules/@sendbird/uikit-react/Channel/components/Message.js b/node_modules/@sendbird/uikit-react/Channel/components/Message.js
index ccc8dab..b1bcf42 100644
--- a/node_modules/@sendbird/uikit-react/Channel/components/Message.js
+++ b/node_modules/@sendbird/uikit-react/Channel/components/Message.js
@@ -37,7 +37,7 @@ import '../../ui/SortByRow.js';
 import '../../stringSet-90d297f1.js';
 import '../../ui/ReactionButton.js';
 import '../../color-36e07432.js';
-import 'react-dom/server';
+import 'react-dom/server.js';
 import '../../ui/IconButton.js';
 import '../../ui/Button.js';
 import '../../ui/MentionUserLabel.js';
diff --git a/node_modules/@sendbird/uikit-react/Channel/components/MessageInput.js b/node_modules/@sendbird/uikit-react/Channel/components/MessageInput.js
index 22fc68e..8a4d181 100644
--- a/node_modules/@sendbird/uikit-react/Channel/components/MessageInput.js
+++ b/node_modules/@sendbird/uikit-react/Channel/components/MessageInput.js
@@ -28,7 +28,7 @@ import '../../stringSet-90d297f1.js';
 import '../../ui/ReactionButton.js';
 import '../../ui/ImageRenderer.js';
 import '../../ui/Icon.js';
-import 'react-dom/server';
+import 'react-dom/server.js';
 import '../../ui/IconButton.js';
 import '../../ui/Button.js';
 import '../../ui/MentionUserLabel.js';
diff --git a/node_modules/@sendbird/uikit-react/Channel/components/MessageList.js b/node_modules/@sendbird/uikit-react/Channel/components/MessageList.js
index a404f62..0d45cc3 100644
--- a/node_modules/@sendbird/uikit-react/Channel/components/MessageList.js
+++ b/node_modules/@sendbird/uikit-react/Channel/components/MessageList.js
@@ -38,7 +38,7 @@ import '@sendbird/chat';
 import '../../ui/DateSeparator.js';
 import '../../color-36e07432.js';
 import '../../ui/MessageInput.js';
-import 'react-dom/server';
+import 'react-dom/server.js';
 import '../../ui/IconButton.js';
 import '../../ui/Button.js';
 import '../../ui/MentionUserLabel.js';
diff --git a/node_modules/@sendbird/uikit-react/OpenChannel.js b/node_modules/@sendbird/uikit-react/OpenChannel.js
index 0bb2147..307fbdb 100644
--- a/node_modules/@sendbird/uikit-react/OpenChannel.js
+++ b/node_modules/@sendbird/uikit-react/OpenChannel.js
@@ -7,7 +7,7 @@ import './stringSet-90d297f1.js';
 import './index-8e552833.js';
 import './ui/MessageInput.js';
 import './_rollupPluginBabelHelpers-16667c95.js';
-import 'react-dom/server';
+import 'react-dom/server.js';
 import 'prop-types';
 import './const-5b3992dc.js';
 import './const-dd057875.js';
diff --git a/node_modules/@sendbird/uikit-react/OpenChannel/components/OpenChannelInput.js b/node_modules/@sendbird/uikit-react/OpenChannel/components/OpenChannelInput.js
index 01bd7ce..a2bd41d 100644
--- a/node_modules/@sendbird/uikit-react/OpenChannel/components/OpenChannelInput.js
+++ b/node_modules/@sendbird/uikit-react/OpenChannel/components/OpenChannelInput.js
@@ -5,7 +5,7 @@ import { u as useOpenChannelContext } from '../../OpenChannelProvider-0c024af9.j
 import '../../stringSet-90d297f1.js';
 import '../../index-8e552833.js';
 import '../../_rollupPluginBabelHelpers-16667c95.js';
-import 'react-dom/server';
+import 'react-dom/server.js';
 import 'prop-types';
 import '../../const-5b3992dc.js';
 import '../../const-dd057875.js';
diff --git a/node_modules/@sendbird/uikit-react/OpenChannel/components/OpenChannelMessage.js b/node_modules/@sendbird/uikit-react/OpenChannel/components/OpenChannelMessage.js
index 73bea3f..fb972ef 100644
--- a/node_modules/@sendbird/uikit-react/OpenChannel/components/OpenChannelMessage.js
+++ b/node_modules/@sendbird/uikit-react/OpenChannel/components/OpenChannelMessage.js
@@ -44,7 +44,7 @@ import '../../ui/Word.js';
 import '../../ui/MentionLabel.js';
 import '../../ui/TextButton.js';
 import '../../color-36e07432.js';
-import 'react-dom/server';
+import 'react-dom/server.js';
 import '../../const-5b3992dc.js';
 import '../../const-dd057875.js';
 import '../../ui/MentionUserLabel.js';
diff --git a/node_modules/@sendbird/uikit-react/OpenChannel/components/OpenChannelMessageList.js b/node_modules/@sendbird/uikit-react/OpenChannel/components/OpenChannelMessageList.js
index fa3887e..61bf34a 100644
--- a/node_modules/@sendbird/uikit-react/OpenChannel/components/OpenChannelMessageList.js
+++ b/node_modules/@sendbird/uikit-react/OpenChannel/components/OpenChannelMessageList.js
@@ -49,7 +49,7 @@ import '../../ui/TextButton.js';
 import '../../color-36e07432.js';
 import '../../ui/DateSeparator.js';
 import '../../ui/MessageInput.js';
-import 'react-dom/server';
+import 'react-dom/server.js';
 import '../../const-5b3992dc.js';
 import '../../const-dd057875.js';
 import '../../ui/MentionUserLabel.js';
diff --git a/node_modules/@sendbird/uikit-react/OpenChannel/components/OpenChannelUI.js b/node_modules/@sendbird/uikit-react/OpenChannel/components/OpenChannelUI.js
index d50585a..2429243 100644
--- a/node_modules/@sendbird/uikit-react/OpenChannel/components/OpenChannelUI.js
+++ b/node_modules/@sendbird/uikit-react/OpenChannel/components/OpenChannelUI.js
@@ -21,7 +21,7 @@ import '../../_rollupPluginBabelHelpers-16667c95.js';
 import '../../LocalizationContext-3c8d4888.js';
 import '../../stringSet-90d297f1.js';
 import '../../ui/MessageInput.js';
-import 'react-dom/server';
+import 'react-dom/server.js';
 import '../../const-5b3992dc.js';
 import '../../const-dd057875.js';
 import '../../ui/IconButton.js';
diff --git a/node_modules/@sendbird/uikit-react/Thread.js b/node_modules/@sendbird/uikit-react/Thread.js
index 4982083..24e38d1 100644
--- a/node_modules/@sendbird/uikit-react/Thread.js
+++ b/node_modules/@sendbird/uikit-react/Thread.js
@@ -57,7 +57,7 @@ import './ui/FileViewer.js';
 import './ui/MessageItemMenu.js';
 import './ui/MessageItemReactionMenu.js';
 import './ui/MessageInput.js';
-import 'react-dom/server';
+import 'react-dom/server.js';
 import './ui/MentionUserLabel.js';
 import './Thread/components/ThreadHeader.js';
 import './Thread/components/ThreadList.js';
diff --git a/node_modules/@sendbird/uikit-react/Thread/components/ParentMessageInfo.js b/node_modules/@sendbird/uikit-react/Thread/components/ParentMessageInfo.js
index 15dfd13..a84721b 100644
--- a/node_modules/@sendbird/uikit-react/Thread/components/ParentMessageInfo.js
+++ b/node_modules/@sendbird/uikit-react/Thread/components/ParentMessageInfo.js
@@ -54,7 +54,7 @@ import '../../const-dd057875.js';
 import '../../ui/SortByRow.js';
 import '../../sendbirdSelectors.js';
 import '../../utils-c17213bb.js';
-import 'react-dom/server';
+import 'react-dom/server.js';
 import '../../ui/MentionUserLabel.js';
 
 function ParentMessageInfo(_a) {
diff --git a/node_modules/@sendbird/uikit-react/Thread/components/ThreadList.js b/node_modules/@sendbird/uikit-react/Thread/components/ThreadList.js
index 9c7d59a..e5b6ec5 100644
--- a/node_modules/@sendbird/uikit-react/Thread/components/ThreadList.js
+++ b/node_modules/@sendbird/uikit-react/Thread/components/ThreadList.js
@@ -43,7 +43,7 @@ import '../../withSendbird.js';
 import '../context/types.js';
 import '@sendbird/chat';
 import '../../ui/MessageInput.js';
-import 'react-dom/server';
+import 'react-dom/server.js';
 import '../../ui/MentionUserLabel.js';
 import '../../ui/UserProfile.js';
 import '../../sendbirdSelectors.js';
diff --git a/node_modules/@sendbird/uikit-react/Thread/components/ThreadListItem.js b/node_modules/@sendbird/uikit-react/Thread/components/ThreadListItem.js
index f2df2da..adb15c3 100644
--- a/node_modules/@sendbird/uikit-react/Thread/components/ThreadListItem.js
+++ b/node_modules/@sendbird/uikit-react/Thread/components/ThreadListItem.js
@@ -51,7 +51,7 @@ import '../../compareIds-5f127d04.js';
 import '../../const-dd057875.js';
 import '../../ui/ReactionButton.js';
 import '../../ui/SortByRow.js';
-import 'react-dom/server';
+import 'react-dom/server.js';
 import '../../ui/MentionUserLabel.js';
 import '../../sendbirdSelectors.js';
 import '../../utils-c17213bb.js';
diff --git a/node_modules/@sendbird/uikit-react/Thread/components/ThreadMessageInput.js b/node_modules/@sendbird/uikit-react/Thread/components/ThreadMessageInput.js
index db0ef44..e0ccfe7 100644
--- a/node_modules/@sendbird/uikit-react/Thread/components/ThreadMessageInput.js
+++ b/node_modules/@sendbird/uikit-react/Thread/components/ThreadMessageInput.js
@@ -10,7 +10,7 @@ import { u as useThreadContext } from '../../ThreadProvider-ab67609d.js';
 import { u as useLocalization } from '../../LocalizationContext-3c8d4888.js';
 import '../../withSendbird.js';
 import '../../_rollupPluginBabelHelpers-16667c95.js';
-import 'react-dom/server';
+import 'react-dom/server.js';
 import 'prop-types';
 import '../../const-dd057875.js';
 import '../../ui/IconButton.js';
diff --git a/node_modules/@sendbird/uikit-react/Thread/components/ThreadUI.js b/node_modules/@sendbird/uikit-react/Thread/components/ThreadUI.js
index 0f63056..e3abac6 100644
--- a/node_modules/@sendbird/uikit-react/Thread/components/ThreadUI.js
+++ b/node_modules/@sendbird/uikit-react/Thread/components/ThreadUI.js
@@ -60,7 +60,7 @@ import '../../ui/FileViewer.js';
 import '../../ui/MessageItemMenu.js';
 import '../../ui/MessageItemReactionMenu.js';
 import '../../ui/MessageInput.js';
-import 'react-dom/server';
+import 'react-dom/server.js';
 import '../../ui/MentionUserLabel.js';
 import './ThreadListItem.js';
 import '../../ui/DateSeparator.js';
diff --git a/node_modules/@sendbird/uikit-react/cjs/App.js b/node_modules/@sendbird/uikit-react/cjs/App.js
index 37cb79b..a9a556f 100644
--- a/node_modules/@sendbird/uikit-react/cjs/App.js
+++ b/node_modules/@sendbird/uikit-react/cjs/App.js
@@ -88,7 +88,7 @@ require('./ThreadProvider-50868a09.js');
 require('./Thread/context/types.js');
 require('./ui/DateSeparator.js');
 require('./ui/MessageInput.js');
-require('react-dom/server');
+require('react-dom/server.js');
 require('./ui/MessageContent.js');
 require('./ui/MessageItemMenu.js');
 require('./ui/MessageItemReactionMenu.js');
diff --git a/node_modules/@sendbird/uikit-react/cjs/Channel.js b/node_modules/@sendbird/uikit-react/cjs/Channel.js
index 5ee4666..466c4fa 100644
--- a/node_modules/@sendbird/uikit-react/cjs/Channel.js
+++ b/node_modules/@sendbird/uikit-react/cjs/Channel.js
@@ -50,7 +50,7 @@ require('@sendbird/chat');
 require('./ui/DateSeparator.js');
 require('./color-30f1bdcf.js');
 require('./ui/MessageInput.js');
-require('react-dom/server');
+require('react-dom/server.js');
 require('./ui/Button.js');
 require('./ui/MentionUserLabel.js');
 require('./ui/MessageContent.js');
diff --git a/node_modules/@sendbird/uikit-react/cjs/Channel/components/ChannelUI.js b/node_modules/@sendbird/uikit-react/cjs/Channel/components/ChannelUI.js
index 94d85c9..9b5c8ef 100644
--- a/node_modules/@sendbird/uikit-react/cjs/Channel/components/ChannelUI.js
+++ b/node_modules/@sendbird/uikit-react/cjs/Channel/components/ChannelUI.js
@@ -53,7 +53,7 @@ require('@sendbird/chat');
 require('../../ui/DateSeparator.js');
 require('../../color-30f1bdcf.js');
 require('../../ui/MessageInput.js');
-require('react-dom/server');
+require('react-dom/server.js');
 require('../../ui/Button.js');
 require('../../ui/MentionUserLabel.js');
 require('../../ui/MessageContent.js');
diff --git a/node_modules/@sendbird/uikit-react/cjs/Channel/components/Message.js b/node_modules/@sendbird/uikit-react/cjs/Channel/components/Message.js
index 8fa9af8..6a85204 100644
--- a/node_modules/@sendbird/uikit-react/cjs/Channel/components/Message.js
+++ b/node_modules/@sendbird/uikit-react/cjs/Channel/components/Message.js
@@ -39,7 +39,7 @@ require('../../ui/SortByRow.js');
 require('../../stringSet-5e01e582.js');
 require('../../ui/ReactionButton.js');
 require('../../color-30f1bdcf.js');
-require('react-dom/server');
+require('react-dom/server.js');
 require('../../ui/IconButton.js');
 require('../../ui/Button.js');
 require('../../ui/MentionUserLabel.js');
diff --git a/node_modules/@sendbird/uikit-react/cjs/Channel/components/MessageInput.js b/node_modules/@sendbird/uikit-react/cjs/Channel/components/MessageInput.js
index e7bd7cb..75563c4 100644
--- a/node_modules/@sendbird/uikit-react/cjs/Channel/components/MessageInput.js
+++ b/node_modules/@sendbird/uikit-react/cjs/Channel/components/MessageInput.js
@@ -30,7 +30,7 @@ require('../../stringSet-5e01e582.js');
 require('../../ui/ReactionButton.js');
 require('../../ui/ImageRenderer.js');
 require('../../ui/Icon.js');
-require('react-dom/server');
+require('react-dom/server.js');
 require('../../ui/IconButton.js');
 require('../../ui/Button.js');
 require('../../ui/MentionUserLabel.js');
diff --git a/node_modules/@sendbird/uikit-react/cjs/Channel/components/MessageList.js b/node_modules/@sendbird/uikit-react/cjs/Channel/components/MessageList.js
index 2fe5c6d..b4c8b85 100644
--- a/node_modules/@sendbird/uikit-react/cjs/Channel/components/MessageList.js
+++ b/node_modules/@sendbird/uikit-react/cjs/Channel/components/MessageList.js
@@ -40,7 +40,7 @@ require('@sendbird/chat');
 require('../../ui/DateSeparator.js');
 require('../../color-30f1bdcf.js');
 require('../../ui/MessageInput.js');
-require('react-dom/server');
+require('react-dom/server.js');
 require('../../ui/IconButton.js');
 require('../../ui/Button.js');
 require('../../ui/MentionUserLabel.js');
diff --git a/node_modules/@sendbird/uikit-react/cjs/OpenChannel.js b/node_modules/@sendbird/uikit-react/cjs/OpenChannel.js
index a8cffb5..e080f63 100644
--- a/node_modules/@sendbird/uikit-react/cjs/OpenChannel.js
+++ b/node_modules/@sendbird/uikit-react/cjs/OpenChannel.js
@@ -9,7 +9,7 @@ require('./stringSet-5e01e582.js');
 require('./index-cf3bc419.js');
 require('./ui/MessageInput.js');
 require('./_rollupPluginBabelHelpers-5ac4f130.js');
-require('react-dom/server');
+require('react-dom/server.js');
 require('prop-types');
 require('./const-02cb026d.js');
 require('./const-3f939a13.js');
diff --git a/node_modules/@sendbird/uikit-react/cjs/OpenChannel/components/OpenChannelInput.js b/node_modules/@sendbird/uikit-react/cjs/OpenChannel/components/OpenChannelInput.js
index f85317f..84b2734 100644
--- a/node_modules/@sendbird/uikit-react/cjs/OpenChannel/components/OpenChannelInput.js
+++ b/node_modules/@sendbird/uikit-react/cjs/OpenChannel/components/OpenChannelInput.js
@@ -7,7 +7,7 @@ var OpenChannel_context = require('../../OpenChannelProvider-734280b6.js');
 require('../../stringSet-5e01e582.js');
 require('../../index-cf3bc419.js');
 require('../../_rollupPluginBabelHelpers-5ac4f130.js');
-require('react-dom/server');
+require('react-dom/server.js');
 require('prop-types');
 require('../../const-02cb026d.js');
 require('../../const-3f939a13.js');
diff --git a/node_modules/@sendbird/uikit-react/cjs/OpenChannel/components/OpenChannelMessage.js b/node_modules/@sendbird/uikit-react/cjs/OpenChannel/components/OpenChannelMessage.js
index cd2ccf0..1945516 100644
--- a/node_modules/@sendbird/uikit-react/cjs/OpenChannel/components/OpenChannelMessage.js
+++ b/node_modules/@sendbird/uikit-react/cjs/OpenChannel/components/OpenChannelMessage.js
@@ -46,7 +46,7 @@ require('../../ui/Word.js');
 require('../../ui/MentionLabel.js');
 require('../../ui/TextButton.js');
 require('../../color-30f1bdcf.js');
-require('react-dom/server');
+require('react-dom/server.js');
 require('../../const-02cb026d.js');
 require('../../const-3f939a13.js');
 require('../../ui/MentionUserLabel.js');
diff --git a/node_modules/@sendbird/uikit-react/cjs/OpenChannel/components/OpenChannelMessageList.js b/node_modules/@sendbird/uikit-react/cjs/OpenChannel/components/OpenChannelMessageList.js
index 685820a..03d4ef2 100644
--- a/node_modules/@sendbird/uikit-react/cjs/OpenChannel/components/OpenChannelMessageList.js
+++ b/node_modules/@sendbird/uikit-react/cjs/OpenChannel/components/OpenChannelMessageList.js
@@ -51,7 +51,7 @@ require('../../ui/TextButton.js');
 require('../../color-30f1bdcf.js');
 require('../../ui/DateSeparator.js');
 require('../../ui/MessageInput.js');
-require('react-dom/server');
+require('react-dom/server.js');
 require('../../const-02cb026d.js');
 require('../../const-3f939a13.js');
 require('../../ui/MentionUserLabel.js');
diff --git a/node_modules/@sendbird/uikit-react/cjs/OpenChannel/components/OpenChannelUI.js b/node_modules/@sendbird/uikit-react/cjs/OpenChannel/components/OpenChannelUI.js
index 61ca7d5..0378413 100644
--- a/node_modules/@sendbird/uikit-react/cjs/OpenChannel/components/OpenChannelUI.js
+++ b/node_modules/@sendbird/uikit-react/cjs/OpenChannel/components/OpenChannelUI.js
@@ -23,7 +23,7 @@ require('../../_rollupPluginBabelHelpers-5ac4f130.js');
 require('../../LocalizationContext-fde44de7.js');
 require('../../stringSet-5e01e582.js');
 require('../../ui/MessageInput.js');
-require('react-dom/server');
+require('react-dom/server.js');
 require('../../const-02cb026d.js');
 require('../../const-3f939a13.js');
 require('../../ui/IconButton.js');
diff --git a/node_modules/@sendbird/uikit-react/cjs/Thread.js b/node_modules/@sendbird/uikit-react/cjs/Thread.js
index 63e4e52..9cbb34e 100644
--- a/node_modules/@sendbird/uikit-react/cjs/Thread.js
+++ b/node_modules/@sendbird/uikit-react/cjs/Thread.js
@@ -59,7 +59,7 @@ require('./ui/FileViewer.js');
 require('./ui/MessageItemMenu.js');
 require('./ui/MessageItemReactionMenu.js');
 require('./ui/MessageInput.js');
-require('react-dom/server');
+require('react-dom/server.js');
 require('./ui/MentionUserLabel.js');
 require('./Thread/components/ThreadHeader.js');
 require('./Thread/components/ThreadList.js');
diff --git a/node_modules/@sendbird/uikit-react/cjs/Thread/components/ParentMessageInfo.js b/node_modules/@sendbird/uikit-react/cjs/Thread/components/ParentMessageInfo.js
index 4242d13..0353990 100644
--- a/node_modules/@sendbird/uikit-react/cjs/Thread/components/ParentMessageInfo.js
+++ b/node_modules/@sendbird/uikit-react/cjs/Thread/components/ParentMessageInfo.js
@@ -56,7 +56,7 @@ require('../../const-3f939a13.js');
 require('../../ui/SortByRow.js');
 require('../../sendbirdSelectors.js');
 require('../../utils-63d69dc7.js');
-require('react-dom/server');
+require('react-dom/server.js');
 require('../../ui/MentionUserLabel.js');
 
 function _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }
diff --git a/node_modules/@sendbird/uikit-react/cjs/Thread/components/ThreadList.js b/node_modules/@sendbird/uikit-react/cjs/Thread/components/ThreadList.js
index 0c17b15..24b4dd4 100644
--- a/node_modules/@sendbird/uikit-react/cjs/Thread/components/ThreadList.js
+++ b/node_modules/@sendbird/uikit-react/cjs/Thread/components/ThreadList.js
@@ -45,7 +45,7 @@ require('../../withSendbird.js');
 require('../context/types.js');
 require('@sendbird/chat');
 require('../../ui/MessageInput.js');
-require('react-dom/server');
+require('react-dom/server.js');
 require('../../ui/MentionUserLabel.js');
 require('../../ui/UserProfile.js');
 require('../../sendbirdSelectors.js');
diff --git a/node_modules/@sendbird/uikit-react/cjs/Thread/components/ThreadListItem.js b/node_modules/@sendbird/uikit-react/cjs/Thread/components/ThreadListItem.js
index e7b7d52..627605b 100644
--- a/node_modules/@sendbird/uikit-react/cjs/Thread/components/ThreadListItem.js
+++ b/node_modules/@sendbird/uikit-react/cjs/Thread/components/ThreadListItem.js
@@ -53,7 +53,7 @@ require('../../compareIds-a376065f.js');
 require('../../const-3f939a13.js');
 require('../../ui/ReactionButton.js');
 require('../../ui/SortByRow.js');
-require('react-dom/server');
+require('react-dom/server.js');
 require('../../ui/MentionUserLabel.js');
 require('../../sendbirdSelectors.js');
 require('../../utils-63d69dc7.js');
diff --git a/node_modules/@sendbird/uikit-react/cjs/Thread/components/ThreadMessageInput.js b/node_modules/@sendbird/uikit-react/cjs/Thread/components/ThreadMessageInput.js
index 2db8116..1b75a3b 100644
--- a/node_modules/@sendbird/uikit-react/cjs/Thread/components/ThreadMessageInput.js
+++ b/node_modules/@sendbird/uikit-react/cjs/Thread/components/ThreadMessageInput.js
@@ -12,7 +12,7 @@ var Thread_context = require('../../ThreadProvider-50868a09.js');
 var LocalizationContext = require('../../LocalizationContext-fde44de7.js');
 require('../../withSendbird.js');
 require('../../_rollupPluginBabelHelpers-5ac4f130.js');
-require('react-dom/server');
+require('react-dom/server.js');
 require('prop-types');
 require('../../const-3f939a13.js');
 require('../../ui/IconButton.js');
diff --git a/node_modules/@sendbird/uikit-react/cjs/Thread/components/ThreadUI.js b/node_modules/@sendbird/uikit-react/cjs/Thread/components/ThreadUI.js
index b3ead12..722c86d 100644
--- a/node_modules/@sendbird/uikit-react/cjs/Thread/components/ThreadUI.js
+++ b/node_modules/@sendbird/uikit-react/cjs/Thread/components/ThreadUI.js
@@ -62,7 +62,7 @@ require('../../ui/FileViewer.js');
 require('../../ui/MessageItemMenu.js');
 require('../../ui/MessageItemReactionMenu.js');
 require('../../ui/MessageInput.js');
-require('react-dom/server');
+require('react-dom/server.js');
 require('../../ui/MentionUserLabel.js');
 require('./ThreadListItem.js');
 require('../../ui/DateSeparator.js');
diff --git a/node_modules/@sendbird/uikit-react/cjs/index.js b/node_modules/@sendbird/uikit-react/cjs/index.js
index 23a8efb..36a9561 100644
--- a/node_modules/@sendbird/uikit-react/cjs/index.js
+++ b/node_modules/@sendbird/uikit-react/cjs/index.js
@@ -72,7 +72,7 @@ require('./ui/FileViewer.js');
 require('./ui/MessageItemMenu.js');
 require('./ui/MessageItemReactionMenu.js');
 require('./ui/MessageInput.js');
-require('react-dom/server');
+require('react-dom/server.js');
 require('./ui/MentionUserLabel.js');
 require('./Thread/components/ThreadHeader.js');
 require('./Thread/components/ThreadList.js');
diff --git a/node_modules/@sendbird/uikit-react/cjs/ui/MessageInput.js b/node_modules/@sendbird/uikit-react/cjs/ui/MessageInput.js
index 23e3426..6a11262 100644
--- a/node_modules/@sendbird/uikit-react/cjs/ui/MessageInput.js
+++ b/node_modules/@sendbird/uikit-react/cjs/ui/MessageInput.js
@@ -2,7 +2,7 @@
 
 var _rollupPluginBabelHelpers = require('../_rollupPluginBabelHelpers-5ac4f130.js');
 var React = require('react');
-var server = require('react-dom/server');
+var server = require('react-dom/server.js');
 var PropTypes = require('prop-types');
 var _const$1 = require('../const-02cb026d.js');
 var _const = require('../const-3f939a13.js');
diff --git a/node_modules/@sendbird/uikit-react/cjs/ui/MessageInput.js.map b/node_modules/@sendbird/uikit-react/cjs/ui/MessageInput.js.map
index d1cc71f..3cc9c82 100644
--- a/node_modules/@sendbird/uikit-react/cjs/ui/MessageInput.js.map
+++ b/node_modules/@sendbird/uikit-react/cjs/ui/MessageInput.js.map
@@ -1 +1 @@
-{"version":3,"file":"MessageInput.js","sources":["../../../src/ui/MessageInput/index.jsx"],"sourcesContent":["import React, {\n  useRef,\n  useMemo,\n  useState,\n  useEffect,\n  useCallback,\n  useContext,\n} from 'react';\nimport { renderToString } from 'react-dom/server';\nimport PropTypes from 'prop-types';\n\nimport './index.scss';\nimport { MessageInputKeys, NodeNames, NodeTypes } from './const';\n\nimport { USER_MENTION_TEMP_CHAR } from '../../smart-components/Channel/context/const';\nimport IconButton from '../IconButton';\nimport Button, { ButtonTypes, ButtonSizes } from '../Button';\nimport MentionUserLabel from '../MentionUserLabel';\nimport Icon, { IconTypes, IconColors } from '../Icon';\nimport Label, { LabelTypography, LabelColors } from '../Label';\nimport { LocalizationContext } from '../../lib/LocalizationContext';\nimport {\n  arrayEqual,\n  getClassName,\n  StringObjType,\n  convertWordToStringObj,\n} from '../../utils';\n\nconst TEXT_FIELD_ID = 'sendbird-message-input-text-field';\nconst LINE_HEIGHT = 76;\nconst noop = () => { };\nconst handleUploadFile = (callback) => (event) => {\n  if (event.target.files && event.target.files[0]) {\n    callback(event.target.files[0]);\n  }\n  // eslint-disable-next-line no-param-reassign\n  event.target.value = '';\n};\n\nconst displayCaret = (element, position) => {\n  const range = document.createRange();\n  const sel = window.getSelection();\n  range.setStart(element.childNodes[0], position);\n  range.collapse(true);\n  sel.removeAllRanges();\n  sel.addRange(range);\n  element.focus();\n}\n\nconst resetInput = (ref) => {\n  try {\n    ref.current.innerHTML = '';\n  } catch {\n    //\n  }\n}\n\nconst initialTargetStringInfo = {\n  targetString: '',\n  startNodeIndex: null,\n  startOffsetIndex: null,\n  endNodeIndex: null,\n  endOffsetIndex: null,\n};\n\nconst MessageInput = React.forwardRef((props, ref) => {\n  const {\n    className,\n    messageFieldId,\n    isEdit,\n    isMentionEnabled,\n    disabled,\n    message,\n    placeholder,\n    maxLength,\n    onFileUpload,\n    onSendMessage,\n    onUpdateMessage,\n    onCancelEdit,\n    onStartTyping,\n    channelUrl,\n    mentionSelectedUser,\n    onUserMentioned,\n    onMentionStringChange,\n    onMentionedUserIdsUpdated,\n    onKeyUp,\n    onKeyDown,\n  } = props;\n  const textFieldId = messageFieldId || TEXT_FIELD_ID;\n  const { stringSet } = useContext(LocalizationContext);\n  const fileInputRef = useRef(null);\n  const [isInput, setIsInput] = useState(false);\n  const [mentionedUserIds, setMentionedUserIds] = useState([]);\n  const [targetStringInfo, setTargetStringInfo] = useState({ ...initialTargetStringInfo });\n  const setHeight = useMemo(() => (\n    () => {\n      try {\n        const elem = ref?.current;\n        const MAX_HEIGHT = window.document.body.offsetHeight * 0.6;\n        if (elem && elem.scrollHeight >= LINE_HEIGHT) {\n          if (MAX_HEIGHT < elem.scrollHeight) {\n            elem.style.height = 'auto';\n            elem.style.height = `${MAX_HEIGHT}px`;\n          } else {\n            elem.style.height = 'auto';\n            elem.style.height = `${elem.scrollHeight}px`;\n          }\n        } else {\n          elem.style.height = '';\n        }\n      } catch (error) {\n        // error\n      }\n    }\n  ), []);\n\n  // for easilly initialize input value from outside, but\n  // useEffect(_, [channelUrl]) erase it\n  const initialValue = props?.value;\n  useEffect(() => {\n    const textField = ref?.current;\n    try {\n      textField.innerHTML = initialValue;\n      displayCaret(textField, initialValue?.length);\n    } catch { }\n    setMentionedUserIds([]);\n    setIsInput(textField?.innerText?.length > 0);\n    setHeight();\n  }, [initialValue]);\n\n  // #Mention | Clear input value when channel changes\n  useEffect(() => {\n    if (!isEdit) {\n      setIsInput(false);\n      resetInput(ref);\n    }\n  }, [channelUrl]);\n\n  // #Mention | Fill message input values\n  useEffect(() => {\n    if (isEdit && message?.messageId) {\n      // const textField = document.getElementById(textFieldId);\n      const textField = ref?.current;\n      if (isMentionEnabled\n        && message?.mentionedUsers?.length > 0\n        && message?.mentionedMessageTemplate?.length > 0\n      ) {\n        /* mention enabled */\n        const { mentionedUsers = [] } = message;\n        textField.innerHTML = message?.mentionedMessageTemplate?.split(' ').map((word) => (\n          convertWordToStringObj(word, mentionedUsers).map((stringObj) => {\n            const { type, value, userId } = stringObj;\n            if (type === StringObjType.mention\n              && mentionedUsers.some((user) => user?.userId === userId)\n            ) {\n              return renderToString(\n                <MentionUserLabel userId={userId}>\n                  {\n                    `${USER_MENTION_TEMP_CHAR}${mentionedUsers.find((user) => user?.userId === userId)?.nickname\n                    || value\n                    || stringSet.MENTION_NAME__NO_NAME\n                    }`\n                  }\n                </MentionUserLabel>,\n              );\n            }\n            return value;\n          }).join('')\n        )).join(' ');\n      } else {\n        /* mention disabled */\n        try {\n          textField.innerHTML = message?.message;\n        } catch { }\n        setMentionedUserIds([]);\n      }\n      setIsInput(textField?.innerText?.length > 0);\n      setHeight();\n    }\n  }, [isEdit, message]);\n\n  // #Mention | Detect MentionedLabel modified\n  const useMentionedLabelDetection = useCallback(() => {\n    const textField = ref?.current;\n    if (isMentionEnabled) {\n      const newMentionedUserIds = [...textField.getElementsByClassName('sendbird-mention-user-label')].map((node) => node?.dataset?.userid);\n      if (!arrayEqual(mentionedUserIds, newMentionedUserIds) || newMentionedUserIds.length === 0) {\n        onMentionedUserIdsUpdated(newMentionedUserIds);\n        setMentionedUserIds(newMentionedUserIds);\n      }\n    }\n    setIsInput(textField.innerText.length > 0);\n  }, [targetStringInfo, isMentionEnabled]);\n\n  // #Mention | Replace selected user nickname to the MentionedUserLabel\n  useEffect(() => {\n    if (isMentionEnabled && mentionSelectedUser) {\n      const {\n        targetString,\n        startNodeIndex,\n        startOffsetIndex,\n        endNodeIndex,\n        endOffsetIndex,\n      } = targetStringInfo;\n      if (targetString && startNodeIndex !== null && startOffsetIndex !== null) {\n        // const textField = document.getElementById(textFieldId);\n        const textField = ref?.current;\n        const childNodes = [...textField?.childNodes];\n        const frontTextNode = document?.createTextNode(\n          childNodes[startNodeIndex]?.textContent.slice(0, startOffsetIndex),\n        );\n        const backTextNode = document?.createTextNode(\n          `\\u00A0${childNodes[endNodeIndex]?.textContent.slice(endOffsetIndex)}`,\n        );\n        const mentionLabel = renderToString(\n          <MentionUserLabel userId={mentionSelectedUser?.userId}>\n            {`${USER_MENTION_TEMP_CHAR}${mentionSelectedUser?.nickname || stringSet.MENTION_NAME__NO_NAME}`}\n          </MentionUserLabel>,\n        );\n        const div = document.createElement('div');\n        div.innerHTML = mentionLabel;\n        const newNodes = [\n          ...childNodes.slice(0, startNodeIndex),\n          frontTextNode,\n          div.childNodes[0],\n          backTextNode,\n          ...childNodes.slice(endNodeIndex + 1),\n        ];\n        textField.innerHTML = '';\n        newNodes.forEach((newNode) => {\n          textField.appendChild(newNode);\n        });\n        onUserMentioned(mentionSelectedUser);\n        if (window.getSelection || document.getSelection) {\n          // set caret postion\n          const selection = window.getSelection() || document.getSelection();\n          selection.removeAllRanges();\n          const range = new Range();\n          range.selectNodeContents(textField);\n          range.setStart(textField.childNodes[startNodeIndex + 2], 1);\n          range.setEnd(textField.childNodes[startNodeIndex + 2], 1);\n          range.collapse(false);\n          selection.addRange(range);\n          textField.focus();\n        }\n        setTargetStringInfo({ ...initialTargetStringInfo });\n        setHeight();\n        useMentionedLabelDetection();\n      }\n    }\n  }, [mentionSelectedUser, isMentionEnabled]);\n\n  // #Mention | Detect mentioning user nickname\n  const useMentionInputDetection = useCallback(() => {\n    const selection = window?.getSelection?.() || document?.getSelection?.();\n    const textField = ref?.current;\n    if (selection.anchorNode === textField) {\n      onMentionStringChange('');\n    }\n    if (isMentionEnabled && selection\n      && selection.anchorNode === selection.focusNode\n      && selection.anchorOffset === selection.focusOffset\n    ) {\n      let textStack = '';\n      let startNodeIndex = null;\n      let startOffsetIndex = null;\n      for (let index = 0; index < textField.childNodes.length; index += 1) {\n        const currentNode = textField.childNodes[index];\n        if (currentNode.nodeType === NodeTypes.TextNode) {\n          /* text node */\n          const textContent = (currentNode === selection.anchorNode)\n            ? currentNode?.textContent.slice(0, selection.anchorOffset) || ''\n            : currentNode?.textContent || '';\n          if (textStack.length > 0) {\n            textStack += textContent;\n          } else {\n            let charLastIndex = textContent.lastIndexOf(USER_MENTION_TEMP_CHAR);\n            for (let i = charLastIndex - 1; i > -1; i -= 1) {\n              if (textContent[i] === USER_MENTION_TEMP_CHAR) {\n                charLastIndex = i;\n              } else {\n                break;\n              }\n            }\n            if (charLastIndex > -1) {\n              textStack = textContent;\n              startNodeIndex = index;\n              startOffsetIndex = charLastIndex;\n            }\n          }\n        } else {\n          /* other nodes */\n          textStack = '';\n          startNodeIndex = null;\n          startOffsetIndex = null;\n        }\n        if (currentNode === selection.anchorNode) {\n          /**\n           * targetString could be ''\n           * startNodeIndex and startOffsetIndex could be null\n           */\n          const targetString = textStack ? textStack.slice(startOffsetIndex) : '';// include template character\n          setTargetStringInfo({\n            targetString,\n            startNodeIndex,\n            startOffsetIndex,\n            endNodeIndex: index,\n            endOffsetIndex: selection.anchorOffset,\n          });\n          onMentionStringChange(targetString);\n          return;\n        }\n      }\n    }\n  }, [isMentionEnabled]);\n\n  const sendMessage = () => {\n    const textField = ref?.current;\n    if (!isEdit && textField?.innerText) {\n      let messageText = '';\n      let mentionTemplate = '';\n      textField.childNodes.forEach((node) => {\n        if (node.nodeType === NodeTypes.ElementNode && node.nodeName === NodeNames.Span) {\n          const { innerText, dataset = {} } = node;\n          const { userid = '' } = dataset;\n          messageText += innerText;\n          mentionTemplate += `${USER_MENTION_TEMP_CHAR}{${userid}}`;\n        } else if (node.nodeType === NodeTypes.ElementNode && node.nodeName === NodeNames.Br) {\n          messageText += '\\n';\n          mentionTemplate += '\\n';\n        } else { // other nodes including text node\n          const { textContent = '' } = node;\n          messageText += textContent;\n          mentionTemplate += textContent;\n        }\n      });\n      const params = { message: messageText, mentionTemplate };\n      onSendMessage(params);\n      resetInput(ref);\n      setIsInput(false);\n      setHeight();\n    }\n  };\n  const editMessage = () => {\n    const textField = ref?.current;\n    const messageId = message?.messageId;\n    if (isEdit && messageId) {\n      let messageText = '';\n      let mentionTemplate = '';\n      textField.childNodes.forEach((node) => {\n        if (node.nodeType === NodeTypes.ElementNode && node.nodeName === NodeNames.Span) {\n          const { innerText, dataset = {} } = node;\n          const { userid = '' } = dataset;\n          messageText += innerText;\n          mentionTemplate += `${USER_MENTION_TEMP_CHAR}{${userid}}`;\n        } else if (node.nodeType === NodeTypes.ElementNode && node.nodeName === NodeNames.Span) {\n          messageText += '\\n';\n          mentionTemplate += '\\n';\n        } else { // other nodes including text node\n          const { textContent = '' } = node;\n          messageText += textContent;\n          mentionTemplate += textContent;\n        }\n      });\n      const params = { messageId, message: messageText, mentionTemplate };\n      onUpdateMessage(params);\n      resetInput(ref);\n    }\n  };\n\n  return (\n    <form\n      className={getClassName([\n        className,\n        isEdit ? 'sendbird-message-input__edit' : '',\n        disabled ? 'sendbird-message-input-form__disabled' : '',\n      ])}\n    >\n      <div\n        className={getClassName([\n          'sendbird-message-input',\n          disabled ? 'sendbird-message-input__disabled' : '',\n        ])}\n      >\n        <div\n          id={`${textFieldId}${isEdit ? message?.messageId : ''}`}\n          className={`sendbird-message-input--textarea ${textFieldId}`}\n          contentEditable={!disabled}\n          role=\"textbox\"\n          aria-label=\"Text Input\"\n          disabled={disabled}\n          ref={ref}\n          maxLength={maxLength}\n          onKeyDown={(e) => {\n            const preventEvent = onKeyDown(e);\n            if (preventEvent) {\n              e.preventDefault();\n            } else {\n              if (!e.shiftKey && e.key === MessageInputKeys.Enter && e?.nativeEvent?.isComposing !== true) {\n                e.preventDefault();\n                sendMessage();\n              }\n              if (e.key === MessageInputKeys.Backspace\n                && ref?.current?.childNodes?.length === 2\n                && !ref?.current?.childNodes?.[0]?.textContent\n                && ref?.current.childNodes?.[1]?.nodeType === NodeTypes.ElementNode\n              ) {\n                ref?.current.removeChild(ref?.current.childNodes[1]);\n              }\n            }\n          }}\n          onKeyUp={(e) => {\n            const preventEvent = onKeyUp(e);\n            if (preventEvent) {\n              e.preventDefault();\n            } else {\n              useMentionInputDetection();\n            }\n          }}\n          onClick={() => {\n            useMentionInputDetection();\n          }}\n          onInput={() => {\n            setHeight();\n            onStartTyping();\n            setIsInput(ref?.current?.innerText?.length > 0);\n            useMentionedLabelDetection();\n          }}\n          onPaste={(e) => {\n            e.preventDefault();\n            document.execCommand(\"insertHTML\", false, e?.clipboardData.getData('text'));\n          }}\n        />\n        {/* placeholder */}\n        {!isInput && (\n          <Label\n            className=\"sendbird-message-input--placeholder\"\n            type={LabelTypography.BODY_1}\n            color={LabelColors.ONBACKGROUND_3}\n          >\n            {placeholder || stringSet.MESSAGE_INPUT__PLACE_HOLDER}\n          </Label>\n        )}\n        {/* send icon */}\n        {\n          (!isEdit && isInput) && (\n            <IconButton\n              className=\"sendbird-message-input--send\"\n              height=\"32px\"\n              width=\"32px\"\n              onClick={() => sendMessage()}\n            >\n              <Icon type={IconTypes.SEND} fillColor={IconColors.PRIMARY} width=\"20px\" height=\"20px\" />\n            </IconButton>\n          )\n        }\n        {/* upload icon */}\n        {\n          (!isEdit && !isInput) && (\n            <IconButton\n              className=\"sendbird-message-input--attach\"\n              height=\"32px\"\n              width=\"32px\"\n              onClick={() => {\n                // todo: clear previous input\n                fileInputRef?.current?.click?.();\n              }}\n            >\n              <Icon\n                type={IconTypes.ATTACH}\n                fillColor={IconColors.CONTENT_INVERSE}\n                width=\"20px\"\n                height=\"20px\"\n              />\n              <input\n                className=\"sendbird-message-input--attach-input\"\n                type=\"file\"\n                ref={fileInputRef}\n                onChange={handleUploadFile(onFileUpload)}\n              />\n            </IconButton>\n          )\n        }\n      </div>\n      {/* Edit */}\n      {\n        isEdit && (\n          <div className=\"sendbird-message-input--edit-action\">\n            <Button\n              className=\"sendbird-message-input--edit-action__cancel\"\n              type={ButtonTypes.SECONDARY}\n              size={ButtonSizes.SMALL}\n              onClick={onCancelEdit}\n            >\n              {stringSet.BUTTON__CANCEL}\n            </Button>\n            <Button\n              className=\"sendbird-message-input--edit-action__save\"\n              type={ButtonTypes.PRIMARY}\n              size={ButtonSizes.SMALL}\n              onClick={() => editMessage()}\n            >\n              {stringSet.BUTTON__SAVE}\n            </Button>\n          </div>\n        )\n      }\n    </form>\n  );\n});\n\nMessageInput.propTypes = {\n  className: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.arrayOf(PropTypes.string),\n  ]),\n  messageFieldId: PropTypes.string,\n  placeholder: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.bool,\n  ]),\n  value: PropTypes.string,\n  isEdit: PropTypes.bool,\n  isMentionEnabled: PropTypes.bool,\n  message: PropTypes.shape({\n    messageId: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n    message: PropTypes.string,\n    mentionedMessageTemplate: PropTypes.string,\n    mentionedUsers: PropTypes.arrayOf(PropTypes.shape({})),\n  }),\n  disabled: PropTypes.bool,\n  maxLength: PropTypes.number,\n  onFileUpload: PropTypes.func,\n  onSendMessage: PropTypes.func,\n  onUpdateMessage: PropTypes.func,\n  onStartTyping: PropTypes.func,\n  onCancelEdit: PropTypes.func,\n  channelUrl: PropTypes.string,\n  mentionSelectedUser: PropTypes.shape({\n    userId: PropTypes.string,\n    nickname: PropTypes.string,\n  }),\n  onUserMentioned: PropTypes.func,\n  onMentionStringChange: PropTypes.func,\n  onMentionedUserIdsUpdated: PropTypes.func,\n  onKeyUp: PropTypes.func,\n  onKeyDown: PropTypes.func,\n};\n\nMessageInput.defaultProps = {\n  className: '',\n  messageFieldId: '',\n  channelUrl: '',\n  onSendMessage: noop,\n  onUpdateMessage: noop,\n  value: null,\n  message: null,\n  isEdit: false,\n  isMentionEnabled: false,\n  disabled: false,\n  placeholder: '',\n  maxLength: 5000,\n  onFileUpload: noop,\n  onCancelEdit: noop,\n  onStartTyping: noop,\n  mentionSelectedUser: null,\n  onUserMentioned: noop,\n  onMentionStringChange: noop,\n  onMentionedUserIdsUpdated: noop,\n  onKeyUp: noop,\n  onKeyDown: noop,\n};\n\nexport default MessageInput;\n"],"names":["TEXT_FIELD_ID","LINE_HEIGHT","noop","handleUploadFile","callback","event","target","files","value","displayCaret","element","position","range","document","createRange","sel","window","getSelection","setStart","childNodes","collapse","removeAllRanges","addRange","focus","resetInput","ref","current","innerHTML","initialTargetStringInfo","targetString","startNodeIndex","startOffsetIndex","endNodeIndex","endOffsetIndex","MessageInput","React","forwardRef","props","className","messageFieldId","isEdit","isMentionEnabled","disabled","message","placeholder","maxLength","onFileUpload","onSendMessage","onUpdateMessage","onCancelEdit","onStartTyping","channelUrl","mentionSelectedUser","onUserMentioned","onMentionStringChange","onMentionedUserIdsUpdated","onKeyUp","onKeyDown","textFieldId","stringSet","useContext","LocalizationContext","fileInputRef","useRef","isInput","setIsInput","useState","mentionedUserIds","setMentionedUserIds","targetStringInfo","setTargetStringInfo","_objectSpread","setHeight","useMemo","elem","MAX_HEIGHT","body","offsetHeight","scrollHeight","style","height","error","initialValue","useEffect","textField","length","innerText","messageId","mentionedUsers","mentionedMessageTemplate","split","map","word","convertWordToStringObj","stringObj","type","userId","StringObjType","mention","some","user","renderToString","MentionUserLabel","USER_MENTION_TEMP_CHAR","find","nickname","MENTION_NAME__NO_NAME","join","useMentionedLabelDetection","useCallback","newMentionedUserIds","getElementsByClassName","node","dataset","userid","arrayEqual","frontTextNode","createTextNode","textContent","slice","backTextNode","mentionLabel","div","createElement","newNodes","forEach","newNode","appendChild","selection","Range","selectNodeContents","setEnd","useMentionInputDetection","anchorNode","focusNode","anchorOffset","focusOffset","textStack","index","currentNode","nodeType","NodeTypes","TextNode","charLastIndex","lastIndexOf","i","sendMessage","messageText","mentionTemplate","ElementNode","nodeName","NodeNames","Span","Br","params","editMessage","getClassName","e","preventEvent","preventDefault","shiftKey","key","MessageInputKeys","Enter","nativeEvent","isComposing","Backspace","removeChild","execCommand","clipboardData","getData","Label","LabelTypography","BODY_1","LabelColors","ONBACKGROUND_3","MESSAGE_INPUT__PLACE_HOLDER","IconButton","Icon","IconTypes","SEND","IconColors","PRIMARY","click","ATTACH","CONTENT_INVERSE","Button","ButtonTypes","SECONDARY","ButtonSizes","SMALL","BUTTON__CANCEL","BUTTON__SAVE","propTypes","PropTypes","oneOfType","string","arrayOf","bool","shape","number","func","defaultProps"],"mappings":"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"}
\ No newline at end of file
+{"version":3,"file":"MessageInput.js","sources":["../../../src/ui/MessageInput/index.jsx"],"sourcesContent":["import React, {\n  useRef,\n  useMemo,\n  useState,\n  useEffect,\n  useCallback,\n  useContext,\n} from 'react';\nimport { renderToString } from 'react-dom/server.js';\nimport PropTypes from 'prop-types';\n\nimport './index.scss';\nimport { MessageInputKeys, NodeNames, NodeTypes } from './const';\n\nimport { USER_MENTION_TEMP_CHAR } from '../../smart-components/Channel/context/const';\nimport IconButton from '../IconButton';\nimport Button, { ButtonTypes, ButtonSizes } from '../Button';\nimport MentionUserLabel from '../MentionUserLabel';\nimport Icon, { IconTypes, IconColors } from '../Icon';\nimport Label, { LabelTypography, LabelColors } from '../Label';\nimport { LocalizationContext } from '../../lib/LocalizationContext';\nimport {\n  arrayEqual,\n  getClassName,\n  StringObjType,\n  convertWordToStringObj,\n} from '../../utils';\n\nconst TEXT_FIELD_ID = 'sendbird-message-input-text-field';\nconst LINE_HEIGHT = 76;\nconst noop = () => { };\nconst handleUploadFile = (callback) => (event) => {\n  if (event.target.files && event.target.files[0]) {\n    callback(event.target.files[0]);\n  }\n  // eslint-disable-next-line no-param-reassign\n  event.target.value = '';\n};\n\nconst displayCaret = (element, position) => {\n  const range = document.createRange();\n  const sel = window.getSelection();\n  range.setStart(element.childNodes[0], position);\n  range.collapse(true);\n  sel.removeAllRanges();\n  sel.addRange(range);\n  element.focus();\n}\n\nconst resetInput = (ref) => {\n  try {\n    ref.current.innerHTML = '';\n  } catch {\n    //\n  }\n}\n\nconst initialTargetStringInfo = {\n  targetString: '',\n  startNodeIndex: null,\n  startOffsetIndex: null,\n  endNodeIndex: null,\n  endOffsetIndex: null,\n};\n\nconst MessageInput = React.forwardRef((props, ref) => {\n  const {\n    className,\n    messageFieldId,\n    isEdit,\n    isMentionEnabled,\n    disabled,\n    message,\n    placeholder,\n    maxLength,\n    onFileUpload,\n    onSendMessage,\n    onUpdateMessage,\n    onCancelEdit,\n    onStartTyping,\n    channelUrl,\n    mentionSelectedUser,\n    onUserMentioned,\n    onMentionStringChange,\n    onMentionedUserIdsUpdated,\n    onKeyUp,\n    onKeyDown,\n  } = props;\n  const textFieldId = messageFieldId || TEXT_FIELD_ID;\n  const { stringSet } = useContext(LocalizationContext);\n  const fileInputRef = useRef(null);\n  const [isInput, setIsInput] = useState(false);\n  const [mentionedUserIds, setMentionedUserIds] = useState([]);\n  const [targetStringInfo, setTargetStringInfo] = useState({ ...initialTargetStringInfo });\n  const setHeight = useMemo(() => (\n    () => {\n      try {\n        const elem = ref?.current;\n        const MAX_HEIGHT = window.document.body.offsetHeight * 0.6;\n        if (elem && elem.scrollHeight >= LINE_HEIGHT) {\n          if (MAX_HEIGHT < elem.scrollHeight) {\n            elem.style.height = 'auto';\n            elem.style.height = `${MAX_HEIGHT}px`;\n          } else {\n            elem.style.height = 'auto';\n            elem.style.height = `${elem.scrollHeight}px`;\n          }\n        } else {\n          elem.style.height = '';\n        }\n      } catch (error) {\n        // error\n      }\n    }\n  ), []);\n\n  // for easilly initialize input value from outside, but\n  // useEffect(_, [channelUrl]) erase it\n  const initialValue = props?.value;\n  useEffect(() => {\n    const textField = ref?.current;\n    try {\n      textField.innerHTML = initialValue;\n      displayCaret(textField, initialValue?.length);\n    } catch { }\n    setMentionedUserIds([]);\n    setIsInput(textField?.innerText?.length > 0);\n    setHeight();\n  }, [initialValue]);\n\n  // #Mention | Clear input value when channel changes\n  useEffect(() => {\n    if (!isEdit) {\n      setIsInput(false);\n      resetInput(ref);\n    }\n  }, [channelUrl]);\n\n  // #Mention | Fill message input values\n  useEffect(() => {\n    if (isEdit && message?.messageId) {\n      // const textField = document.getElementById(textFieldId);\n      const textField = ref?.current;\n      if (isMentionEnabled\n        && message?.mentionedUsers?.length > 0\n        && message?.mentionedMessageTemplate?.length > 0\n      ) {\n        /* mention enabled */\n        const { mentionedUsers = [] } = message;\n        textField.innerHTML = message?.mentionedMessageTemplate?.split(' ').map((word) => (\n          convertWordToStringObj(word, mentionedUsers).map((stringObj) => {\n            const { type, value, userId } = stringObj;\n            if (type === StringObjType.mention\n              && mentionedUsers.some((user) => user?.userId === userId)\n            ) {\n              return renderToString(\n                <MentionUserLabel userId={userId}>\n                  {\n                    `${USER_MENTION_TEMP_CHAR}${mentionedUsers.find((user) => user?.userId === userId)?.nickname\n                    || value\n                    || stringSet.MENTION_NAME__NO_NAME\n                    }`\n                  }\n                </MentionUserLabel>,\n              );\n            }\n            return value;\n          }).join('')\n        )).join(' ');\n      } else {\n        /* mention disabled */\n        try {\n          textField.innerHTML = message?.message;\n        } catch { }\n        setMentionedUserIds([]);\n      }\n      setIsInput(textField?.innerText?.length > 0);\n      setHeight();\n    }\n  }, [isEdit, message]);\n\n  // #Mention | Detect MentionedLabel modified\n  const useMentionedLabelDetection = useCallback(() => {\n    const textField = ref?.current;\n    if (isMentionEnabled) {\n      const newMentionedUserIds = [...textField.getElementsByClassName('sendbird-mention-user-label')].map((node) => node?.dataset?.userid);\n      if (!arrayEqual(mentionedUserIds, newMentionedUserIds) || newMentionedUserIds.length === 0) {\n        onMentionedUserIdsUpdated(newMentionedUserIds);\n        setMentionedUserIds(newMentionedUserIds);\n      }\n    }\n    setIsInput(textField.innerText.length > 0);\n  }, [targetStringInfo, isMentionEnabled]);\n\n  // #Mention | Replace selected user nickname to the MentionedUserLabel\n  useEffect(() => {\n    if (isMentionEnabled && mentionSelectedUser) {\n      const {\n        targetString,\n        startNodeIndex,\n        startOffsetIndex,\n        endNodeIndex,\n        endOffsetIndex,\n      } = targetStringInfo;\n      if (targetString && startNodeIndex !== null && startOffsetIndex !== null) {\n        // const textField = document.getElementById(textFieldId);\n        const textField = ref?.current;\n        const childNodes = [...textField?.childNodes];\n        const frontTextNode = document?.createTextNode(\n          childNodes[startNodeIndex]?.textContent.slice(0, startOffsetIndex),\n        );\n        const backTextNode = document?.createTextNode(\n          `\\u00A0${childNodes[endNodeIndex]?.textContent.slice(endOffsetIndex)}`,\n        );\n        const mentionLabel = renderToString(\n          <MentionUserLabel userId={mentionSelectedUser?.userId}>\n            {`${USER_MENTION_TEMP_CHAR}${mentionSelectedUser?.nickname || stringSet.MENTION_NAME__NO_NAME}`}\n          </MentionUserLabel>,\n        );\n        const div = document.createElement('div');\n        div.innerHTML = mentionLabel;\n        const newNodes = [\n          ...childNodes.slice(0, startNodeIndex),\n          frontTextNode,\n          div.childNodes[0],\n          backTextNode,\n          ...childNodes.slice(endNodeIndex + 1),\n        ];\n        textField.innerHTML = '';\n        newNodes.forEach((newNode) => {\n          textField.appendChild(newNode);\n        });\n        onUserMentioned(mentionSelectedUser);\n        if (window.getSelection || document.getSelection) {\n          // set caret postion\n          const selection = window.getSelection() || document.getSelection();\n          selection.removeAllRanges();\n          const range = new Range();\n          range.selectNodeContents(textField);\n          range.setStart(textField.childNodes[startNodeIndex + 2], 1);\n          range.setEnd(textField.childNodes[startNodeIndex + 2], 1);\n          range.collapse(false);\n          selection.addRange(range);\n          textField.focus();\n        }\n        setTargetStringInfo({ ...initialTargetStringInfo });\n        setHeight();\n        useMentionedLabelDetection();\n      }\n    }\n  }, [mentionSelectedUser, isMentionEnabled]);\n\n  // #Mention | Detect mentioning user nickname\n  const useMentionInputDetection = useCallback(() => {\n    const selection = window?.getSelection?.() || document?.getSelection?.();\n    const textField = ref?.current;\n    if (selection.anchorNode === textField) {\n      onMentionStringChange('');\n    }\n    if (isMentionEnabled && selection\n      && selection.anchorNode === selection.focusNode\n      && selection.anchorOffset === selection.focusOffset\n    ) {\n      let textStack = '';\n      let startNodeIndex = null;\n      let startOffsetIndex = null;\n      for (let index = 0; index < textField.childNodes.length; index += 1) {\n        const currentNode = textField.childNodes[index];\n        if (currentNode.nodeType === NodeTypes.TextNode) {\n          /* text node */\n          const textContent = (currentNode === selection.anchorNode)\n            ? currentNode?.textContent.slice(0, selection.anchorOffset) || ''\n            : currentNode?.textContent || '';\n          if (textStack.length > 0) {\n            textStack += textContent;\n          } else {\n            let charLastIndex = textContent.lastIndexOf(USER_MENTION_TEMP_CHAR);\n            for (let i = charLastIndex - 1; i > -1; i -= 1) {\n              if (textContent[i] === USER_MENTION_TEMP_CHAR) {\n                charLastIndex = i;\n              } else {\n                break;\n              }\n            }\n            if (charLastIndex > -1) {\n              textStack = textContent;\n              startNodeIndex = index;\n              startOffsetIndex = charLastIndex;\n            }\n          }\n        } else {\n          /* other nodes */\n          textStack = '';\n          startNodeIndex = null;\n          startOffsetIndex = null;\n        }\n        if (currentNode === selection.anchorNode) {\n          /**\n           * targetString could be ''\n           * startNodeIndex and startOffsetIndex could be null\n           */\n          const targetString = textStack ? textStack.slice(startOffsetIndex) : '';// include template character\n          setTargetStringInfo({\n            targetString,\n            startNodeIndex,\n            startOffsetIndex,\n            endNodeIndex: index,\n            endOffsetIndex: selection.anchorOffset,\n          });\n          onMentionStringChange(targetString);\n          return;\n        }\n      }\n    }\n  }, [isMentionEnabled]);\n\n  const sendMessage = () => {\n    const textField = ref?.current;\n    if (!isEdit && textField?.innerText) {\n      let messageText = '';\n      let mentionTemplate = '';\n      textField.childNodes.forEach((node) => {\n        if (node.nodeType === NodeTypes.ElementNode && node.nodeName === NodeNames.Span) {\n          const { innerText, dataset = {} } = node;\n          const { userid = '' } = dataset;\n          messageText += innerText;\n          mentionTemplate += `${USER_MENTION_TEMP_CHAR}{${userid}}`;\n        } else if (node.nodeType === NodeTypes.ElementNode && node.nodeName === NodeNames.Br) {\n          messageText += '\\n';\n          mentionTemplate += '\\n';\n        } else { // other nodes including text node\n          const { textContent = '' } = node;\n          messageText += textContent;\n          mentionTemplate += textContent;\n        }\n      });\n      const params = { message: messageText, mentionTemplate };\n      onSendMessage(params);\n      resetInput(ref);\n      setIsInput(false);\n      setHeight();\n    }\n  };\n  const editMessage = () => {\n    const textField = ref?.current;\n    const messageId = message?.messageId;\n    if (isEdit && messageId) {\n      let messageText = '';\n      let mentionTemplate = '';\n      textField.childNodes.forEach((node) => {\n        if (node.nodeType === NodeTypes.ElementNode && node.nodeName === NodeNames.Span) {\n          const { innerText, dataset = {} } = node;\n          const { userid = '' } = dataset;\n          messageText += innerText;\n          mentionTemplate += `${USER_MENTION_TEMP_CHAR}{${userid}}`;\n        } else if (node.nodeType === NodeTypes.ElementNode && node.nodeName === NodeNames.Span) {\n          messageText += '\\n';\n          mentionTemplate += '\\n';\n        } else { // other nodes including text node\n          const { textContent = '' } = node;\n          messageText += textContent;\n          mentionTemplate += textContent;\n        }\n      });\n      const params = { messageId, message: messageText, mentionTemplate };\n      onUpdateMessage(params);\n      resetInput(ref);\n    }\n  };\n\n  return (\n    <form\n      className={getClassName([\n        className,\n        isEdit ? 'sendbird-message-input__edit' : '',\n        disabled ? 'sendbird-message-input-form__disabled' : '',\n      ])}\n    >\n      <div\n        className={getClassName([\n          'sendbird-message-input',\n          disabled ? 'sendbird-message-input__disabled' : '',\n        ])}\n      >\n        <div\n          id={`${textFieldId}${isEdit ? message?.messageId : ''}`}\n          className={`sendbird-message-input--textarea ${textFieldId}`}\n          contentEditable={!disabled}\n          role=\"textbox\"\n          aria-label=\"Text Input\"\n          disabled={disabled}\n          ref={ref}\n          maxLength={maxLength}\n          onKeyDown={(e) => {\n            const preventEvent = onKeyDown(e);\n            if (preventEvent) {\n              e.preventDefault();\n            } else {\n              if (!e.shiftKey && e.key === MessageInputKeys.Enter && e?.nativeEvent?.isComposing !== true) {\n                e.preventDefault();\n                sendMessage();\n              }\n              if (e.key === MessageInputKeys.Backspace\n                && ref?.current?.childNodes?.length === 2\n                && !ref?.current?.childNodes?.[0]?.textContent\n                && ref?.current.childNodes?.[1]?.nodeType === NodeTypes.ElementNode\n              ) {\n                ref?.current.removeChild(ref?.current.childNodes[1]);\n              }\n            }\n          }}\n          onKeyUp={(e) => {\n            const preventEvent = onKeyUp(e);\n            if (preventEvent) {\n              e.preventDefault();\n            } else {\n              useMentionInputDetection();\n            }\n          }}\n          onClick={() => {\n            useMentionInputDetection();\n          }}\n          onInput={() => {\n            setHeight();\n            onStartTyping();\n            setIsInput(ref?.current?.innerText?.length > 0);\n            useMentionedLabelDetection();\n          }}\n          onPaste={(e) => {\n            e.preventDefault();\n            document.execCommand(\"insertHTML\", false, e?.clipboardData.getData('text'));\n          }}\n        />\n        {/* placeholder */}\n        {!isInput && (\n          <Label\n            className=\"sendbird-message-input--placeholder\"\n            type={LabelTypography.BODY_1}\n            color={LabelColors.ONBACKGROUND_3}\n          >\n            {placeholder || stringSet.MESSAGE_INPUT__PLACE_HOLDER}\n          </Label>\n        )}\n        {/* send icon */}\n        {\n          (!isEdit && isInput) && (\n            <IconButton\n              className=\"sendbird-message-input--send\"\n              height=\"32px\"\n              width=\"32px\"\n              onClick={() => sendMessage()}\n            >\n              <Icon type={IconTypes.SEND} fillColor={IconColors.PRIMARY} width=\"20px\" height=\"20px\" />\n            </IconButton>\n          )\n        }\n        {/* upload icon */}\n        {\n          (!isEdit && !isInput) && (\n            <IconButton\n              className=\"sendbird-message-input--attach\"\n              height=\"32px\"\n              width=\"32px\"\n              onClick={() => {\n                // todo: clear previous input\n                fileInputRef?.current?.click?.();\n              }}\n            >\n              <Icon\n                type={IconTypes.ATTACH}\n                fillColor={IconColors.CONTENT_INVERSE}\n                width=\"20px\"\n                height=\"20px\"\n              />\n              <input\n                className=\"sendbird-message-input--attach-input\"\n                type=\"file\"\n                ref={fileInputRef}\n                onChange={handleUploadFile(onFileUpload)}\n              />\n            </IconButton>\n          )\n        }\n      </div>\n      {/* Edit */}\n      {\n        isEdit && (\n          <div className=\"sendbird-message-input--edit-action\">\n            <Button\n              className=\"sendbird-message-input--edit-action__cancel\"\n              type={ButtonTypes.SECONDARY}\n              size={ButtonSizes.SMALL}\n              onClick={onCancelEdit}\n            >\n              {stringSet.BUTTON__CANCEL}\n            </Button>\n            <Button\n              className=\"sendbird-message-input--edit-action__save\"\n              type={ButtonTypes.PRIMARY}\n              size={ButtonSizes.SMALL}\n              onClick={() => editMessage()}\n            >\n              {stringSet.BUTTON__SAVE}\n            </Button>\n          </div>\n        )\n      }\n    </form>\n  );\n});\n\nMessageInput.propTypes = {\n  className: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.arrayOf(PropTypes.string),\n  ]),\n  messageFieldId: PropTypes.string,\n  placeholder: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.bool,\n  ]),\n  value: PropTypes.string,\n  isEdit: PropTypes.bool,\n  isMentionEnabled: PropTypes.bool,\n  message: PropTypes.shape({\n    messageId: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n    message: PropTypes.string,\n    mentionedMessageTemplate: PropTypes.string,\n    mentionedUsers: PropTypes.arrayOf(PropTypes.shape({})),\n  }),\n  disabled: PropTypes.bool,\n  maxLength: PropTypes.number,\n  onFileUpload: PropTypes.func,\n  onSendMessage: PropTypes.func,\n  onUpdateMessage: PropTypes.func,\n  onStartTyping: PropTypes.func,\n  onCancelEdit: PropTypes.func,\n  channelUrl: PropTypes.string,\n  mentionSelectedUser: PropTypes.shape({\n    userId: PropTypes.string,\n    nickname: PropTypes.string,\n  }),\n  onUserMentioned: PropTypes.func,\n  onMentionStringChange: PropTypes.func,\n  onMentionedUserIdsUpdated: PropTypes.func,\n  onKeyUp: PropTypes.func,\n  onKeyDown: PropTypes.func,\n};\n\nMessageInput.defaultProps = {\n  className: '',\n  messageFieldId: '',\n  channelUrl: '',\n  onSendMessage: noop,\n  onUpdateMessage: noop,\n  value: null,\n  message: null,\n  isEdit: false,\n  isMentionEnabled: false,\n  disabled: false,\n  placeholder: '',\n  maxLength: 5000,\n  onFileUpload: noop,\n  onCancelEdit: noop,\n  onStartTyping: noop,\n  mentionSelectedUser: null,\n  onUserMentioned: noop,\n  onMentionStringChange: noop,\n  onMentionedUserIdsUpdated: noop,\n  onKeyUp: noop,\n  onKeyDown: noop,\n};\n\nexport default MessageInput;\n"],"names":["TEXT_FIELD_ID","LINE_HEIGHT","noop","handleUploadFile","callback","event","target","files","value","displayCaret","element","position","range","document","createRange","sel","window","getSelection","setStart","childNodes","collapse","removeAllRanges","addRange","focus","resetInput","ref","current","innerHTML","initialTargetStringInfo","targetString","startNodeIndex","startOffsetIndex","endNodeIndex","endOffsetIndex","MessageInput","React","forwardRef","props","className","messageFieldId","isEdit","isMentionEnabled","disabled","message","placeholder","maxLength","onFileUpload","onSendMessage","onUpdateMessage","onCancelEdit","onStartTyping","channelUrl","mentionSelectedUser","onUserMentioned","onMentionStringChange","onMentionedUserIdsUpdated","onKeyUp","onKeyDown","textFieldId","stringSet","useContext","LocalizationContext","fileInputRef","useRef","isInput","setIsInput","useState","mentionedUserIds","setMentionedUserIds","targetStringInfo","setTargetStringInfo","_objectSpread","setHeight","useMemo","elem","MAX_HEIGHT","body","offsetHeight","scrollHeight","style","height","error","initialValue","useEffect","textField","length","innerText","messageId","mentionedUsers","mentionedMessageTemplate","split","map","word","convertWordToStringObj","stringObj","type","userId","StringObjType","mention","some","user","renderToString","MentionUserLabel","USER_MENTION_TEMP_CHAR","find","nickname","MENTION_NAME__NO_NAME","join","useMentionedLabelDetection","useCallback","newMentionedUserIds","getElementsByClassName","node","dataset","userid","arrayEqual","frontTextNode","createTextNode","textContent","slice","backTextNode","mentionLabel","div","createElement","newNodes","forEach","newNode","appendChild","selection","Range","selectNodeContents","setEnd","useMentionInputDetection","anchorNode","focusNode","anchorOffset","focusOffset","textStack","index","currentNode","nodeType","NodeTypes","TextNode","charLastIndex","lastIndexOf","i","sendMessage","messageText","mentionTemplate","ElementNode","nodeName","NodeNames","Span","Br","params","editMessage","getClassName","e","preventEvent","preventDefault","shiftKey","key","MessageInputKeys","Enter","nativeEvent","isComposing","Backspace","removeChild","execCommand","clipboardData","getData","Label","LabelTypography","BODY_1","LabelColors","ONBACKGROUND_3","MESSAGE_INPUT__PLACE_HOLDER","IconButton","Icon","IconTypes","SEND","IconColors","PRIMARY","click","ATTACH","CONTENT_INVERSE","Button","ButtonTypes","SECONDARY","ButtonSizes","SMALL","BUTTON__CANCEL","BUTTON__SAVE","propTypes","PropTypes","oneOfType","string","arrayOf","bool","shape","number","func","defaultProps"],"mappings":"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"}
\ No newline at end of file
diff --git a/node_modules/@sendbird/uikit-react/index.js b/node_modules/@sendbird/uikit-react/index.js
index 0370b63..90d4cd1 100644
--- a/node_modules/@sendbird/uikit-react/index.js
+++ b/node_modules/@sendbird/uikit-react/index.js
@@ -68,7 +68,7 @@ import './ui/FileViewer.js';
 import './ui/MessageItemMenu.js';
 import './ui/MessageItemReactionMenu.js';
 import './ui/MessageInput.js';
-import 'react-dom/server';
+import 'react-dom/server.js';
 import './ui/MentionUserLabel.js';
 import './Thread/components/ThreadHeader.js';
 import './Thread/components/ThreadList.js';
diff --git a/node_modules/@sendbird/uikit-react/ui/MessageInput.js b/node_modules/@sendbird/uikit-react/ui/MessageInput.js
index ad96810..c88bf08 100644
--- a/node_modules/@sendbird/uikit-react/ui/MessageInput.js
+++ b/node_modules/@sendbird/uikit-react/ui/MessageInput.js
@@ -1,6 +1,6 @@
 import { _ as _objectSpread2 } from '../_rollupPluginBabelHelpers-16667c95.js';
 import React__default, { useContext, useRef, useState, useMemo, useEffect, useCallback } from 'react';
-import { renderToString } from 'react-dom/server';
+import { renderToString } from 'react-dom/server.js';
 import PropTypes from 'prop-types';
 import { N as NodeTypes, M as MessageInputKeys, a as NodeNames } from '../const-5b3992dc.js';
 import { U as USER_MENTION_TEMP_CHAR } from '../const-dd057875.js';
diff --git a/node_modules/@sendbird/uikit-react/ui/MessageInput.js.map b/node_modules/@sendbird/uikit-react/ui/MessageInput.js.map
index 941d6e8..5ab4c4b 100644
--- a/node_modules/@sendbird/uikit-react/ui/MessageInput.js.map
+++ b/node_modules/@sendbird/uikit-react/ui/MessageInput.js.map
@@ -1 +1 @@
-{"version":3,"file":"MessageInput.js","sources":["../../src/ui/MessageInput/index.jsx"],"sourcesContent":["import React, {\n  useRef,\n  useMemo,\n  useState,\n  useEffect,\n  useCallback,\n  useContext,\n} from 'react';\nimport { renderToString } from 'react-dom/server';\nimport PropTypes from 'prop-types';\n\nimport './index.scss';\nimport { MessageInputKeys, NodeNames, NodeTypes } from './const';\n\nimport { USER_MENTION_TEMP_CHAR } from '../../smart-components/Channel/context/const';\nimport IconButton from '../IconButton';\nimport Button, { ButtonTypes, ButtonSizes } from '../Button';\nimport MentionUserLabel from '../MentionUserLabel';\nimport Icon, { IconTypes, IconColors } from '../Icon';\nimport Label, { LabelTypography, LabelColors } from '../Label';\nimport { LocalizationContext } from '../../lib/LocalizationContext';\nimport {\n  arrayEqual,\n  getClassName,\n  StringObjType,\n  convertWordToStringObj,\n} from '../../utils';\n\nconst TEXT_FIELD_ID = 'sendbird-message-input-text-field';\nconst LINE_HEIGHT = 76;\nconst noop = () => { };\nconst handleUploadFile = (callback) => (event) => {\n  if (event.target.files && event.target.files[0]) {\n    callback(event.target.files[0]);\n  }\n  // eslint-disable-next-line no-param-reassign\n  event.target.value = '';\n};\n\nconst displayCaret = (element, position) => {\n  const range = document.createRange();\n  const sel = window.getSelection();\n  range.setStart(element.childNodes[0], position);\n  range.collapse(true);\n  sel.removeAllRanges();\n  sel.addRange(range);\n  element.focus();\n}\n\nconst resetInput = (ref) => {\n  try {\n    ref.current.innerHTML = '';\n  } catch {\n    //\n  }\n}\n\nconst initialTargetStringInfo = {\n  targetString: '',\n  startNodeIndex: null,\n  startOffsetIndex: null,\n  endNodeIndex: null,\n  endOffsetIndex: null,\n};\n\nconst MessageInput = React.forwardRef((props, ref) => {\n  const {\n    className,\n    messageFieldId,\n    isEdit,\n    isMentionEnabled,\n    disabled,\n    message,\n    placeholder,\n    maxLength,\n    onFileUpload,\n    onSendMessage,\n    onUpdateMessage,\n    onCancelEdit,\n    onStartTyping,\n    channelUrl,\n    mentionSelectedUser,\n    onUserMentioned,\n    onMentionStringChange,\n    onMentionedUserIdsUpdated,\n    onKeyUp,\n    onKeyDown,\n  } = props;\n  const textFieldId = messageFieldId || TEXT_FIELD_ID;\n  const { stringSet } = useContext(LocalizationContext);\n  const fileInputRef = useRef(null);\n  const [isInput, setIsInput] = useState(false);\n  const [mentionedUserIds, setMentionedUserIds] = useState([]);\n  const [targetStringInfo, setTargetStringInfo] = useState({ ...initialTargetStringInfo });\n  const setHeight = useMemo(() => (\n    () => {\n      try {\n        const elem = ref?.current;\n        const MAX_HEIGHT = window.document.body.offsetHeight * 0.6;\n        if (elem && elem.scrollHeight >= LINE_HEIGHT) {\n          if (MAX_HEIGHT < elem.scrollHeight) {\n            elem.style.height = 'auto';\n            elem.style.height = `${MAX_HEIGHT}px`;\n          } else {\n            elem.style.height = 'auto';\n            elem.style.height = `${elem.scrollHeight}px`;\n          }\n        } else {\n          elem.style.height = '';\n        }\n      } catch (error) {\n        // error\n      }\n    }\n  ), []);\n\n  // for easilly initialize input value from outside, but\n  // useEffect(_, [channelUrl]) erase it\n  const initialValue = props?.value;\n  useEffect(() => {\n    const textField = ref?.current;\n    try {\n      textField.innerHTML = initialValue;\n      displayCaret(textField, initialValue?.length);\n    } catch { }\n    setMentionedUserIds([]);\n    setIsInput(textField?.innerText?.length > 0);\n    setHeight();\n  }, [initialValue]);\n\n  // #Mention | Clear input value when channel changes\n  useEffect(() => {\n    if (!isEdit) {\n      setIsInput(false);\n      resetInput(ref);\n    }\n  }, [channelUrl]);\n\n  // #Mention | Fill message input values\n  useEffect(() => {\n    if (isEdit && message?.messageId) {\n      // const textField = document.getElementById(textFieldId);\n      const textField = ref?.current;\n      if (isMentionEnabled\n        && message?.mentionedUsers?.length > 0\n        && message?.mentionedMessageTemplate?.length > 0\n      ) {\n        /* mention enabled */\n        const { mentionedUsers = [] } = message;\n        textField.innerHTML = message?.mentionedMessageTemplate?.split(' ').map((word) => (\n          convertWordToStringObj(word, mentionedUsers).map((stringObj) => {\n            const { type, value, userId } = stringObj;\n            if (type === StringObjType.mention\n              && mentionedUsers.some((user) => user?.userId === userId)\n            ) {\n              return renderToString(\n                <MentionUserLabel userId={userId}>\n                  {\n                    `${USER_MENTION_TEMP_CHAR}${mentionedUsers.find((user) => user?.userId === userId)?.nickname\n                    || value\n                    || stringSet.MENTION_NAME__NO_NAME\n                    }`\n                  }\n                </MentionUserLabel>,\n              );\n            }\n            return value;\n          }).join('')\n        )).join(' ');\n      } else {\n        /* mention disabled */\n        try {\n          textField.innerHTML = message?.message;\n        } catch { }\n        setMentionedUserIds([]);\n      }\n      setIsInput(textField?.innerText?.length > 0);\n      setHeight();\n    }\n  }, [isEdit, message]);\n\n  // #Mention | Detect MentionedLabel modified\n  const useMentionedLabelDetection = useCallback(() => {\n    const textField = ref?.current;\n    if (isMentionEnabled) {\n      const newMentionedUserIds = [...textField.getElementsByClassName('sendbird-mention-user-label')].map((node) => node?.dataset?.userid);\n      if (!arrayEqual(mentionedUserIds, newMentionedUserIds) || newMentionedUserIds.length === 0) {\n        onMentionedUserIdsUpdated(newMentionedUserIds);\n        setMentionedUserIds(newMentionedUserIds);\n      }\n    }\n    setIsInput(textField.innerText.length > 0);\n  }, [targetStringInfo, isMentionEnabled]);\n\n  // #Mention | Replace selected user nickname to the MentionedUserLabel\n  useEffect(() => {\n    if (isMentionEnabled && mentionSelectedUser) {\n      const {\n        targetString,\n        startNodeIndex,\n        startOffsetIndex,\n        endNodeIndex,\n        endOffsetIndex,\n      } = targetStringInfo;\n      if (targetString && startNodeIndex !== null && startOffsetIndex !== null) {\n        // const textField = document.getElementById(textFieldId);\n        const textField = ref?.current;\n        const childNodes = [...textField?.childNodes];\n        const frontTextNode = document?.createTextNode(\n          childNodes[startNodeIndex]?.textContent.slice(0, startOffsetIndex),\n        );\n        const backTextNode = document?.createTextNode(\n          `\\u00A0${childNodes[endNodeIndex]?.textContent.slice(endOffsetIndex)}`,\n        );\n        const mentionLabel = renderToString(\n          <MentionUserLabel userId={mentionSelectedUser?.userId}>\n            {`${USER_MENTION_TEMP_CHAR}${mentionSelectedUser?.nickname || stringSet.MENTION_NAME__NO_NAME}`}\n          </MentionUserLabel>,\n        );\n        const div = document.createElement('div');\n        div.innerHTML = mentionLabel;\n        const newNodes = [\n          ...childNodes.slice(0, startNodeIndex),\n          frontTextNode,\n          div.childNodes[0],\n          backTextNode,\n          ...childNodes.slice(endNodeIndex + 1),\n        ];\n        textField.innerHTML = '';\n        newNodes.forEach((newNode) => {\n          textField.appendChild(newNode);\n        });\n        onUserMentioned(mentionSelectedUser);\n        if (window.getSelection || document.getSelection) {\n          // set caret postion\n          const selection = window.getSelection() || document.getSelection();\n          selection.removeAllRanges();\n          const range = new Range();\n          range.selectNodeContents(textField);\n          range.setStart(textField.childNodes[startNodeIndex + 2], 1);\n          range.setEnd(textField.childNodes[startNodeIndex + 2], 1);\n          range.collapse(false);\n          selection.addRange(range);\n          textField.focus();\n        }\n        setTargetStringInfo({ ...initialTargetStringInfo });\n        setHeight();\n        useMentionedLabelDetection();\n      }\n    }\n  }, [mentionSelectedUser, isMentionEnabled]);\n\n  // #Mention | Detect mentioning user nickname\n  const useMentionInputDetection = useCallback(() => {\n    const selection = window?.getSelection?.() || document?.getSelection?.();\n    const textField = ref?.current;\n    if (selection.anchorNode === textField) {\n      onMentionStringChange('');\n    }\n    if (isMentionEnabled && selection\n      && selection.anchorNode === selection.focusNode\n      && selection.anchorOffset === selection.focusOffset\n    ) {\n      let textStack = '';\n      let startNodeIndex = null;\n      let startOffsetIndex = null;\n      for (let index = 0; index < textField.childNodes.length; index += 1) {\n        const currentNode = textField.childNodes[index];\n        if (currentNode.nodeType === NodeTypes.TextNode) {\n          /* text node */\n          const textContent = (currentNode === selection.anchorNode)\n            ? currentNode?.textContent.slice(0, selection.anchorOffset) || ''\n            : currentNode?.textContent || '';\n          if (textStack.length > 0) {\n            textStack += textContent;\n          } else {\n            let charLastIndex = textContent.lastIndexOf(USER_MENTION_TEMP_CHAR);\n            for (let i = charLastIndex - 1; i > -1; i -= 1) {\n              if (textContent[i] === USER_MENTION_TEMP_CHAR) {\n                charLastIndex = i;\n              } else {\n                break;\n              }\n            }\n            if (charLastIndex > -1) {\n              textStack = textContent;\n              startNodeIndex = index;\n              startOffsetIndex = charLastIndex;\n            }\n          }\n        } else {\n          /* other nodes */\n          textStack = '';\n          startNodeIndex = null;\n          startOffsetIndex = null;\n        }\n        if (currentNode === selection.anchorNode) {\n          /**\n           * targetString could be ''\n           * startNodeIndex and startOffsetIndex could be null\n           */\n          const targetString = textStack ? textStack.slice(startOffsetIndex) : '';// include template character\n          setTargetStringInfo({\n            targetString,\n            startNodeIndex,\n            startOffsetIndex,\n            endNodeIndex: index,\n            endOffsetIndex: selection.anchorOffset,\n          });\n          onMentionStringChange(targetString);\n          return;\n        }\n      }\n    }\n  }, [isMentionEnabled]);\n\n  const sendMessage = () => {\n    const textField = ref?.current;\n    if (!isEdit && textField?.innerText) {\n      let messageText = '';\n      let mentionTemplate = '';\n      textField.childNodes.forEach((node) => {\n        if (node.nodeType === NodeTypes.ElementNode && node.nodeName === NodeNames.Span) {\n          const { innerText, dataset = {} } = node;\n          const { userid = '' } = dataset;\n          messageText += innerText;\n          mentionTemplate += `${USER_MENTION_TEMP_CHAR}{${userid}}`;\n        } else if (node.nodeType === NodeTypes.ElementNode && node.nodeName === NodeNames.Br) {\n          messageText += '\\n';\n          mentionTemplate += '\\n';\n        } else { // other nodes including text node\n          const { textContent = '' } = node;\n          messageText += textContent;\n          mentionTemplate += textContent;\n        }\n      });\n      const params = { message: messageText, mentionTemplate };\n      onSendMessage(params);\n      resetInput(ref);\n      setIsInput(false);\n      setHeight();\n    }\n  };\n  const editMessage = () => {\n    const textField = ref?.current;\n    const messageId = message?.messageId;\n    if (isEdit && messageId) {\n      let messageText = '';\n      let mentionTemplate = '';\n      textField.childNodes.forEach((node) => {\n        if (node.nodeType === NodeTypes.ElementNode && node.nodeName === NodeNames.Span) {\n          const { innerText, dataset = {} } = node;\n          const { userid = '' } = dataset;\n          messageText += innerText;\n          mentionTemplate += `${USER_MENTION_TEMP_CHAR}{${userid}}`;\n        } else if (node.nodeType === NodeTypes.ElementNode && node.nodeName === NodeNames.Span) {\n          messageText += '\\n';\n          mentionTemplate += '\\n';\n        } else { // other nodes including text node\n          const { textContent = '' } = node;\n          messageText += textContent;\n          mentionTemplate += textContent;\n        }\n      });\n      const params = { messageId, message: messageText, mentionTemplate };\n      onUpdateMessage(params);\n      resetInput(ref);\n    }\n  };\n\n  return (\n    <form\n      className={getClassName([\n        className,\n        isEdit ? 'sendbird-message-input__edit' : '',\n        disabled ? 'sendbird-message-input-form__disabled' : '',\n      ])}\n    >\n      <div\n        className={getClassName([\n          'sendbird-message-input',\n          disabled ? 'sendbird-message-input__disabled' : '',\n        ])}\n      >\n        <div\n          id={`${textFieldId}${isEdit ? message?.messageId : ''}`}\n          className={`sendbird-message-input--textarea ${textFieldId}`}\n          contentEditable={!disabled}\n          role=\"textbox\"\n          aria-label=\"Text Input\"\n          disabled={disabled}\n          ref={ref}\n          maxLength={maxLength}\n          onKeyDown={(e) => {\n            const preventEvent = onKeyDown(e);\n            if (preventEvent) {\n              e.preventDefault();\n            } else {\n              if (!e.shiftKey && e.key === MessageInputKeys.Enter && e?.nativeEvent?.isComposing !== true) {\n                e.preventDefault();\n                sendMessage();\n              }\n              if (e.key === MessageInputKeys.Backspace\n                && ref?.current?.childNodes?.length === 2\n                && !ref?.current?.childNodes?.[0]?.textContent\n                && ref?.current.childNodes?.[1]?.nodeType === NodeTypes.ElementNode\n              ) {\n                ref?.current.removeChild(ref?.current.childNodes[1]);\n              }\n            }\n          }}\n          onKeyUp={(e) => {\n            const preventEvent = onKeyUp(e);\n            if (preventEvent) {\n              e.preventDefault();\n            } else {\n              useMentionInputDetection();\n            }\n          }}\n          onClick={() => {\n            useMentionInputDetection();\n          }}\n          onInput={() => {\n            setHeight();\n            onStartTyping();\n            setIsInput(ref?.current?.innerText?.length > 0);\n            useMentionedLabelDetection();\n          }}\n          onPaste={(e) => {\n            e.preventDefault();\n            document.execCommand(\"insertHTML\", false, e?.clipboardData.getData('text'));\n          }}\n        />\n        {/* placeholder */}\n        {!isInput && (\n          <Label\n            className=\"sendbird-message-input--placeholder\"\n            type={LabelTypography.BODY_1}\n            color={LabelColors.ONBACKGROUND_3}\n          >\n            {placeholder || stringSet.MESSAGE_INPUT__PLACE_HOLDER}\n          </Label>\n        )}\n        {/* send icon */}\n        {\n          (!isEdit && isInput) && (\n            <IconButton\n              className=\"sendbird-message-input--send\"\n              height=\"32px\"\n              width=\"32px\"\n              onClick={() => sendMessage()}\n            >\n              <Icon type={IconTypes.SEND} fillColor={IconColors.PRIMARY} width=\"20px\" height=\"20px\" />\n            </IconButton>\n          )\n        }\n        {/* upload icon */}\n        {\n          (!isEdit && !isInput) && (\n            <IconButton\n              className=\"sendbird-message-input--attach\"\n              height=\"32px\"\n              width=\"32px\"\n              onClick={() => {\n                // todo: clear previous input\n                fileInputRef?.current?.click?.();\n              }}\n            >\n              <Icon\n                type={IconTypes.ATTACH}\n                fillColor={IconColors.CONTENT_INVERSE}\n                width=\"20px\"\n                height=\"20px\"\n              />\n              <input\n                className=\"sendbird-message-input--attach-input\"\n                type=\"file\"\n                ref={fileInputRef}\n                onChange={handleUploadFile(onFileUpload)}\n              />\n            </IconButton>\n          )\n        }\n      </div>\n      {/* Edit */}\n      {\n        isEdit && (\n          <div className=\"sendbird-message-input--edit-action\">\n            <Button\n              className=\"sendbird-message-input--edit-action__cancel\"\n              type={ButtonTypes.SECONDARY}\n              size={ButtonSizes.SMALL}\n              onClick={onCancelEdit}\n            >\n              {stringSet.BUTTON__CANCEL}\n            </Button>\n            <Button\n              className=\"sendbird-message-input--edit-action__save\"\n              type={ButtonTypes.PRIMARY}\n              size={ButtonSizes.SMALL}\n              onClick={() => editMessage()}\n            >\n              {stringSet.BUTTON__SAVE}\n            </Button>\n          </div>\n        )\n      }\n    </form>\n  );\n});\n\nMessageInput.propTypes = {\n  className: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.arrayOf(PropTypes.string),\n  ]),\n  messageFieldId: PropTypes.string,\n  placeholder: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.bool,\n  ]),\n  value: PropTypes.string,\n  isEdit: PropTypes.bool,\n  isMentionEnabled: PropTypes.bool,\n  message: PropTypes.shape({\n    messageId: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n    message: PropTypes.string,\n    mentionedMessageTemplate: PropTypes.string,\n    mentionedUsers: PropTypes.arrayOf(PropTypes.shape({})),\n  }),\n  disabled: PropTypes.bool,\n  maxLength: PropTypes.number,\n  onFileUpload: PropTypes.func,\n  onSendMessage: PropTypes.func,\n  onUpdateMessage: PropTypes.func,\n  onStartTyping: PropTypes.func,\n  onCancelEdit: PropTypes.func,\n  channelUrl: PropTypes.string,\n  mentionSelectedUser: PropTypes.shape({\n    userId: PropTypes.string,\n    nickname: PropTypes.string,\n  }),\n  onUserMentioned: PropTypes.func,\n  onMentionStringChange: PropTypes.func,\n  onMentionedUserIdsUpdated: PropTypes.func,\n  onKeyUp: PropTypes.func,\n  onKeyDown: PropTypes.func,\n};\n\nMessageInput.defaultProps = {\n  className: '',\n  messageFieldId: '',\n  channelUrl: '',\n  onSendMessage: noop,\n  onUpdateMessage: noop,\n  value: null,\n  message: null,\n  isEdit: false,\n  isMentionEnabled: false,\n  disabled: false,\n  placeholder: '',\n  maxLength: 5000,\n  onFileUpload: noop,\n  onCancelEdit: noop,\n  onStartTyping: noop,\n  mentionSelectedUser: null,\n  onUserMentioned: noop,\n  onMentionStringChange: noop,\n  onMentionedUserIdsUpdated: noop,\n  onKeyUp: noop,\n  onKeyDown: noop,\n};\n\nexport default MessageInput;\n"],"names":["TEXT_FIELD_ID","LINE_HEIGHT","noop","handleUploadFile","callback","event","target","files","value","displayCaret","element","position","range","document","createRange","sel","window","getSelection","setStart","childNodes","collapse","removeAllRanges","addRange","focus","resetInput","ref","current","innerHTML","initialTargetStringInfo","targetString","startNodeIndex","startOffsetIndex","endNodeIndex","endOffsetIndex","MessageInput","React","forwardRef","props","className","messageFieldId","isEdit","isMentionEnabled","disabled","message","placeholder","maxLength","onFileUpload","onSendMessage","onUpdateMessage","onCancelEdit","onStartTyping","channelUrl","mentionSelectedUser","onUserMentioned","onMentionStringChange","onMentionedUserIdsUpdated","onKeyUp","onKeyDown","textFieldId","stringSet","useContext","LocalizationContext","fileInputRef","useRef","isInput","setIsInput","useState","mentionedUserIds","setMentionedUserIds","targetStringInfo","setTargetStringInfo","_objectSpread","setHeight","useMemo","elem","MAX_HEIGHT","body","offsetHeight","scrollHeight","style","height","error","initialValue","useEffect","textField","length","innerText","messageId","mentionedUsers","mentionedMessageTemplate","split","map","word","convertWordToStringObj","stringObj","type","userId","StringObjType","mention","some","user","renderToString","USER_MENTION_TEMP_CHAR","find","nickname","MENTION_NAME__NO_NAME","join","useMentionedLabelDetection","useCallback","newMentionedUserIds","getElementsByClassName","node","dataset","userid","arrayEqual","frontTextNode","createTextNode","textContent","slice","backTextNode","mentionLabel","div","createElement","newNodes","forEach","newNode","appendChild","selection","Range","selectNodeContents","setEnd","useMentionInputDetection","anchorNode","focusNode","anchorOffset","focusOffset","textStack","index","currentNode","nodeType","NodeTypes","TextNode","charLastIndex","lastIndexOf","i","sendMessage","messageText","mentionTemplate","ElementNode","nodeName","NodeNames","Span","Br","params","editMessage","getClassName","e","preventEvent","preventDefault","shiftKey","key","MessageInputKeys","Enter","nativeEvent","isComposing","Backspace","removeChild","execCommand","clipboardData","getData","LabelTypography","BODY_1","LabelColors","ONBACKGROUND_3","MESSAGE_INPUT__PLACE_HOLDER","IconTypes","SEND","IconColors","PRIMARY","click","ATTACH","CONTENT_INVERSE","ButtonTypes","SECONDARY","ButtonSizes","SMALL","BUTTON__CANCEL","BUTTON__SAVE","propTypes","PropTypes","oneOfType","string","arrayOf","bool","shape","number","func","defaultProps"],"mappings":"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"}
\ No newline at end of file
+{"version":3,"file":"MessageInput.js","sources":["../../src/ui/MessageInput/index.jsx"],"sourcesContent":["import React, {\n  useRef,\n  useMemo,\n  useState,\n  useEffect,\n  useCallback,\n  useContext,\n} from 'react';\nimport { renderToString } from 'react-dom/server.js';\nimport PropTypes from 'prop-types';\n\nimport './index.scss';\nimport { MessageInputKeys, NodeNames, NodeTypes } from './const';\n\nimport { USER_MENTION_TEMP_CHAR } from '../../smart-components/Channel/context/const';\nimport IconButton from '../IconButton';\nimport Button, { ButtonTypes, ButtonSizes } from '../Button';\nimport MentionUserLabel from '../MentionUserLabel';\nimport Icon, { IconTypes, IconColors } from '../Icon';\nimport Label, { LabelTypography, LabelColors } from '../Label';\nimport { LocalizationContext } from '../../lib/LocalizationContext';\nimport {\n  arrayEqual,\n  getClassName,\n  StringObjType,\n  convertWordToStringObj,\n} from '../../utils';\n\nconst TEXT_FIELD_ID = 'sendbird-message-input-text-field';\nconst LINE_HEIGHT = 76;\nconst noop = () => { };\nconst handleUploadFile = (callback) => (event) => {\n  if (event.target.files && event.target.files[0]) {\n    callback(event.target.files[0]);\n  }\n  // eslint-disable-next-line no-param-reassign\n  event.target.value = '';\n};\n\nconst displayCaret = (element, position) => {\n  const range = document.createRange();\n  const sel = window.getSelection();\n  range.setStart(element.childNodes[0], position);\n  range.collapse(true);\n  sel.removeAllRanges();\n  sel.addRange(range);\n  element.focus();\n}\n\nconst resetInput = (ref) => {\n  try {\n    ref.current.innerHTML = '';\n  } catch {\n    //\n  }\n}\n\nconst initialTargetStringInfo = {\n  targetString: '',\n  startNodeIndex: null,\n  startOffsetIndex: null,\n  endNodeIndex: null,\n  endOffsetIndex: null,\n};\n\nconst MessageInput = React.forwardRef((props, ref) => {\n  const {\n    className,\n    messageFieldId,\n    isEdit,\n    isMentionEnabled,\n    disabled,\n    message,\n    placeholder,\n    maxLength,\n    onFileUpload,\n    onSendMessage,\n    onUpdateMessage,\n    onCancelEdit,\n    onStartTyping,\n    channelUrl,\n    mentionSelectedUser,\n    onUserMentioned,\n    onMentionStringChange,\n    onMentionedUserIdsUpdated,\n    onKeyUp,\n    onKeyDown,\n  } = props;\n  const textFieldId = messageFieldId || TEXT_FIELD_ID;\n  const { stringSet } = useContext(LocalizationContext);\n  const fileInputRef = useRef(null);\n  const [isInput, setIsInput] = useState(false);\n  const [mentionedUserIds, setMentionedUserIds] = useState([]);\n  const [targetStringInfo, setTargetStringInfo] = useState({ ...initialTargetStringInfo });\n  const setHeight = useMemo(() => (\n    () => {\n      try {\n        const elem = ref?.current;\n        const MAX_HEIGHT = window.document.body.offsetHeight * 0.6;\n        if (elem && elem.scrollHeight >= LINE_HEIGHT) {\n          if (MAX_HEIGHT < elem.scrollHeight) {\n            elem.style.height = 'auto';\n            elem.style.height = `${MAX_HEIGHT}px`;\n          } else {\n            elem.style.height = 'auto';\n            elem.style.height = `${elem.scrollHeight}px`;\n          }\n        } else {\n          elem.style.height = '';\n        }\n      } catch (error) {\n        // error\n      }\n    }\n  ), []);\n\n  // for easilly initialize input value from outside, but\n  // useEffect(_, [channelUrl]) erase it\n  const initialValue = props?.value;\n  useEffect(() => {\n    const textField = ref?.current;\n    try {\n      textField.innerHTML = initialValue;\n      displayCaret(textField, initialValue?.length);\n    } catch { }\n    setMentionedUserIds([]);\n    setIsInput(textField?.innerText?.length > 0);\n    setHeight();\n  }, [initialValue]);\n\n  // #Mention | Clear input value when channel changes\n  useEffect(() => {\n    if (!isEdit) {\n      setIsInput(false);\n      resetInput(ref);\n    }\n  }, [channelUrl]);\n\n  // #Mention | Fill message input values\n  useEffect(() => {\n    if (isEdit && message?.messageId) {\n      // const textField = document.getElementById(textFieldId);\n      const textField = ref?.current;\n      if (isMentionEnabled\n        && message?.mentionedUsers?.length > 0\n        && message?.mentionedMessageTemplate?.length > 0\n      ) {\n        /* mention enabled */\n        const { mentionedUsers = [] } = message;\n        textField.innerHTML = message?.mentionedMessageTemplate?.split(' ').map((word) => (\n          convertWordToStringObj(word, mentionedUsers).map((stringObj) => {\n            const { type, value, userId } = stringObj;\n            if (type === StringObjType.mention\n              && mentionedUsers.some((user) => user?.userId === userId)\n            ) {\n              return renderToString(\n                <MentionUserLabel userId={userId}>\n                  {\n                    `${USER_MENTION_TEMP_CHAR}${mentionedUsers.find((user) => user?.userId === userId)?.nickname\n                    || value\n                    || stringSet.MENTION_NAME__NO_NAME\n                    }`\n                  }\n                </MentionUserLabel>,\n              );\n            }\n            return value;\n          }).join('')\n        )).join(' ');\n      } else {\n        /* mention disabled */\n        try {\n          textField.innerHTML = message?.message;\n        } catch { }\n        setMentionedUserIds([]);\n      }\n      setIsInput(textField?.innerText?.length > 0);\n      setHeight();\n    }\n  }, [isEdit, message]);\n\n  // #Mention | Detect MentionedLabel modified\n  const useMentionedLabelDetection = useCallback(() => {\n    const textField = ref?.current;\n    if (isMentionEnabled) {\n      const newMentionedUserIds = [...textField.getElementsByClassName('sendbird-mention-user-label')].map((node) => node?.dataset?.userid);\n      if (!arrayEqual(mentionedUserIds, newMentionedUserIds) || newMentionedUserIds.length === 0) {\n        onMentionedUserIdsUpdated(newMentionedUserIds);\n        setMentionedUserIds(newMentionedUserIds);\n      }\n    }\n    setIsInput(textField.innerText.length > 0);\n  }, [targetStringInfo, isMentionEnabled]);\n\n  // #Mention | Replace selected user nickname to the MentionedUserLabel\n  useEffect(() => {\n    if (isMentionEnabled && mentionSelectedUser) {\n      const {\n        targetString,\n        startNodeIndex,\n        startOffsetIndex,\n        endNodeIndex,\n        endOffsetIndex,\n      } = targetStringInfo;\n      if (targetString && startNodeIndex !== null && startOffsetIndex !== null) {\n        // const textField = document.getElementById(textFieldId);\n        const textField = ref?.current;\n        const childNodes = [...textField?.childNodes];\n        const frontTextNode = document?.createTextNode(\n          childNodes[startNodeIndex]?.textContent.slice(0, startOffsetIndex),\n        );\n        const backTextNode = document?.createTextNode(\n          `\\u00A0${childNodes[endNodeIndex]?.textContent.slice(endOffsetIndex)}`,\n        );\n        const mentionLabel = renderToString(\n          <MentionUserLabel userId={mentionSelectedUser?.userId}>\n            {`${USER_MENTION_TEMP_CHAR}${mentionSelectedUser?.nickname || stringSet.MENTION_NAME__NO_NAME}`}\n          </MentionUserLabel>,\n        );\n        const div = document.createElement('div');\n        div.innerHTML = mentionLabel;\n        const newNodes = [\n          ...childNodes.slice(0, startNodeIndex),\n          frontTextNode,\n          div.childNodes[0],\n          backTextNode,\n          ...childNodes.slice(endNodeIndex + 1),\n        ];\n        textField.innerHTML = '';\n        newNodes.forEach((newNode) => {\n          textField.appendChild(newNode);\n        });\n        onUserMentioned(mentionSelectedUser);\n        if (window.getSelection || document.getSelection) {\n          // set caret postion\n          const selection = window.getSelection() || document.getSelection();\n          selection.removeAllRanges();\n          const range = new Range();\n          range.selectNodeContents(textField);\n          range.setStart(textField.childNodes[startNodeIndex + 2], 1);\n          range.setEnd(textField.childNodes[startNodeIndex + 2], 1);\n          range.collapse(false);\n          selection.addRange(range);\n          textField.focus();\n        }\n        setTargetStringInfo({ ...initialTargetStringInfo });\n        setHeight();\n        useMentionedLabelDetection();\n      }\n    }\n  }, [mentionSelectedUser, isMentionEnabled]);\n\n  // #Mention | Detect mentioning user nickname\n  const useMentionInputDetection = useCallback(() => {\n    const selection = window?.getSelection?.() || document?.getSelection?.();\n    const textField = ref?.current;\n    if (selection.anchorNode === textField) {\n      onMentionStringChange('');\n    }\n    if (isMentionEnabled && selection\n      && selection.anchorNode === selection.focusNode\n      && selection.anchorOffset === selection.focusOffset\n    ) {\n      let textStack = '';\n      let startNodeIndex = null;\n      let startOffsetIndex = null;\n      for (let index = 0; index < textField.childNodes.length; index += 1) {\n        const currentNode = textField.childNodes[index];\n        if (currentNode.nodeType === NodeTypes.TextNode) {\n          /* text node */\n          const textContent = (currentNode === selection.anchorNode)\n            ? currentNode?.textContent.slice(0, selection.anchorOffset) || ''\n            : currentNode?.textContent || '';\n          if (textStack.length > 0) {\n            textStack += textContent;\n          } else {\n            let charLastIndex = textContent.lastIndexOf(USER_MENTION_TEMP_CHAR);\n            for (let i = charLastIndex - 1; i > -1; i -= 1) {\n              if (textContent[i] === USER_MENTION_TEMP_CHAR) {\n                charLastIndex = i;\n              } else {\n                break;\n              }\n            }\n            if (charLastIndex > -1) {\n              textStack = textContent;\n              startNodeIndex = index;\n              startOffsetIndex = charLastIndex;\n            }\n          }\n        } else {\n          /* other nodes */\n          textStack = '';\n          startNodeIndex = null;\n          startOffsetIndex = null;\n        }\n        if (currentNode === selection.anchorNode) {\n          /**\n           * targetString could be ''\n           * startNodeIndex and startOffsetIndex could be null\n           */\n          const targetString = textStack ? textStack.slice(startOffsetIndex) : '';// include template character\n          setTargetStringInfo({\n            targetString,\n            startNodeIndex,\n            startOffsetIndex,\n            endNodeIndex: index,\n            endOffsetIndex: selection.anchorOffset,\n          });\n          onMentionStringChange(targetString);\n          return;\n        }\n      }\n    }\n  }, [isMentionEnabled]);\n\n  const sendMessage = () => {\n    const textField = ref?.current;\n    if (!isEdit && textField?.innerText) {\n      let messageText = '';\n      let mentionTemplate = '';\n      textField.childNodes.forEach((node) => {\n        if (node.nodeType === NodeTypes.ElementNode && node.nodeName === NodeNames.Span) {\n          const { innerText, dataset = {} } = node;\n          const { userid = '' } = dataset;\n          messageText += innerText;\n          mentionTemplate += `${USER_MENTION_TEMP_CHAR}{${userid}}`;\n        } else if (node.nodeType === NodeTypes.ElementNode && node.nodeName === NodeNames.Br) {\n          messageText += '\\n';\n          mentionTemplate += '\\n';\n        } else { // other nodes including text node\n          const { textContent = '' } = node;\n          messageText += textContent;\n          mentionTemplate += textContent;\n        }\n      });\n      const params = { message: messageText, mentionTemplate };\n      onSendMessage(params);\n      resetInput(ref);\n      setIsInput(false);\n      setHeight();\n    }\n  };\n  const editMessage = () => {\n    const textField = ref?.current;\n    const messageId = message?.messageId;\n    if (isEdit && messageId) {\n      let messageText = '';\n      let mentionTemplate = '';\n      textField.childNodes.forEach((node) => {\n        if (node.nodeType === NodeTypes.ElementNode && node.nodeName === NodeNames.Span) {\n          const { innerText, dataset = {} } = node;\n          const { userid = '' } = dataset;\n          messageText += innerText;\n          mentionTemplate += `${USER_MENTION_TEMP_CHAR}{${userid}}`;\n        } else if (node.nodeType === NodeTypes.ElementNode && node.nodeName === NodeNames.Span) {\n          messageText += '\\n';\n          mentionTemplate += '\\n';\n        } else { // other nodes including text node\n          const { textContent = '' } = node;\n          messageText += textContent;\n          mentionTemplate += textContent;\n        }\n      });\n      const params = { messageId, message: messageText, mentionTemplate };\n      onUpdateMessage(params);\n      resetInput(ref);\n    }\n  };\n\n  return (\n    <form\n      className={getClassName([\n        className,\n        isEdit ? 'sendbird-message-input__edit' : '',\n        disabled ? 'sendbird-message-input-form__disabled' : '',\n      ])}\n    >\n      <div\n        className={getClassName([\n          'sendbird-message-input',\n          disabled ? 'sendbird-message-input__disabled' : '',\n        ])}\n      >\n        <div\n          id={`${textFieldId}${isEdit ? message?.messageId : ''}`}\n          className={`sendbird-message-input--textarea ${textFieldId}`}\n          contentEditable={!disabled}\n          role=\"textbox\"\n          aria-label=\"Text Input\"\n          disabled={disabled}\n          ref={ref}\n          maxLength={maxLength}\n          onKeyDown={(e) => {\n            const preventEvent = onKeyDown(e);\n            if (preventEvent) {\n              e.preventDefault();\n            } else {\n              if (!e.shiftKey && e.key === MessageInputKeys.Enter && e?.nativeEvent?.isComposing !== true) {\n                e.preventDefault();\n                sendMessage();\n              }\n              if (e.key === MessageInputKeys.Backspace\n                && ref?.current?.childNodes?.length === 2\n                && !ref?.current?.childNodes?.[0]?.textContent\n                && ref?.current.childNodes?.[1]?.nodeType === NodeTypes.ElementNode\n              ) {\n                ref?.current.removeChild(ref?.current.childNodes[1]);\n              }\n            }\n          }}\n          onKeyUp={(e) => {\n            const preventEvent = onKeyUp(e);\n            if (preventEvent) {\n              e.preventDefault();\n            } else {\n              useMentionInputDetection();\n            }\n          }}\n          onClick={() => {\n            useMentionInputDetection();\n          }}\n          onInput={() => {\n            setHeight();\n            onStartTyping();\n            setIsInput(ref?.current?.innerText?.length > 0);\n            useMentionedLabelDetection();\n          }}\n          onPaste={(e) => {\n            e.preventDefault();\n            document.execCommand(\"insertHTML\", false, e?.clipboardData.getData('text'));\n          }}\n        />\n        {/* placeholder */}\n        {!isInput && (\n          <Label\n            className=\"sendbird-message-input--placeholder\"\n            type={LabelTypography.BODY_1}\n            color={LabelColors.ONBACKGROUND_3}\n          >\n            {placeholder || stringSet.MESSAGE_INPUT__PLACE_HOLDER}\n          </Label>\n        )}\n        {/* send icon */}\n        {\n          (!isEdit && isInput) && (\n            <IconButton\n              className=\"sendbird-message-input--send\"\n              height=\"32px\"\n              width=\"32px\"\n              onClick={() => sendMessage()}\n            >\n              <Icon type={IconTypes.SEND} fillColor={IconColors.PRIMARY} width=\"20px\" height=\"20px\" />\n            </IconButton>\n          )\n        }\n        {/* upload icon */}\n        {\n          (!isEdit && !isInput) && (\n            <IconButton\n              className=\"sendbird-message-input--attach\"\n              height=\"32px\"\n              width=\"32px\"\n              onClick={() => {\n                // todo: clear previous input\n                fileInputRef?.current?.click?.();\n              }}\n            >\n              <Icon\n                type={IconTypes.ATTACH}\n                fillColor={IconColors.CONTENT_INVERSE}\n                width=\"20px\"\n                height=\"20px\"\n              />\n              <input\n                className=\"sendbird-message-input--attach-input\"\n                type=\"file\"\n                ref={fileInputRef}\n                onChange={handleUploadFile(onFileUpload)}\n              />\n            </IconButton>\n          )\n        }\n      </div>\n      {/* Edit */}\n      {\n        isEdit && (\n          <div className=\"sendbird-message-input--edit-action\">\n            <Button\n              className=\"sendbird-message-input--edit-action__cancel\"\n              type={ButtonTypes.SECONDARY}\n              size={ButtonSizes.SMALL}\n              onClick={onCancelEdit}\n            >\n              {stringSet.BUTTON__CANCEL}\n            </Button>\n            <Button\n              className=\"sendbird-message-input--edit-action__save\"\n              type={ButtonTypes.PRIMARY}\n              size={ButtonSizes.SMALL}\n              onClick={() => editMessage()}\n            >\n              {stringSet.BUTTON__SAVE}\n            </Button>\n          </div>\n        )\n      }\n    </form>\n  );\n});\n\nMessageInput.propTypes = {\n  className: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.arrayOf(PropTypes.string),\n  ]),\n  messageFieldId: PropTypes.string,\n  placeholder: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.bool,\n  ]),\n  value: PropTypes.string,\n  isEdit: PropTypes.bool,\n  isMentionEnabled: PropTypes.bool,\n  message: PropTypes.shape({\n    messageId: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n    message: PropTypes.string,\n    mentionedMessageTemplate: PropTypes.string,\n    mentionedUsers: PropTypes.arrayOf(PropTypes.shape({})),\n  }),\n  disabled: PropTypes.bool,\n  maxLength: PropTypes.number,\n  onFileUpload: PropTypes.func,\n  onSendMessage: PropTypes.func,\n  onUpdateMessage: PropTypes.func,\n  onStartTyping: PropTypes.func,\n  onCancelEdit: PropTypes.func,\n  channelUrl: PropTypes.string,\n  mentionSelectedUser: PropTypes.shape({\n    userId: PropTypes.string,\n    nickname: PropTypes.string,\n  }),\n  onUserMentioned: PropTypes.func,\n  onMentionStringChange: PropTypes.func,\n  onMentionedUserIdsUpdated: PropTypes.func,\n  onKeyUp: PropTypes.func,\n  onKeyDown: PropTypes.func,\n};\n\nMessageInput.defaultProps = {\n  className: '',\n  messageFieldId: '',\n  channelUrl: '',\n  onSendMessage: noop,\n  onUpdateMessage: noop,\n  value: null,\n  message: null,\n  isEdit: false,\n  isMentionEnabled: false,\n  disabled: false,\n  placeholder: '',\n  maxLength: 5000,\n  onFileUpload: noop,\n  onCancelEdit: noop,\n  onStartTyping: noop,\n  mentionSelectedUser: null,\n  onUserMentioned: noop,\n  onMentionStringChange: noop,\n  onMentionedUserIdsUpdated: noop,\n  onKeyUp: noop,\n  onKeyDown: noop,\n};\n\nexport default MessageInput;\n"],"names":["TEXT_FIELD_ID","LINE_HEIGHT","noop","handleUploadFile","callback","event","target","files","value","displayCaret","element","position","range","document","createRange","sel","window","getSelection","setStart","childNodes","collapse","removeAllRanges","addRange","focus","resetInput","ref","current","innerHTML","initialTargetStringInfo","targetString","startNodeIndex","startOffsetIndex","endNodeIndex","endOffsetIndex","MessageInput","React","forwardRef","props","className","messageFieldId","isEdit","isMentionEnabled","disabled","message","placeholder","maxLength","onFileUpload","onSendMessage","onUpdateMessage","onCancelEdit","onStartTyping","channelUrl","mentionSelectedUser","onUserMentioned","onMentionStringChange","onMentionedUserIdsUpdated","onKeyUp","onKeyDown","textFieldId","stringSet","useContext","LocalizationContext","fileInputRef","useRef","isInput","setIsInput","useState","mentionedUserIds","setMentionedUserIds","targetStringInfo","setTargetStringInfo","_objectSpread","setHeight","useMemo","elem","MAX_HEIGHT","body","offsetHeight","scrollHeight","style","height","error","initialValue","useEffect","textField","length","innerText","messageId","mentionedUsers","mentionedMessageTemplate","split","map","word","convertWordToStringObj","stringObj","type","userId","StringObjType","mention","some","user","renderToString","USER_MENTION_TEMP_CHAR","find","nickname","MENTION_NAME__NO_NAME","join","useMentionedLabelDetection","useCallback","newMentionedUserIds","getElementsByClassName","node","dataset","userid","arrayEqual","frontTextNode","createTextNode","textContent","slice","backTextNode","mentionLabel","div","createElement","newNodes","forEach","newNode","appendChild","selection","Range","selectNodeContents","setEnd","useMentionInputDetection","anchorNode","focusNode","anchorOffset","focusOffset","textStack","index","currentNode","nodeType","NodeTypes","TextNode","charLastIndex","lastIndexOf","i","sendMessage","messageText","mentionTemplate","ElementNode","nodeName","NodeNames","Span","Br","params","editMessage","getClassName","e","preventEvent","preventDefault","shiftKey","key","MessageInputKeys","Enter","nativeEvent","isComposing","Backspace","removeChild","execCommand","clipboardData","getData","LabelTypography","BODY_1","LabelColors","ONBACKGROUND_3","MESSAGE_INPUT__PLACE_HOLDER","IconTypes","SEND","IconColors","PRIMARY","click","ATTACH","CONTENT_INVERSE","ButtonTypes","SECONDARY","ButtonSizes","SMALL","BUTTON__CANCEL","BUTTON__SAVE","propTypes","PropTypes","oneOfType","string","arrayOf","bool","shape","number","func","defaultProps"],"mappings":"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"}
\ No newline at end of file
