diff --git a/node_modules/@sendbird/uikit-react/App.js b/node_modules/@sendbird/uikit-react/App.js
index bc40525..b0fb656 100644
--- a/node_modules/@sendbird/uikit-react/App.js
+++ b/node_modules/@sendbird/uikit-react/App.js
@@ -90,7 +90,7 @@ import './ThreadProvider-e64f95cc.js';
 import './Thread/context/types.js';
 import './ui/DateSeparator.js';
 import './ui/MessageInput.js';
-import 'react-dom/server';
+import 'react-dom/server.js';
 import 'dompurify';
 import './ui/MessageContent.js';
 import './ui/MessageItemMenu.js';
diff --git a/node_modules/@sendbird/uikit-react/CHANGELOG.md b/node_modules/@sendbird/uikit-react/CHANGELOG.md
index 992f54e..41386f4 100644
--- a/node_modules/@sendbird/uikit-react/CHANGELOG.md
+++ b/node_modules/@sendbird/uikit-react/CHANGELOG.md
@@ -598,7 +598,7 @@ Dev. Env:
 * Install `testing-library` (`@testing-library/react` and `@testing-library/jest-dom`)
 * Migrate every tests with `testing-library` instead of the `enzyme` and `react-test-renderer
 * Replace node-sass with sass(Dart Sass)
-* Reduce bundle size by treating react-dom/server as external
+* Reduce bundle size by treating react-dom/server.js as external
 
 ## [v3.1.3] (Sep 19 2022)
 
diff --git a/node_modules/@sendbird/uikit-react/Channel.js b/node_modules/@sendbird/uikit-react/Channel.js
index 7e3b83c..f73a50b 100644
--- a/node_modules/@sendbird/uikit-react/Channel.js
+++ b/node_modules/@sendbird/uikit-react/Channel.js
@@ -48,7 +48,7 @@ import '@sendbird/chat';
 import './ui/DateSeparator.js';
 import './color-f6b2bdb7.js';
 import './ui/MessageInput.js';
-import 'react-dom/server';
+import 'react-dom/server.js';
 import './ui/Button.js';
 import './ui/MentionUserLabel.js';
 import 'dompurify';
diff --git a/node_modules/@sendbird/uikit-react/Channel/components/ChannelUI.js b/node_modules/@sendbird/uikit-react/Channel/components/ChannelUI.js
index 5002173..491dd81 100644
--- a/node_modules/@sendbird/uikit-react/Channel/components/ChannelUI.js
+++ b/node_modules/@sendbird/uikit-react/Channel/components/ChannelUI.js
@@ -49,7 +49,7 @@ import '@sendbird/chat';
 import '../../ui/DateSeparator.js';
 import '../../color-f6b2bdb7.js';
 import '../../ui/MessageInput.js';
-import 'react-dom/server';
+import 'react-dom/server.js';
 import '../../ui/Button.js';
 import '../../ui/MentionUserLabel.js';
 import 'dompurify';
diff --git a/node_modules/@sendbird/uikit-react/Channel/components/Message.js b/node_modules/@sendbird/uikit-react/Channel/components/Message.js
index 6f6281d..cbc7f9f 100644
--- a/node_modules/@sendbird/uikit-react/Channel/components/Message.js
+++ b/node_modules/@sendbird/uikit-react/Channel/components/Message.js
@@ -38,7 +38,7 @@ import '../../ui/SortByRow.js';
 import '../../stringSet-a513039b.js';
 import '../../ui/ReactionButton.js';
 import '../../color-f6b2bdb7.js';
-import 'react-dom/server';
+import 'react-dom/server.js';
 import '../../ui/IconButton.js';
 import '../../ui/Button.js';
 import '../../ui/MentionUserLabel.js';
diff --git a/node_modules/@sendbird/uikit-react/Channel/components/MessageInput.js b/node_modules/@sendbird/uikit-react/Channel/components/MessageInput.js
index 5d3f31d..277a5f1 100644
--- a/node_modules/@sendbird/uikit-react/Channel/components/MessageInput.js
+++ b/node_modules/@sendbird/uikit-react/Channel/components/MessageInput.js
@@ -30,7 +30,7 @@ import '../../ui/ReactionButton.js';
 import '../../ui/ImageRenderer.js';
 import '../../ui/Icon.js';
 import '../../consts-59f719d8.js';
-import 'react-dom/server';
+import 'react-dom/server.js';
 import '../../ui/IconButton.js';
 import '../../ui/Button.js';
 import '../../ui/MentionUserLabel.js';
diff --git a/node_modules/@sendbird/uikit-react/Channel/components/MessageList.js b/node_modules/@sendbird/uikit-react/Channel/components/MessageList.js
index 2d6d357..4b52a8f 100644
--- a/node_modules/@sendbird/uikit-react/Channel/components/MessageList.js
+++ b/node_modules/@sendbird/uikit-react/Channel/components/MessageList.js
@@ -41,7 +41,7 @@ import '@sendbird/chat';
 import '../../ui/DateSeparator.js';
 import '../../color-f6b2bdb7.js';
 import '../../ui/MessageInput.js';
-import 'react-dom/server';
+import 'react-dom/server.js';
 import '../../ui/IconButton.js';
 import '../../ui/Button.js';
 import '../../ui/MentionUserLabel.js';
diff --git a/node_modules/@sendbird/uikit-react/OpenChannel.js b/node_modules/@sendbird/uikit-react/OpenChannel.js
index 98c30a3..78bed52 100644
--- a/node_modules/@sendbird/uikit-react/OpenChannel.js
+++ b/node_modules/@sendbird/uikit-react/OpenChannel.js
@@ -7,7 +7,7 @@ import './stringSet-a513039b.js';
 import './index-c10fcd31.js';
 import './ui/MessageInput.js';
 import './_rollupPluginBabelHelpers-945410b2.js';
-import 'react-dom/server';
+import 'react-dom/server.js';
 import 'prop-types';
 import './const-0f759572.js';
 import './const-85535a89.js';
diff --git a/node_modules/@sendbird/uikit-react/OpenChannel/components/OpenChannelInput.js b/node_modules/@sendbird/uikit-react/OpenChannel/components/OpenChannelInput.js
index c59db4c..6f97394 100644
--- a/node_modules/@sendbird/uikit-react/OpenChannel/components/OpenChannelInput.js
+++ b/node_modules/@sendbird/uikit-react/OpenChannel/components/OpenChannelInput.js
@@ -5,7 +5,7 @@ import { u as useOpenChannelContext } from '../../OpenChannelProvider-a731aa78.j
 import '../../stringSet-a513039b.js';
 import '../../index-c10fcd31.js';
 import '../../_rollupPluginBabelHelpers-945410b2.js';
-import 'react-dom/server';
+import 'react-dom/server.js';
 import 'prop-types';
 import '../../const-0f759572.js';
 import '../../const-85535a89.js';
diff --git a/node_modules/@sendbird/uikit-react/OpenChannel/components/OpenChannelMessage.js b/node_modules/@sendbird/uikit-react/OpenChannel/components/OpenChannelMessage.js
index a7a3b3f..9c4c471 100644
--- a/node_modules/@sendbird/uikit-react/OpenChannel/components/OpenChannelMessage.js
+++ b/node_modules/@sendbird/uikit-react/OpenChannel/components/OpenChannelMessage.js
@@ -44,7 +44,7 @@ import '../../ui/Word.js';
 import '../../ui/MentionLabel.js';
 import '../../ui/TextButton.js';
 import '../../color-f6b2bdb7.js';
-import 'react-dom/server';
+import 'react-dom/server.js';
 import '../../const-0f759572.js';
 import '../../const-85535a89.js';
 import '../../ui/MentionUserLabel.js';
diff --git a/node_modules/@sendbird/uikit-react/OpenChannel/components/OpenChannelMessageList.js b/node_modules/@sendbird/uikit-react/OpenChannel/components/OpenChannelMessageList.js
index 240e725..c0353b7 100644
--- a/node_modules/@sendbird/uikit-react/OpenChannel/components/OpenChannelMessageList.js
+++ b/node_modules/@sendbird/uikit-react/OpenChannel/components/OpenChannelMessageList.js
@@ -49,7 +49,7 @@ import '../../ui/TextButton.js';
 import '../../color-f6b2bdb7.js';
 import '../../ui/DateSeparator.js';
 import '../../ui/MessageInput.js';
-import 'react-dom/server';
+import 'react-dom/server.js';
 import '../../const-0f759572.js';
 import '../../const-85535a89.js';
 import '../../ui/MentionUserLabel.js';
diff --git a/node_modules/@sendbird/uikit-react/OpenChannel/components/OpenChannelUI.js b/node_modules/@sendbird/uikit-react/OpenChannel/components/OpenChannelUI.js
index 9963e05..4542bdc 100644
--- a/node_modules/@sendbird/uikit-react/OpenChannel/components/OpenChannelUI.js
+++ b/node_modules/@sendbird/uikit-react/OpenChannel/components/OpenChannelUI.js
@@ -21,7 +21,7 @@ import '../../_rollupPluginBabelHelpers-945410b2.js';
 import '../../LocalizationContext-8725e9b2.js';
 import '../../stringSet-a513039b.js';
 import '../../ui/MessageInput.js';
-import 'react-dom/server';
+import 'react-dom/server.js';
 import '../../const-0f759572.js';
 import '../../const-85535a89.js';
 import '../../ui/IconButton.js';
diff --git a/node_modules/@sendbird/uikit-react/Thread.js b/node_modules/@sendbird/uikit-react/Thread.js
index 7dbf995..16dcff7 100644
--- a/node_modules/@sendbird/uikit-react/Thread.js
+++ b/node_modules/@sendbird/uikit-react/Thread.js
@@ -67,7 +67,7 @@ import './ui/MessageItemMenu.js';
 import './types-5cc94910.js';
 import './ui/MessageItemReactionMenu.js';
 import './ui/MessageInput.js';
-import 'react-dom/server';
+import 'react-dom/server.js';
 import './ui/MentionUserLabel.js';
 import 'dompurify';
 import './Thread/components/ThreadHeader.js';
diff --git a/node_modules/@sendbird/uikit-react/Thread/components/ParentMessageInfo.js b/node_modules/@sendbird/uikit-react/Thread/components/ParentMessageInfo.js
index 124beb3..6fade9b 100644
--- a/node_modules/@sendbird/uikit-react/Thread/components/ParentMessageInfo.js
+++ b/node_modules/@sendbird/uikit-react/Thread/components/ParentMessageInfo.js
@@ -64,7 +64,7 @@ import '../../const-85535a89.js';
 import '../../ui/SortByRow.js';
 import '../../sendbirdSelectors.js';
 import '../../utils-b439eac3.js';
-import 'react-dom/server';
+import 'react-dom/server.js';
 import '../../ui/MentionUserLabel.js';
 import 'dompurify';
 
diff --git a/node_modules/@sendbird/uikit-react/Thread/components/ThreadList.js b/node_modules/@sendbird/uikit-react/Thread/components/ThreadList.js
index dc33c62..2e473c5 100644
--- a/node_modules/@sendbird/uikit-react/Thread/components/ThreadList.js
+++ b/node_modules/@sendbird/uikit-react/Thread/components/ThreadList.js
@@ -44,7 +44,7 @@ import '../../withSendbird.js';
 import '../context/types.js';
 import '@sendbird/chat';
 import '../../ui/MessageInput.js';
-import 'react-dom/server';
+import 'react-dom/server.js';
 import '../../ui/MentionUserLabel.js';
 import 'dompurify';
 import '../../ui/UserProfile.js';
diff --git a/node_modules/@sendbird/uikit-react/Thread/components/ThreadListItem.js b/node_modules/@sendbird/uikit-react/Thread/components/ThreadListItem.js
index b123b5a..9b630a9 100644
--- a/node_modules/@sendbird/uikit-react/Thread/components/ThreadListItem.js
+++ b/node_modules/@sendbird/uikit-react/Thread/components/ThreadListItem.js
@@ -54,7 +54,7 @@ import '../../compareIds-87972c5f.js';
 import '../../const-85535a89.js';
 import '../../ui/ReactionButton.js';
 import '../../ui/SortByRow.js';
-import 'react-dom/server';
+import 'react-dom/server.js';
 import '../../ui/MentionUserLabel.js';
 import 'dompurify';
 import '../../sendbirdSelectors.js';
diff --git a/node_modules/@sendbird/uikit-react/Thread/components/ThreadMessageInput.js b/node_modules/@sendbird/uikit-react/Thread/components/ThreadMessageInput.js
index 8e21679..36a827d 100644
--- a/node_modules/@sendbird/uikit-react/Thread/components/ThreadMessageInput.js
+++ b/node_modules/@sendbird/uikit-react/Thread/components/ThreadMessageInput.js
@@ -11,7 +11,7 @@ import { V as VoiceMessageInputWrapper } from '../../VoiceMessageInputWrapper-94
 import { R as Role } from '../../types-5cc94910.js';
 import '../../withSendbird.js';
 import '../../_rollupPluginBabelHelpers-945410b2.js';
-import 'react-dom/server';
+import 'react-dom/server.js';
 import 'prop-types';
 import '../../const-85535a89.js';
 import '../../ui/IconButton.js';
diff --git a/node_modules/@sendbird/uikit-react/Thread/components/ThreadUI.js b/node_modules/@sendbird/uikit-react/Thread/components/ThreadUI.js
index 6dda652..b0e48df 100644
--- a/node_modules/@sendbird/uikit-react/Thread/components/ThreadUI.js
+++ b/node_modules/@sendbird/uikit-react/Thread/components/ThreadUI.js
@@ -70,7 +70,7 @@ import '../../ui/MessageItemMenu.js';
 import '../../types-5cc94910.js';
 import '../../ui/MessageItemReactionMenu.js';
 import '../../ui/MessageInput.js';
-import 'react-dom/server';
+import 'react-dom/server.js';
 import '../../ui/MentionUserLabel.js';
 import 'dompurify';
 import './ThreadListItem.js';
diff --git a/node_modules/@sendbird/uikit-react/cjs/App.js b/node_modules/@sendbird/uikit-react/cjs/App.js
index 407be41..fe5467e 100644
--- a/node_modules/@sendbird/uikit-react/cjs/App.js
+++ b/node_modules/@sendbird/uikit-react/cjs/App.js
@@ -92,7 +92,7 @@ require('./ThreadProvider-5eafb9ef.js');
 require('./Thread/context/types.js');
 require('./ui/DateSeparator.js');
 require('./ui/MessageInput.js');
-require('react-dom/server');
+require('react-dom/server.js');
 require('dompurify');
 require('./ui/MessageContent.js');
 require('./ui/MessageItemMenu.js');
diff --git a/node_modules/@sendbird/uikit-react/cjs/Channel.js b/node_modules/@sendbird/uikit-react/cjs/Channel.js
index d2e4e05..fe222d5 100644
--- a/node_modules/@sendbird/uikit-react/cjs/Channel.js
+++ b/node_modules/@sendbird/uikit-react/cjs/Channel.js
@@ -50,7 +50,7 @@ require('@sendbird/chat');
 require('./ui/DateSeparator.js');
 require('./color-97cfc61b.js');
 require('./ui/MessageInput.js');
-require('react-dom/server');
+require('react-dom/server.js');
 require('./ui/Button.js');
 require('./ui/MentionUserLabel.js');
 require('dompurify');
diff --git a/node_modules/@sendbird/uikit-react/cjs/Channel/components/ChannelUI.js b/node_modules/@sendbird/uikit-react/cjs/Channel/components/ChannelUI.js
index 2bd8d11..a64bf21 100644
--- a/node_modules/@sendbird/uikit-react/cjs/Channel/components/ChannelUI.js
+++ b/node_modules/@sendbird/uikit-react/cjs/Channel/components/ChannelUI.js
@@ -51,7 +51,7 @@ require('@sendbird/chat');
 require('../../ui/DateSeparator.js');
 require('../../color-97cfc61b.js');
 require('../../ui/MessageInput.js');
-require('react-dom/server');
+require('react-dom/server.js');
 require('../../ui/Button.js');
 require('../../ui/MentionUserLabel.js');
 require('dompurify');
diff --git a/node_modules/@sendbird/uikit-react/cjs/Channel/components/Message.js b/node_modules/@sendbird/uikit-react/cjs/Channel/components/Message.js
index ab79953..7d9ae75 100644
--- a/node_modules/@sendbird/uikit-react/cjs/Channel/components/Message.js
+++ b/node_modules/@sendbird/uikit-react/cjs/Channel/components/Message.js
@@ -40,7 +40,7 @@ require('../../ui/SortByRow.js');
 require('../../stringSet-ddd351f0.js');
 require('../../ui/ReactionButton.js');
 require('../../color-97cfc61b.js');
-require('react-dom/server');
+require('react-dom/server.js');
 require('../../ui/IconButton.js');
 require('../../ui/Button.js');
 require('../../ui/MentionUserLabel.js');
diff --git a/node_modules/@sendbird/uikit-react/cjs/Channel/components/MessageInput.js b/node_modules/@sendbird/uikit-react/cjs/Channel/components/MessageInput.js
index e81b53e..90687da 100644
--- a/node_modules/@sendbird/uikit-react/cjs/Channel/components/MessageInput.js
+++ b/node_modules/@sendbird/uikit-react/cjs/Channel/components/MessageInput.js
@@ -32,7 +32,7 @@ require('../../ui/ReactionButton.js');
 require('../../ui/ImageRenderer.js');
 require('../../ui/Icon.js');
 require('../../consts-f82aaae9.js');
-require('react-dom/server');
+require('react-dom/server.js');
 require('../../ui/IconButton.js');
 require('../../ui/Button.js');
 require('../../ui/MentionUserLabel.js');
diff --git a/node_modules/@sendbird/uikit-react/cjs/Channel/components/MessageList.js b/node_modules/@sendbird/uikit-react/cjs/Channel/components/MessageList.js
index cc751b9..00278b4 100644
--- a/node_modules/@sendbird/uikit-react/cjs/Channel/components/MessageList.js
+++ b/node_modules/@sendbird/uikit-react/cjs/Channel/components/MessageList.js
@@ -43,7 +43,7 @@ require('@sendbird/chat');
 require('../../ui/DateSeparator.js');
 require('../../color-97cfc61b.js');
 require('../../ui/MessageInput.js');
-require('react-dom/server');
+require('react-dom/server.js');
 require('../../ui/IconButton.js');
 require('../../ui/Button.js');
 require('../../ui/MentionUserLabel.js');
diff --git a/node_modules/@sendbird/uikit-react/cjs/OpenChannel.js b/node_modules/@sendbird/uikit-react/cjs/OpenChannel.js
index 2d1259e..bdc367a 100644
--- a/node_modules/@sendbird/uikit-react/cjs/OpenChannel.js
+++ b/node_modules/@sendbird/uikit-react/cjs/OpenChannel.js
@@ -9,7 +9,7 @@ require('./stringSet-ddd351f0.js');
 require('./index-f5502150.js');
 require('./ui/MessageInput.js');
 require('./_rollupPluginBabelHelpers-32557b21.js');
-require('react-dom/server');
+require('react-dom/server.js');
 require('prop-types');
 require('./const-fe838b59.js');
 require('./const-77194948.js');
diff --git a/node_modules/@sendbird/uikit-react/cjs/OpenChannel/components/OpenChannelInput.js b/node_modules/@sendbird/uikit-react/cjs/OpenChannel/components/OpenChannelInput.js
index 2d55c03..a84d033 100644
--- a/node_modules/@sendbird/uikit-react/cjs/OpenChannel/components/OpenChannelInput.js
+++ b/node_modules/@sendbird/uikit-react/cjs/OpenChannel/components/OpenChannelInput.js
@@ -7,7 +7,7 @@ var OpenChannel_context = require('../../OpenChannelProvider-1e578c60.js');
 require('../../stringSet-ddd351f0.js');
 require('../../index-f5502150.js');
 require('../../_rollupPluginBabelHelpers-32557b21.js');
-require('react-dom/server');
+require('react-dom/server.js');
 require('prop-types');
 require('../../const-fe838b59.js');
 require('../../const-77194948.js');
diff --git a/node_modules/@sendbird/uikit-react/cjs/OpenChannel/components/OpenChannelMessage.js b/node_modules/@sendbird/uikit-react/cjs/OpenChannel/components/OpenChannelMessage.js
index 321dc8c..0ca1fb4 100644
--- a/node_modules/@sendbird/uikit-react/cjs/OpenChannel/components/OpenChannelMessage.js
+++ b/node_modules/@sendbird/uikit-react/cjs/OpenChannel/components/OpenChannelMessage.js
@@ -46,7 +46,7 @@ require('../../ui/Word.js');
 require('../../ui/MentionLabel.js');
 require('../../ui/TextButton.js');
 require('../../color-97cfc61b.js');
-require('react-dom/server');
+require('react-dom/server.js');
 require('../../const-fe838b59.js');
 require('../../const-77194948.js');
 require('../../ui/MentionUserLabel.js');
diff --git a/node_modules/@sendbird/uikit-react/cjs/OpenChannel/components/OpenChannelMessageList.js b/node_modules/@sendbird/uikit-react/cjs/OpenChannel/components/OpenChannelMessageList.js
index 6ab3b81..30cf160 100644
--- a/node_modules/@sendbird/uikit-react/cjs/OpenChannel/components/OpenChannelMessageList.js
+++ b/node_modules/@sendbird/uikit-react/cjs/OpenChannel/components/OpenChannelMessageList.js
@@ -51,7 +51,7 @@ require('../../ui/TextButton.js');
 require('../../color-97cfc61b.js');
 require('../../ui/DateSeparator.js');
 require('../../ui/MessageInput.js');
-require('react-dom/server');
+require('react-dom/server.js');
 require('../../const-fe838b59.js');
 require('../../const-77194948.js');
 require('../../ui/MentionUserLabel.js');
diff --git a/node_modules/@sendbird/uikit-react/cjs/OpenChannel/components/OpenChannelUI.js b/node_modules/@sendbird/uikit-react/cjs/OpenChannel/components/OpenChannelUI.js
index 42b8fea..936c81d 100644
--- a/node_modules/@sendbird/uikit-react/cjs/OpenChannel/components/OpenChannelUI.js
+++ b/node_modules/@sendbird/uikit-react/cjs/OpenChannel/components/OpenChannelUI.js
@@ -23,7 +23,7 @@ require('../../_rollupPluginBabelHelpers-32557b21.js');
 require('../../LocalizationContext-1f669b3c.js');
 require('../../stringSet-ddd351f0.js');
 require('../../ui/MessageInput.js');
-require('react-dom/server');
+require('react-dom/server.js');
 require('../../const-fe838b59.js');
 require('../../const-77194948.js');
 require('../../ui/IconButton.js');
diff --git a/node_modules/@sendbird/uikit-react/cjs/Thread.js b/node_modules/@sendbird/uikit-react/cjs/Thread.js
index 7b8b25b..0054f22 100644
--- a/node_modules/@sendbird/uikit-react/cjs/Thread.js
+++ b/node_modules/@sendbird/uikit-react/cjs/Thread.js
@@ -69,7 +69,7 @@ require('./ui/MessageItemMenu.js');
 require('./types-3fb94919.js');
 require('./ui/MessageItemReactionMenu.js');
 require('./ui/MessageInput.js');
-require('react-dom/server');
+require('react-dom/server.js');
 require('./ui/MentionUserLabel.js');
 require('dompurify');
 require('./Thread/components/ThreadHeader.js');
diff --git a/node_modules/@sendbird/uikit-react/cjs/Thread/components/ParentMessageInfo.js b/node_modules/@sendbird/uikit-react/cjs/Thread/components/ParentMessageInfo.js
index 889e43b..118fb62 100644
--- a/node_modules/@sendbird/uikit-react/cjs/Thread/components/ParentMessageInfo.js
+++ b/node_modules/@sendbird/uikit-react/cjs/Thread/components/ParentMessageInfo.js
@@ -66,7 +66,7 @@ require('../../const-77194948.js');
 require('../../ui/SortByRow.js');
 require('../../sendbirdSelectors.js');
 require('../../utils-602ab2fc.js');
-require('react-dom/server');
+require('react-dom/server.js');
 require('../../ui/MentionUserLabel.js');
 require('dompurify');
 
diff --git a/node_modules/@sendbird/uikit-react/cjs/Thread/components/ThreadList.js b/node_modules/@sendbird/uikit-react/cjs/Thread/components/ThreadList.js
index 20add2d..091fece 100644
--- a/node_modules/@sendbird/uikit-react/cjs/Thread/components/ThreadList.js
+++ b/node_modules/@sendbird/uikit-react/cjs/Thread/components/ThreadList.js
@@ -46,7 +46,7 @@ require('../../withSendbird.js');
 require('../context/types.js');
 require('@sendbird/chat');
 require('../../ui/MessageInput.js');
-require('react-dom/server');
+require('react-dom/server.js');
 require('../../ui/MentionUserLabel.js');
 require('dompurify');
 require('../../ui/UserProfile.js');
diff --git a/node_modules/@sendbird/uikit-react/cjs/Thread/components/ThreadListItem.js b/node_modules/@sendbird/uikit-react/cjs/Thread/components/ThreadListItem.js
index a9da497..2f1565c 100644
--- a/node_modules/@sendbird/uikit-react/cjs/Thread/components/ThreadListItem.js
+++ b/node_modules/@sendbird/uikit-react/cjs/Thread/components/ThreadListItem.js
@@ -56,7 +56,7 @@ require('../../compareIds-32f97a73.js');
 require('../../const-77194948.js');
 require('../../ui/ReactionButton.js');
 require('../../ui/SortByRow.js');
-require('react-dom/server');
+require('react-dom/server.js');
 require('../../ui/MentionUserLabel.js');
 require('dompurify');
 require('../../sendbirdSelectors.js');
diff --git a/node_modules/@sendbird/uikit-react/cjs/Thread/components/ThreadMessageInput.js b/node_modules/@sendbird/uikit-react/cjs/Thread/components/ThreadMessageInput.js
index cddd86f..ab7008f 100644
--- a/node_modules/@sendbird/uikit-react/cjs/Thread/components/ThreadMessageInput.js
+++ b/node_modules/@sendbird/uikit-react/cjs/Thread/components/ThreadMessageInput.js
@@ -13,7 +13,7 @@ var VoiceMessageInputWrapper = require('../../VoiceMessageInputWrapper-5bb0ed00.
 var types = require('../../types-3fb94919.js');
 require('../../withSendbird.js');
 require('../../_rollupPluginBabelHelpers-32557b21.js');
-require('react-dom/server');
+require('react-dom/server.js');
 require('prop-types');
 require('../../const-77194948.js');
 require('../../ui/IconButton.js');
diff --git a/node_modules/@sendbird/uikit-react/cjs/Thread/components/ThreadUI.js b/node_modules/@sendbird/uikit-react/cjs/Thread/components/ThreadUI.js
index 2783923..8bcc5e2 100644
--- a/node_modules/@sendbird/uikit-react/cjs/Thread/components/ThreadUI.js
+++ b/node_modules/@sendbird/uikit-react/cjs/Thread/components/ThreadUI.js
@@ -72,7 +72,7 @@ require('../../ui/MessageItemMenu.js');
 require('../../types-3fb94919.js');
 require('../../ui/MessageItemReactionMenu.js');
 require('../../ui/MessageInput.js');
-require('react-dom/server');
+require('react-dom/server.js');
 require('../../ui/MentionUserLabel.js');
 require('dompurify');
 require('./ThreadListItem.js');
diff --git a/node_modules/@sendbird/uikit-react/cjs/index.js b/node_modules/@sendbird/uikit-react/cjs/index.js
index f323ad0..dc1f94d 100644
--- a/node_modules/@sendbird/uikit-react/cjs/index.js
+++ b/node_modules/@sendbird/uikit-react/cjs/index.js
@@ -82,7 +82,7 @@ require('./ui/MessageItemMenu.js');
 require('./types-3fb94919.js');
 require('./ui/MessageItemReactionMenu.js');
 require('./ui/MessageInput.js');
-require('react-dom/server');
+require('react-dom/server.js');
 require('./ui/MentionUserLabel.js');
 require('dompurify');
 require('./Thread/components/ThreadHeader.js');
diff --git a/node_modules/@sendbird/uikit-react/cjs/ui/MessageInput.js b/node_modules/@sendbird/uikit-react/cjs/ui/MessageInput.js
index 578612f..613e647 100644
--- a/node_modules/@sendbird/uikit-react/cjs/ui/MessageInput.js
+++ b/node_modules/@sendbird/uikit-react/cjs/ui/MessageInput.js
@@ -2,7 +2,7 @@
 
 var _rollupPluginBabelHelpers = require('../_rollupPluginBabelHelpers-32557b21.js');
 var React = require('react');
-var server = require('react-dom/server');
+var server = require('react-dom/server.js');
 var PropTypes = require('prop-types');
 var _const$1 = require('../const-fe838b59.js');
 var _const = require('../const-77194948.js');
diff --git a/node_modules/@sendbird/uikit-react/cjs/ui/MessageInput.js.map b/node_modules/@sendbird/uikit-react/cjs/ui/MessageInput.js.map
index 0951d84..12f5571 100644
--- a/node_modules/@sendbird/uikit-react/cjs/ui/MessageInput.js.map
+++ b/node_modules/@sendbird/uikit-react/cjs/ui/MessageInput.js.map
@@ -1 +1 @@
-{"version":3,"file":"MessageInput.js","sources":["../../../src/ui/MessageInput/utils.js","../../../src/ui/MessageInput/hooks/usePaste/insertTemplate.tsx","../../../src/ui/MessageInput/hooks/usePaste/consts.ts","../../../src/ui/MessageInput/hooks/usePaste/utils.ts","../../../src/ui/MessageInput/hooks/usePaste/index.ts","../../../src/ui/MessageInput/index.jsx"],"sourcesContent":["// https://davidwalsh.name/javascript-debounce-function\n// Returns a function, that, as long as it continues to be invoked, will not\n// be triggered. The function will be called after it stops being called for\n// N milliseconds. If `immediate` is passed, trigger the function on the\n// leading edge, instead of the trailing.\nexport function debounce(func, wait, immediate) {\n  let timeout;\n  return function _debounce() {\n    const context = this;\n    // eslint-disable-next-line prefer-rest-params\n    const args = arguments;\n    const later = () => {\n      timeout = null;\n      if (!immediate) func.apply(context, args);\n    };\n    const callNow = immediate && !timeout;\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n    if (callNow) func.apply(context, args);\n  };\n}\n\n// Sanitize that special characters of HTML tags cause XSS issue\nexport const sanitizeString = (str) => (\n  str?.replace(/[\\u00A0-\\u9999<>]/gim, (i) => ''.concat('&#', i.charCodeAt(0), ';'))\n);\n\nexport default debounce;\n","import React from 'react';\nimport { renderToString } from 'react-dom/server';\n\nimport { Word } from './types';\nimport { sanitizeString } from '../../utils';\nimport MentionUserLabel from '../../../MentionUserLabel';\n\nexport function inserTemplateToDOM(templateList: Word[]): void {\n  const nodes = templateList.map((template) => {\n    const { text, userId } = template;\n    if (userId) {\n      return (\n        renderToString(\n          <>\n            <MentionUserLabel userId={userId}>\n              {text}\n            </MentionUserLabel>\n          </>\n        )\n      );\n    }\n    return sanitizeString(text);\n  })\n  .join(' ')\n  // add a space at the end of the mention, else cursor/caret wont work\n  .concat(' ');\n  document.execCommand('insertHTML', false, nodes);\n}\n","export const PASTE_NODE = 'sendbird-uikit__paste-node';\nexport const TEXT_MESSAGE_CLASS = 'sendbird-word';\nexport const MENTION_CLASS = 'sendbird-word__mention';\nexport const MENTION_CLASS_IN_INPUT = 'sendbird-mention-user-label';\nexport const MENTION_CLASS_COMBINED_QUERY = `.${MENTION_CLASS}, .${MENTION_CLASS_IN_INPUT}`;\n","import { GroupChannel } from '@sendbird/chat/groupChannel';\nimport { User } from '@sendbird/chat';\n\nimport {\n  PASTE_NODE,\n  MENTION_CLASS,\n  TEXT_MESSAGE_CLASS,\n  MENTION_CLASS_COMBINED_QUERY,\n  MENTION_CLASS_IN_INPUT,\n} from './consts';\nimport { Word } from './types';\n\nexport function createPasteNode(): HTMLDivElement | null {\n  const pasteNode = document.body.querySelector(`#${PASTE_NODE}`);\n  // remove existing paste node\n  if (pasteNode) {\n    pasteNode?.remove();\n  }\n\n  // create new paste node and return\n  const node = document.createElement('div');\n  node.id = PASTE_NODE;\n  node.style.display = 'none';\n  return node;\n}\n\nexport function hasMention(parent: HTMLDivElement): boolean {\n  return parent?.querySelector(MENTION_CLASS_COMBINED_QUERY) ? true : false;\n}\n\nexport const extractTextFromNodes = (nodes: HTMLSpanElement[]): string => {\n  let text = '';\n  nodes.forEach((node) => {\n    // to preserve space between words\n    const textNodes = node.querySelectorAll(`.${TEXT_MESSAGE_CLASS}`);\n    if (textNodes.length > 0) {\n      text += ((extractTextFromNodes(Array.from(textNodes) as HTMLSpanElement[])) + ' ');\n    }\n    text += (node.innerText + ' ');\n  });\n  return text;\n}\n\nexport function domToMessageTemplate(nodeArray: HTMLSpanElement[]): Word[] {\n  const templates: Word[] = nodeArray?.reduce((accumulator, currentValue) => {\n    let mentionNode = currentValue.querySelector(MENTION_CLASS_COMBINED_QUERY) as HTMLSpanElement;\n    // sometimes the mention node is the parent node\n    // in this case querySelector will return null\n    if (!mentionNode) {\n      mentionNode = (\n        currentValue.classList.contains(MENTION_CLASS)  // for nodes copied from message\n        || currentValue.classList.contains(MENTION_CLASS_IN_INPUT) // for nodes copied from input\n      ) ? currentValue : null;\n    }\n    const text = currentValue.innerText;\n    if (mentionNode) {\n      const userId = mentionNode.dataset?.userid;\n      return [\n        ...accumulator,\n        {\n          text,\n          userId,\n        },\n      ];\n    }\n\n    return [\n      ...accumulator,\n      {\n        text,\n      },\n    ];\n  }, [] as Word[]);\n  return templates;\n}\n\nexport function getUsersFromWords(templates: Word[], channel: GroupChannel): User[] {\n  const userMap = {};\n  const users = channel.members;\n  templates.forEach((template) => {\n    if (template.userId) {\n      userMap[template.userId] = users.find((user) => user.userId === template.userId);\n    }\n  });\n  return Object.values(userMap);\n}\n","import { useCallback } from 'react';\nimport DOMPurify from 'dompurify';\n\nimport { inserTemplateToDOM } from './insertTemplate';\nimport { sanitizeString } from '../../utils';\nimport { DynamicProps } from './types';\nimport { MENTION_CLASS_COMBINED_QUERY, MENTION_CLASS_IN_INPUT, TEXT_MESSAGE_CLASS } from './consts';\nimport {\n  createPasteNode,\n  hasMention,\n  domToMessageTemplate,\n  getUsersFromWords,\n  extractTextFromNodes,\n} from './utils';\n\n// conditions to test:\n// 1. paste simple text\n// 2. paste text with mention\n// 3. paste text with mention and text\n// 4. paste text with mention and text and paste again before and after\n// 5. copy message with mention(only one mention, no other text) and paste\n// 6. copy message with mention from input and paste(before and after)\nexport default function usePaste({\n  ref,\n  setIsInput,\n  setHeight,\n  channel,\n  setMentionedUsers,\n}: DynamicProps): (e: React.ClipboardEvent<HTMLDivElement>) => void {\n  return useCallback((e) => {\n    e.preventDefault();\n    const html = e?.clipboardData.getData('text/html');\n    // simple text, continue as normal\n    if (!html) {\n      const text = e?.clipboardData.getData('text');\n      document.execCommand('insertHTML', false, sanitizeString(text));\n      setIsInput(true);\n      setHeight();\n      return;\n    }\n\n    // has html, check if there are mentions, sanitize and insert\n    const purifier = DOMPurify(window);\n    const clean = purifier.sanitize(html);\n    const pasteNode = createPasteNode();\n    pasteNode.innerHTML = clean;\n    // does not have mention, continue as normal\n    if (!hasMention(pasteNode)) {\n      // to preserve space between words\n      const text = extractTextFromNodes(Array.from(pasteNode.children) as HTMLSpanElement[]);\n      document.execCommand('insertHTML', false, sanitizeString(text));\n      pasteNode.remove();\n      setIsInput(true);\n      setHeight();\n      return;\n    }\n\n    // has mention, sanitize and insert\n    let childNodes = pasteNode.querySelectorAll(`.${TEXT_MESSAGE_CLASS}`) as NodeListOf<HTMLSpanElement>;\n    if (pasteNode.querySelectorAll(`.${MENTION_CLASS_IN_INPUT}`).length > 0) {\n      // @ts-ignore\n      childNodes = pasteNode.children;\n    }\n    let nodeArray = Array.from(childNodes);\n    // handle paste when there is only one child\n    if (pasteNode.children.length === 1 && pasteNode.querySelectorAll(MENTION_CLASS_COMBINED_QUERY).length === 1) {\n      nodeArray = Array.from(pasteNode.children) as HTMLSpanElement[];\n    }\n    const words = domToMessageTemplate(nodeArray);\n\n    const mentionedUsers = getUsersFromWords(words, channel);\n    setMentionedUsers(mentionedUsers);\n    inserTemplateToDOM(words);\n    pasteNode.remove();\n    setIsInput(true);\n    setHeight();\n    return;\n\n  }, [ref, setIsInput, setHeight, channel, setMentionedUsers]);\n}\n","import React, {\n  useRef,\n  useMemo,\n  useState,\n  useEffect,\n  useCallback,\n  useContext,\n} from 'react';\nimport { renderToString } from 'react-dom/server';\nimport PropTypes from 'prop-types';\n\nimport './index.scss';\nimport { MessageInputKeys, NodeNames, NodeTypes } from './const';\n\nimport { USER_MENTION_TEMP_CHAR } from '../../smart-components/Channel/context/const';\nimport IconButton from '../IconButton';\nimport Button, { ButtonTypes, ButtonSizes } from '../Button';\nimport MentionUserLabel from '../MentionUserLabel';\nimport Icon, { IconTypes, IconColors } from '../Icon';\nimport Label, { LabelTypography, LabelColors } from '../Label';\nimport { LocalizationContext } from '../../lib/LocalizationContext';\nimport { sanitizeString } from './utils';\nimport {\n  arrayEqual,\n  getClassName,\n  StringObjType,\n  convertWordToStringObj,\n} from '../../utils';\nimport usePaste from './hooks/usePaste';\n\nconst TEXT_FIELD_ID = 'sendbird-message-input-text-field';\nconst LINE_HEIGHT = 76;\nconst noop = () => { };\nconst handleUploadFile = (callback) => (event) => {\n  if (event.target.files && event.target.files[0]) {\n    callback(event.target.files[0]);\n  }\n  // eslint-disable-next-line no-param-reassign\n  event.target.value = '';\n};\n\nconst displayCaret = (element, position) => {\n  const range = document.createRange();\n  const sel = window.getSelection();\n  range.setStart(element.childNodes[0], position);\n  range.collapse(true);\n  sel.removeAllRanges();\n  sel.addRange(range);\n  element.focus();\n}\n\nconst resetInput = (ref) => {\n  try {\n    ref.current.innerHTML = '';\n  } catch {\n    //\n  }\n}\n\nconst initialTargetStringInfo = {\n  targetString: '',\n  startNodeIndex: null,\n  startOffsetIndex: null,\n  endNodeIndex: null,\n  endOffsetIndex: null,\n};\n\nconst MessageInput = React.forwardRef((props, ref) => {\n  const {\n    className,\n    messageFieldId,\n    isEdit,\n    isMentionEnabled,\n    isVoiceMessageEnabled,\n    disabled,\n    message,\n    placeholder,\n    maxLength,\n    onFileUpload,\n    onSendMessage,\n    onUpdateMessage,\n    onCancelEdit,\n    onStartTyping,\n    channelUrl,\n    channel,\n    mentionSelectedUser,\n    onUserMentioned,\n    onMentionStringChange,\n    onMentionedUserIdsUpdated,\n    onVoiceMessageIconClick,\n    onKeyUp,\n    onKeyDown,\n    renderFileUploadIcon,\n    renderVoiceMessageIcon,\n    renderSendMessageIcon,\n    setMentionedUsers,\n  } = props;\n  const textFieldId = messageFieldId || TEXT_FIELD_ID;\n  const { stringSet } = useContext(LocalizationContext);\n  const fileInputRef = useRef(null);\n  const [isInput, setIsInput] = useState(false);\n  const [mentionedUserIds, setMentionedUserIds] = useState([]);\n  const [targetStringInfo, setTargetStringInfo] = useState({ ...initialTargetStringInfo });\n  const setHeight = useMemo(() => (\n    () => {\n      try {\n        const elem = ref?.current;\n        const MAX_HEIGHT = window.document.body.offsetHeight * 0.6;\n        if (elem && elem.scrollHeight >= LINE_HEIGHT) {\n          if (MAX_HEIGHT < elem.scrollHeight) {\n            elem.style.height = 'auto';\n            elem.style.height = `${MAX_HEIGHT}px`;\n          } else {\n            elem.style.height = 'auto';\n            elem.style.height = `${elem.scrollHeight}px`;\n          }\n        } else {\n          elem.style.height = '';\n        }\n      } catch (error) {\n        // error\n      }\n    }\n  ), []);\n\n  // #Edit mode\n  // for easilly initialize input value from outside, but\n  // useEffect(_, [channelUrl]) erase it\n  const initialValue = props?.value;\n  useEffect(() => {\n    const textField = ref?.current;\n    try {\n      textField.innerHTML = initialValue;\n      displayCaret(textField, initialValue?.length);\n    } catch { }\n    setMentionedUserIds([]);\n    setIsInput(textField?.innerText?.length > 0);\n    setHeight();\n  }, [initialValue]);\n\n  // #Mention | Clear input value when channel changes\n  useEffect(() => {\n    if (!isEdit) {\n      setIsInput(false);\n      resetInput(ref);\n    }\n  }, [channelUrl]);\n\n  // #Mention & #Edit | Fill message input values\n  useEffect(() => {\n    if (isEdit && message?.messageId) {\n      // const textField = document.getElementById(textFieldId);\n      const textField = ref?.current;\n      if (isMentionEnabled\n        && message?.mentionedUsers?.length > 0\n        && message?.mentionedMessageTemplate?.length > 0\n      ) {\n        /* mention enabled */\n        const { mentionedUsers = [] } = message;\n        textField.innerHTML = message?.mentionedMessageTemplate?.split(' ').map((word) => (\n          convertWordToStringObj(word, mentionedUsers).map((stringObj) => {\n            const { type, value, userId } = stringObj;\n            if (type === StringObjType.mention && mentionedUsers.some((user) => user?.userId === userId)) {\n              return renderToString(\n                <MentionUserLabel userId={userId}>\n                  {\n                    `${USER_MENTION_TEMP_CHAR}${mentionedUsers.find((user) => user?.userId === userId)?.nickname\n                    || value\n                    || stringSet.MENTION_NAME__NO_NAME\n                    }`\n                  }\n                </MentionUserLabel>,\n              );\n            }\n            return sanitizeString(value);\n          }).join('')\n        )).join(' ');\n      } else {\n        /* mention disabled */\n        try {\n          textField.innerHTML = sanitizeString(message?.message);\n        } catch { }\n        setMentionedUserIds([]);\n      }\n      setIsInput(textField?.innerText?.length > 0);\n      setHeight();\n    }\n  }, [isEdit, message]);\n\n  // #Mention | Detect MentionedLabel modified\n  const useMentionedLabelDetection = useCallback(() => {\n    const textField = ref?.current;\n    if (isMentionEnabled) {\n      const newMentionedUserIds = [...textField.getElementsByClassName('sendbird-mention-user-label')].map((node) => node?.dataset?.userid);\n      if (!arrayEqual(mentionedUserIds, newMentionedUserIds) || newMentionedUserIds.length === 0) {\n        onMentionedUserIdsUpdated(newMentionedUserIds);\n        setMentionedUserIds(newMentionedUserIds);\n      }\n    }\n    setIsInput(textField.innerText.length > 0);\n  }, [targetStringInfo, isMentionEnabled]);\n\n  // #Mention | Replace selected user nickname to the MentionedUserLabel\n  useEffect(() => {\n    if (isMentionEnabled && mentionSelectedUser) {\n      const {\n        targetString,\n        startNodeIndex,\n        startOffsetIndex,\n        endNodeIndex,\n        endOffsetIndex,\n      } = targetStringInfo;\n      if (targetString && startNodeIndex !== null && startOffsetIndex !== null) {\n        // const textField = document.getElementById(textFieldId);\n        const textField = ref?.current;\n        const childNodes = [...textField?.childNodes];\n        const frontTextNode = document?.createTextNode(\n          childNodes[startNodeIndex]?.textContent.slice(0, startOffsetIndex),\n        );\n        const backTextNode = document?.createTextNode(\n          `\\u00A0${childNodes[endNodeIndex]?.textContent.slice(endOffsetIndex)}`,\n        );\n        const mentionLabel = renderToString(\n          <MentionUserLabel userId={mentionSelectedUser?.userId}>\n            {`${USER_MENTION_TEMP_CHAR}${mentionSelectedUser?.nickname || stringSet.MENTION_NAME__NO_NAME}`}\n          </MentionUserLabel>,\n        );\n        const div = document.createElement('div');\n        div.innerHTML = mentionLabel;\n        const newNodes = [\n          ...childNodes.slice(0, startNodeIndex),\n          frontTextNode,\n          div.childNodes[0],\n          backTextNode,\n          ...childNodes.slice(endNodeIndex + 1),\n        ];\n        textField.innerHTML = '';\n        newNodes.forEach((newNode) => {\n          textField.appendChild(newNode);\n        });\n        onUserMentioned(mentionSelectedUser);\n        if (window.getSelection || document.getSelection) {\n          // set caret postion\n          const selection = window.getSelection() || document.getSelection();\n          selection.removeAllRanges();\n          const range = new Range();\n          range.selectNodeContents(textField);\n          range.setStart(textField.childNodes[startNodeIndex + 2], 1);\n          range.setEnd(textField.childNodes[startNodeIndex + 2], 1);\n          range.collapse(false);\n          selection.addRange(range);\n          textField.focus();\n        }\n        setTargetStringInfo({ ...initialTargetStringInfo });\n        setHeight();\n        useMentionedLabelDetection();\n      }\n    }\n  }, [mentionSelectedUser, isMentionEnabled]);\n\n  // #Mention | Detect mentioning user nickname\n  const useMentionInputDetection = useCallback(() => {\n    const selection = window?.getSelection?.() || document?.getSelection?.();\n    const textField = ref?.current;\n    if (selection.anchorNode === textField) {\n      onMentionStringChange('');\n    }\n    if (isMentionEnabled && selection\n      && selection.anchorNode === selection.focusNode\n      && selection.anchorOffset === selection.focusOffset\n    ) {\n      let textStack = '';\n      let startNodeIndex = null;\n      let startOffsetIndex = null;\n      for (let index = 0; index < textField.childNodes.length; index += 1) {\n        const currentNode = textField.childNodes[index];\n        if (currentNode.nodeType === NodeTypes.TextNode) {\n          /* text node */\n          const textContent = (currentNode === selection.anchorNode)\n            ? currentNode?.textContent.slice(0, selection.anchorOffset) || ''\n            : currentNode?.textContent || '';\n          if (textStack.length > 0) {\n            textStack += textContent;\n          } else {\n            let charLastIndex = textContent.lastIndexOf(USER_MENTION_TEMP_CHAR);\n            for (let i = charLastIndex - 1; i > -1; i -= 1) {\n              if (textContent[i] === USER_MENTION_TEMP_CHAR) {\n                charLastIndex = i;\n              } else {\n                break;\n              }\n            }\n            if (charLastIndex > -1) {\n              textStack = textContent;\n              startNodeIndex = index;\n              startOffsetIndex = charLastIndex;\n            }\n          }\n        } else {\n          /* other nodes */\n          textStack = '';\n          startNodeIndex = null;\n          startOffsetIndex = null;\n        }\n        if (currentNode === selection.anchorNode) {\n          /**\n           * targetString could be ''\n           * startNodeIndex and startOffsetIndex could be null\n           */\n          const targetString = textStack ? textStack.slice(startOffsetIndex) : '';// include template character\n          setTargetStringInfo({\n            targetString,\n            startNodeIndex,\n            startOffsetIndex,\n            endNodeIndex: index,\n            endOffsetIndex: selection.anchorOffset,\n          });\n          onMentionStringChange(targetString);\n          return;\n        }\n      }\n    }\n  }, [isMentionEnabled]);\n\n  const sendMessage = () => {\n    const textField = ref?.current;\n    if (!isEdit && textField?.innerText) {\n      let messageText = '';\n      let mentionTemplate = '';\n      textField.childNodes.forEach((node) => {\n        if (node.nodeType === NodeTypes.ElementNode && node.nodeName === NodeNames.Span) {\n          const { innerText, dataset = {} } = node;\n          const { userid = '' } = dataset;\n          messageText += innerText;\n          mentionTemplate += `${USER_MENTION_TEMP_CHAR}{${userid}}`;\n        } else if (node.nodeType === NodeTypes.ElementNode && node.nodeName === NodeNames.Br) {\n          messageText += '\\n';\n          mentionTemplate += '\\n';\n        } else { // other nodes including text node\n          const { textContent = '' } = node;\n          messageText += textContent;\n          mentionTemplate += textContent;\n        }\n      });\n      const params = { message: messageText, mentionTemplate };\n      onSendMessage(params);\n      resetInput(ref);\n      setIsInput(false);\n      setHeight();\n    }\n  };\n  const isEditDisabled = !(ref?.current?.innerText?.trim());\n  const editMessage = () => {\n    const textField = ref?.current;\n    const messageId = message?.messageId;\n    if (isEdit && messageId) {\n      let messageText = '';\n      let mentionTemplate = '';\n      textField.childNodes.forEach((node) => {\n        if (node.nodeType === NodeTypes.ElementNode && node.nodeName === NodeNames.Span) {\n          const { innerText, dataset = {} } = node;\n          const { userid = '' } = dataset;\n          messageText += innerText;\n          mentionTemplate += `${USER_MENTION_TEMP_CHAR}{${userid}}`;\n        } else if (node.nodeType === NodeTypes.ElementNode && node.nodeName === NodeNames.Span) {\n          messageText += '\\n';\n          mentionTemplate += '\\n';\n        } else { // other nodes including text node\n          const { textContent = '' } = node;\n          messageText += textContent;\n          mentionTemplate += textContent;\n        }\n      });\n      const params = { messageId, message: messageText, mentionTemplate };\n      onUpdateMessage(params);\n      resetInput(ref);\n    }\n  };\n  const onPaste = usePaste({\n    ref,\n    setMentionedUserIds,\n    setMentionedUsers,\n    channel,\n    setIsInput,\n    setHeight,\n  });\n\n  return (\n    <form\n      className={getClassName([\n        className,\n        isEdit ? 'sendbird-message-input__edit' : '',\n        disabled ? 'sendbird-message-input-form__disabled' : '',\n      ])}\n    >\n      <div\n        className={getClassName([\n          'sendbird-message-input',\n          disabled ? 'sendbird-message-input__disabled' : '',\n        ])}\n      >\n        <div\n          id={`${textFieldId}${isEdit ? message?.messageId : ''}`}\n          className={`sendbird-message-input--textarea ${textFieldId}`}\n          contentEditable={!disabled}\n          role=\"textbox\"\n          aria-label=\"Text Input\"\n          disabled={disabled}\n          ref={ref}\n          maxLength={maxLength}\n          onKeyDown={(e) => {\n            const preventEvent = onKeyDown(e);\n            if (preventEvent) {\n              e.preventDefault();\n            } else {\n              if (!e.shiftKey && e.key === MessageInputKeys.Enter && e?.nativeEvent?.isComposing !== true) {\n                e.preventDefault();\n                sendMessage();\n              }\n              if (e.key === MessageInputKeys.Backspace\n                && ref?.current?.childNodes?.length === 2\n                && !ref?.current?.childNodes?.[0]?.textContent\n                && ref?.current.childNodes?.[1]?.nodeType === NodeTypes.ElementNode\n              ) {\n                ref?.current.removeChild(ref?.current.childNodes[1]);\n              }\n            }\n          }}\n          onKeyUp={(e) => {\n            const preventEvent = onKeyUp(e);\n            if (preventEvent) {\n              e.preventDefault();\n            } else {\n              useMentionInputDetection();\n            }\n          }}\n          onClick={() => {\n            useMentionInputDetection();\n          }}\n          onInput={() => {\n            setHeight();\n            onStartTyping();\n            setIsInput(ref?.current?.innerText?.length > 0);\n            useMentionedLabelDetection();\n          }}\n          onPaste={onPaste}\n        />\n        {/* placeholder */}\n        {!isInput && (\n          <Label\n            className=\"sendbird-message-input--placeholder\"\n            type={LabelTypography.BODY_1}\n            color={disabled? LabelColors.ONBACKGROUND_4 : LabelColors.ONBACKGROUND_3}\n          >\n            {placeholder || stringSet.MESSAGE_INPUT__PLACE_HOLDER}\n          </Label>\n        )}\n        {/* send icon */}\n        {\n          (!isEdit && isInput) && (\n            <IconButton\n              className=\"sendbird-message-input--send\"\n              height=\"32px\"\n              width=\"32px\"\n              onClick={() => sendMessage()}\n            >\n              {\n                renderSendMessageIcon?.() || (\n                  <Icon\n                    type={IconTypes.SEND}\n                    fillColor={disabled ? IconColors.ON_BACKGROUND_4 : IconColors.PRIMARY}\n                    width=\"20px\"\n                    height=\"20px\"\n                  />\n                )\n              }\n            </IconButton>\n          )\n        }\n        {/* file upload icon */}\n        {\n          (!isEdit && !isInput) && (\n            (renderFileUploadIcon?.() || (\n              <IconButton\n                className={`sendbird-message-input--attach ${isVoiceMessageEnabled ? 'is-voice-message-enabled' : ''}`}\n                height=\"32px\"\n                width=\"32px\"\n                onClick={() => {\n                  // todo: clear previous input\n                  fileInputRef?.current?.click?.();\n                }}\n              >\n                <Icon\n                  type={IconTypes.ATTACH}\n                  fillColor={disabled ? IconColors.ON_BACKGROUND_4 : IconColors.CONTENT_INVERSE}\n                  width=\"20px\"\n                  height=\"20px\"\n                />\n                <input\n                  className=\"sendbird-message-input--attach-input\"\n                  type=\"file\"\n                  ref={fileInputRef}\n                  onChange={handleUploadFile(onFileUpload)}\n                />\n              </IconButton>\n            ))\n          )\n        }\n        {/* voice message input trigger */}\n        {(isVoiceMessageEnabled && !isEdit && !isInput) && (\n          <IconButton\n            className=\"sendbird-message-input--voice-message\"\n            width=\"32px\"\n            height=\"32px\"\n            onClick={onVoiceMessageIconClick}\n          >\n            {\n              renderVoiceMessageIcon?.() || (\n                <Icon\n                  type={IconTypes.AUDIO_ON_LINED}\n                  fillColor={disabled ? IconColors.ON_BACKGROUND_4 : IconColors.CONTENT_INVERSE}\n                  width=\"20px\"\n                  height=\"20px\"\n                />\n              )\n            }\n          </IconButton>\n        )}\n      </div>\n      {/* Edit */}\n      {\n        isEdit && (\n          <div className=\"sendbird-message-input--edit-action\">\n            <Button\n              className=\"sendbird-message-input--edit-action__cancel\"\n              type={ButtonTypes.SECONDARY}\n              size={ButtonSizes.SMALL}\n              onClick={onCancelEdit}\n            >\n              {stringSet.BUTTON__CANCEL}\n            </Button>\n            <Button\n              className=\"sendbird-message-input--edit-action__save\"\n              type={ButtonTypes.PRIMARY}\n              size={ButtonSizes.SMALL}\n              disabled={isEditDisabled}\n              onClick={() => editMessage()}\n            >\n              {stringSet.BUTTON__SAVE}\n            </Button>\n          </div>\n        )\n      }\n    </form>\n  );\n});\n\nMessageInput.propTypes = {\n  className: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.arrayOf(PropTypes.string),\n  ]),\n  messageFieldId: PropTypes.string,\n  placeholder: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.bool,\n  ]),\n  value: PropTypes.string,\n  isEdit: PropTypes.bool,\n  isMentionEnabled: PropTypes.bool,\n  isVoiceMessageEnabled: PropTypes.bool,\n  onVoiceMessageIconClick: PropTypes.func,\n  message: PropTypes.shape({\n    messageId: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n    message: PropTypes.string,\n    mentionedMessageTemplate: PropTypes.string,\n    mentionedUsers: PropTypes.arrayOf(PropTypes.shape({})),\n  }),\n  disabled: PropTypes.bool,\n  maxLength: PropTypes.number,\n  onFileUpload: PropTypes.func,\n  onSendMessage: PropTypes.func,\n  onUpdateMessage: PropTypes.func,\n  onStartTyping: PropTypes.func,\n  onCancelEdit: PropTypes.func,\n  channelUrl: PropTypes.string,\n  mentionSelectedUser: PropTypes.shape({\n    userId: PropTypes.string,\n    nickname: PropTypes.string,\n  }),\n  setMentionedUsers: PropTypes.func,\n  onUserMentioned: PropTypes.func,\n  onMentionStringChange: PropTypes.func,\n  onMentionedUserIdsUpdated: PropTypes.func,\n  onKeyUp: PropTypes.func,\n  onKeyDown: PropTypes.func,\n};\n\nMessageInput.defaultProps = {\n  className: '',\n  messageFieldId: '',\n  channelUrl: '',\n  onSendMessage: noop,\n  onUpdateMessage: noop,\n  value: null,\n  message: null,\n  isEdit: false,\n  isMentionEnabled: false,\n  isVoiceMessageEnabled: true,\n  onVoiceMessageIconClick: noop,\n  disabled: false,\n  placeholder: '',\n  maxLength: 5000,\n  onFileUpload: noop,\n  onCancelEdit: noop,\n  onStartTyping: noop,\n  mentionSelectedUser: null,\n  onUserMentioned: noop,\n  onMentionStringChange: noop,\n  onMentionedUserIdsUpdated: noop,\n  onKeyUp: noop,\n  onKeyDown: noop,\n};\n\nexport default MessageInput;\n"],"names":["sanitizeString","str","replace","i","concat","charCodeAt","inserTemplateToDOM","templateList","nodes","map","template","text","userId","renderToString","React","MentionUserLabel","join","document","execCommand","PASTE_NODE","TEXT_MESSAGE_CLASS","MENTION_CLASS","MENTION_CLASS_IN_INPUT","MENTION_CLASS_COMBINED_QUERY","createPasteNode","pasteNode","body","querySelector","remove","node","createElement","id","style","display","hasMention","parent","extractTextFromNodes","forEach","textNodes","querySelectorAll","length","Array","from","innerText","domToMessageTemplate","nodeArray","templates","reduce","accumulator","currentValue","mentionNode","classList","contains","_a","dataset","userid","__spreadArray","getUsersFromWords","channel","userMap","users","members","find","user","Object","values","usePaste","ref","setIsInput","setHeight","setMentionedUsers","useCallback","e","preventDefault","html","clipboardData","getData","purifier","DOMPurify","window","clean","sanitize","innerHTML","children","childNodes","words","mentionedUsers","TEXT_FIELD_ID","LINE_HEIGHT","noop","handleUploadFile","callback","event","target","files","value","displayCaret","element","position","range","createRange","sel","getSelection","setStart","collapse","removeAllRanges","addRange","focus","resetInput","current","initialTargetStringInfo","targetString","startNodeIndex","startOffsetIndex","endNodeIndex","endOffsetIndex","MessageInput","forwardRef","props","className","messageFieldId","isEdit","isMentionEnabled","isVoiceMessageEnabled","disabled","message","placeholder","maxLength","onFileUpload","onSendMessage","onUpdateMessage","onCancelEdit","onStartTyping","channelUrl","mentionSelectedUser","onUserMentioned","onMentionStringChange","onMentionedUserIdsUpdated","onVoiceMessageIconClick","onKeyUp","onKeyDown","renderFileUploadIcon","renderVoiceMessageIcon","renderSendMessageIcon","textFieldId","stringSet","useContext","LocalizationContext","fileInputRef","useRef","isInput","useState","mentionedUserIds","setMentionedUserIds","targetStringInfo","setTargetStringInfo","_objectSpread","useMemo","elem","MAX_HEIGHT","offsetHeight","scrollHeight","height","error","initialValue","useEffect","textField","messageId","mentionedMessageTemplate","split","word","convertWordToStringObj","stringObj","type","StringObjType","mention","some","USER_MENTION_TEMP_CHAR","nickname","MENTION_NAME__NO_NAME","useMentionedLabelDetection","newMentionedUserIds","getElementsByClassName","arrayEqual","frontTextNode","createTextNode","textContent","slice","backTextNode","mentionLabel","div","newNodes","newNode","appendChild","selection","Range","selectNodeContents","setEnd","useMentionInputDetection","anchorNode","focusNode","anchorOffset","focusOffset","textStack","index","currentNode","nodeType","NodeTypes","TextNode","charLastIndex","lastIndexOf","sendMessage","messageText","mentionTemplate","ElementNode","nodeName","NodeNames","Span","Br","params","isEditDisabled","trim","editMessage","onPaste","getClassName","preventEvent","shiftKey","key","MessageInputKeys","Enter","nativeEvent","isComposing","Backspace","removeChild","Label","LabelTypography","BODY_1","LabelColors","ONBACKGROUND_4","ONBACKGROUND_3","MESSAGE_INPUT__PLACE_HOLDER","IconButton","Icon","IconTypes","SEND","IconColors","ON_BACKGROUND_4","PRIMARY","click","ATTACH","CONTENT_INVERSE","AUDIO_ON_LINED","Button","ButtonTypes","SECONDARY","ButtonSizes","SMALL","BUTTON__CANCEL","BUTTON__SAVE","propTypes","PropTypes","oneOfType","string","arrayOf","bool","func","shape","number","defaultProps"],"mappings":"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"}
\ No newline at end of file
+{"version":3,"file":"MessageInput.js","sources":["../../../src/ui/MessageInput/utils.js","../../../src/ui/MessageInput/hooks/usePaste/insertTemplate.tsx","../../../src/ui/MessageInput/hooks/usePaste/consts.ts","../../../src/ui/MessageInput/hooks/usePaste/utils.ts","../../../src/ui/MessageInput/hooks/usePaste/index.ts","../../../src/ui/MessageInput/index.jsx"],"sourcesContent":["// https://davidwalsh.name/javascript-debounce-function\n// Returns a function, that, as long as it continues to be invoked, will not\n// be triggered. The function will be called after it stops being called for\n// N milliseconds. If `immediate` is passed, trigger the function on the\n// leading edge, instead of the trailing.\nexport function debounce(func, wait, immediate) {\n  let timeout;\n  return function _debounce() {\n    const context = this;\n    // eslint-disable-next-line prefer-rest-params\n    const args = arguments;\n    const later = () => {\n      timeout = null;\n      if (!immediate) func.apply(context, args);\n    };\n    const callNow = immediate && !timeout;\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n    if (callNow) func.apply(context, args);\n  };\n}\n\n// Sanitize that special characters of HTML tags cause XSS issue\nexport const sanitizeString = (str) => (\n  str?.replace(/[\\u00A0-\\u9999<>]/gim, (i) => ''.concat('&#', i.charCodeAt(0), ';'))\n);\n\nexport default debounce;\n","import React from 'react';\nimport { renderToString } from 'react-dom/server.js';\n\nimport { Word } from './types';\nimport { sanitizeString } from '../../utils';\nimport MentionUserLabel from '../../../MentionUserLabel';\n\nexport function inserTemplateToDOM(templateList: Word[]): void {\n  const nodes = templateList.map((template) => {\n    const { text, userId } = template;\n    if (userId) {\n      return (\n        renderToString(\n          <>\n            <MentionUserLabel userId={userId}>\n              {text}\n            </MentionUserLabel>\n          </>\n        )\n      );\n    }\n    return sanitizeString(text);\n  })\n  .join(' ')\n  // add a space at the end of the mention, else cursor/caret wont work\n  .concat(' ');\n  document.execCommand('insertHTML', false, nodes);\n}\n","export const PASTE_NODE = 'sendbird-uikit__paste-node';\nexport const TEXT_MESSAGE_CLASS = 'sendbird-word';\nexport const MENTION_CLASS = 'sendbird-word__mention';\nexport const MENTION_CLASS_IN_INPUT = 'sendbird-mention-user-label';\nexport const MENTION_CLASS_COMBINED_QUERY = `.${MENTION_CLASS}, .${MENTION_CLASS_IN_INPUT}`;\n","import { GroupChannel } from '@sendbird/chat/groupChannel';\nimport { User } from '@sendbird/chat';\n\nimport {\n  PASTE_NODE,\n  MENTION_CLASS,\n  TEXT_MESSAGE_CLASS,\n  MENTION_CLASS_COMBINED_QUERY,\n  MENTION_CLASS_IN_INPUT,\n} from './consts';\nimport { Word } from './types';\n\nexport function createPasteNode(): HTMLDivElement | null {\n  const pasteNode = document.body.querySelector(`#${PASTE_NODE}`);\n  // remove existing paste node\n  if (pasteNode) {\n    pasteNode?.remove();\n  }\n\n  // create new paste node and return\n  const node = document.createElement('div');\n  node.id = PASTE_NODE;\n  node.style.display = 'none';\n  return node;\n}\n\nexport function hasMention(parent: HTMLDivElement): boolean {\n  return parent?.querySelector(MENTION_CLASS_COMBINED_QUERY) ? true : false;\n}\n\nexport const extractTextFromNodes = (nodes: HTMLSpanElement[]): string => {\n  let text = '';\n  nodes.forEach((node) => {\n    // to preserve space between words\n    const textNodes = node.querySelectorAll(`.${TEXT_MESSAGE_CLASS}`);\n    if (textNodes.length > 0) {\n      text += ((extractTextFromNodes(Array.from(textNodes) as HTMLSpanElement[])) + ' ');\n    }\n    text += (node.innerText + ' ');\n  });\n  return text;\n}\n\nexport function domToMessageTemplate(nodeArray: HTMLSpanElement[]): Word[] {\n  const templates: Word[] = nodeArray?.reduce((accumulator, currentValue) => {\n    let mentionNode = currentValue.querySelector(MENTION_CLASS_COMBINED_QUERY) as HTMLSpanElement;\n    // sometimes the mention node is the parent node\n    // in this case querySelector will return null\n    if (!mentionNode) {\n      mentionNode = (\n        currentValue.classList.contains(MENTION_CLASS)  // for nodes copied from message\n        || currentValue.classList.contains(MENTION_CLASS_IN_INPUT) // for nodes copied from input\n      ) ? currentValue : null;\n    }\n    const text = currentValue.innerText;\n    if (mentionNode) {\n      const userId = mentionNode.dataset?.userid;\n      return [\n        ...accumulator,\n        {\n          text,\n          userId,\n        },\n      ];\n    }\n\n    return [\n      ...accumulator,\n      {\n        text,\n      },\n    ];\n  }, [] as Word[]);\n  return templates;\n}\n\nexport function getUsersFromWords(templates: Word[], channel: GroupChannel): User[] {\n  const userMap = {};\n  const users = channel.members;\n  templates.forEach((template) => {\n    if (template.userId) {\n      userMap[template.userId] = users.find((user) => user.userId === template.userId);\n    }\n  });\n  return Object.values(userMap);\n}\n","import { useCallback } from 'react';\nimport DOMPurify from 'dompurify';\n\nimport { inserTemplateToDOM } from './insertTemplate';\nimport { sanitizeString } from '../../utils';\nimport { DynamicProps } from './types';\nimport { MENTION_CLASS_COMBINED_QUERY, MENTION_CLASS_IN_INPUT, TEXT_MESSAGE_CLASS } from './consts';\nimport {\n  createPasteNode,\n  hasMention,\n  domToMessageTemplate,\n  getUsersFromWords,\n  extractTextFromNodes,\n} from './utils';\n\n// conditions to test:\n// 1. paste simple text\n// 2. paste text with mention\n// 3. paste text with mention and text\n// 4. paste text with mention and text and paste again before and after\n// 5. copy message with mention(only one mention, no other text) and paste\n// 6. copy message with mention from input and paste(before and after)\nexport default function usePaste({\n  ref,\n  setIsInput,\n  setHeight,\n  channel,\n  setMentionedUsers,\n}: DynamicProps): (e: React.ClipboardEvent<HTMLDivElement>) => void {\n  return useCallback((e) => {\n    e.preventDefault();\n    const html = e?.clipboardData.getData('text/html');\n    // simple text, continue as normal\n    if (!html) {\n      const text = e?.clipboardData.getData('text');\n      document.execCommand('insertHTML', false, sanitizeString(text));\n      setIsInput(true);\n      setHeight();\n      return;\n    }\n\n    // has html, check if there are mentions, sanitize and insert\n    const purifier = DOMPurify(window);\n    const clean = purifier.sanitize(html);\n    const pasteNode = createPasteNode();\n    pasteNode.innerHTML = clean;\n    // does not have mention, continue as normal\n    if (!hasMention(pasteNode)) {\n      // to preserve space between words\n      const text = extractTextFromNodes(Array.from(pasteNode.children) as HTMLSpanElement[]);\n      document.execCommand('insertHTML', false, sanitizeString(text));\n      pasteNode.remove();\n      setIsInput(true);\n      setHeight();\n      return;\n    }\n\n    // has mention, sanitize and insert\n    let childNodes = pasteNode.querySelectorAll(`.${TEXT_MESSAGE_CLASS}`) as NodeListOf<HTMLSpanElement>;\n    if (pasteNode.querySelectorAll(`.${MENTION_CLASS_IN_INPUT}`).length > 0) {\n      // @ts-ignore\n      childNodes = pasteNode.children;\n    }\n    let nodeArray = Array.from(childNodes);\n    // handle paste when there is only one child\n    if (pasteNode.children.length === 1 && pasteNode.querySelectorAll(MENTION_CLASS_COMBINED_QUERY).length === 1) {\n      nodeArray = Array.from(pasteNode.children) as HTMLSpanElement[];\n    }\n    const words = domToMessageTemplate(nodeArray);\n\n    const mentionedUsers = getUsersFromWords(words, channel);\n    setMentionedUsers(mentionedUsers);\n    inserTemplateToDOM(words);\n    pasteNode.remove();\n    setIsInput(true);\n    setHeight();\n    return;\n\n  }, [ref, setIsInput, setHeight, channel, setMentionedUsers]);\n}\n","import React, {\n  useRef,\n  useMemo,\n  useState,\n  useEffect,\n  useCallback,\n  useContext,\n} from 'react';\nimport { renderToString } from 'react-dom/server';\nimport PropTypes from 'prop-types';\n\nimport './index.scss';\nimport { MessageInputKeys, NodeNames, NodeTypes } from './const';\n\nimport { USER_MENTION_TEMP_CHAR } from '../../smart-components/Channel/context/const';\nimport IconButton from '../IconButton';\nimport Button, { ButtonTypes, ButtonSizes } from '../Button';\nimport MentionUserLabel from '../MentionUserLabel';\nimport Icon, { IconTypes, IconColors } from '../Icon';\nimport Label, { LabelTypography, LabelColors } from '../Label';\nimport { LocalizationContext } from '../../lib/LocalizationContext';\nimport { sanitizeString } from './utils';\nimport {\n  arrayEqual,\n  getClassName,\n  StringObjType,\n  convertWordToStringObj,\n} from '../../utils';\nimport usePaste from './hooks/usePaste';\n\nconst TEXT_FIELD_ID = 'sendbird-message-input-text-field';\nconst LINE_HEIGHT = 76;\nconst noop = () => { };\nconst handleUploadFile = (callback) => (event) => {\n  if (event.target.files && event.target.files[0]) {\n    callback(event.target.files[0]);\n  }\n  // eslint-disable-next-line no-param-reassign\n  event.target.value = '';\n};\n\nconst displayCaret = (element, position) => {\n  const range = document.createRange();\n  const sel = window.getSelection();\n  range.setStart(element.childNodes[0], position);\n  range.collapse(true);\n  sel.removeAllRanges();\n  sel.addRange(range);\n  element.focus();\n}\n\nconst resetInput = (ref) => {\n  try {\n    ref.current.innerHTML = '';\n  } catch {\n    //\n  }\n}\n\nconst initialTargetStringInfo = {\n  targetString: '',\n  startNodeIndex: null,\n  startOffsetIndex: null,\n  endNodeIndex: null,\n  endOffsetIndex: null,\n};\n\nconst MessageInput = React.forwardRef((props, ref) => {\n  const {\n    className,\n    messageFieldId,\n    isEdit,\n    isMentionEnabled,\n    isVoiceMessageEnabled,\n    disabled,\n    message,\n    placeholder,\n    maxLength,\n    onFileUpload,\n    onSendMessage,\n    onUpdateMessage,\n    onCancelEdit,\n    onStartTyping,\n    channelUrl,\n    channel,\n    mentionSelectedUser,\n    onUserMentioned,\n    onMentionStringChange,\n    onMentionedUserIdsUpdated,\n    onVoiceMessageIconClick,\n    onKeyUp,\n    onKeyDown,\n    renderFileUploadIcon,\n    renderVoiceMessageIcon,\n    renderSendMessageIcon,\n    setMentionedUsers,\n  } = props;\n  const textFieldId = messageFieldId || TEXT_FIELD_ID;\n  const { stringSet } = useContext(LocalizationContext);\n  const fileInputRef = useRef(null);\n  const [isInput, setIsInput] = useState(false);\n  const [mentionedUserIds, setMentionedUserIds] = useState([]);\n  const [targetStringInfo, setTargetStringInfo] = useState({ ...initialTargetStringInfo });\n  const setHeight = useMemo(() => (\n    () => {\n      try {\n        const elem = ref?.current;\n        const MAX_HEIGHT = window.document.body.offsetHeight * 0.6;\n        if (elem && elem.scrollHeight >= LINE_HEIGHT) {\n          if (MAX_HEIGHT < elem.scrollHeight) {\n            elem.style.height = 'auto';\n            elem.style.height = `${MAX_HEIGHT}px`;\n          } else {\n            elem.style.height = 'auto';\n            elem.style.height = `${elem.scrollHeight}px`;\n          }\n        } else {\n          elem.style.height = '';\n        }\n      } catch (error) {\n        // error\n      }\n    }\n  ), []);\n\n  // #Edit mode\n  // for easilly initialize input value from outside, but\n  // useEffect(_, [channelUrl]) erase it\n  const initialValue = props?.value;\n  useEffect(() => {\n    const textField = ref?.current;\n    try {\n      textField.innerHTML = initialValue;\n      displayCaret(textField, initialValue?.length);\n    } catch { }\n    setMentionedUserIds([]);\n    setIsInput(textField?.innerText?.length > 0);\n    setHeight();\n  }, [initialValue]);\n\n  // #Mention | Clear input value when channel changes\n  useEffect(() => {\n    if (!isEdit) {\n      setIsInput(false);\n      resetInput(ref);\n    }\n  }, [channelUrl]);\n\n  // #Mention & #Edit | Fill message input values\n  useEffect(() => {\n    if (isEdit && message?.messageId) {\n      // const textField = document.getElementById(textFieldId);\n      const textField = ref?.current;\n      if (isMentionEnabled\n        && message?.mentionedUsers?.length > 0\n        && message?.mentionedMessageTemplate?.length > 0\n      ) {\n        /* mention enabled */\n        const { mentionedUsers = [] } = message;\n        textField.innerHTML = message?.mentionedMessageTemplate?.split(' ').map((word) => (\n          convertWordToStringObj(word, mentionedUsers).map((stringObj) => {\n            const { type, value, userId } = stringObj;\n            if (type === StringObjType.mention && mentionedUsers.some((user) => user?.userId === userId)) {\n              return renderToString(\n                <MentionUserLabel userId={userId}>\n                  {\n                    `${USER_MENTION_TEMP_CHAR}${mentionedUsers.find((user) => user?.userId === userId)?.nickname\n                    || value\n                    || stringSet.MENTION_NAME__NO_NAME\n                    }`\n                  }\n                </MentionUserLabel>,\n              );\n            }\n            return sanitizeString(value);\n          }).join('')\n        )).join(' ');\n      } else {\n        /* mention disabled */\n        try {\n          textField.innerHTML = sanitizeString(message?.message);\n        } catch { }\n        setMentionedUserIds([]);\n      }\n      setIsInput(textField?.innerText?.length > 0);\n      setHeight();\n    }\n  }, [isEdit, message]);\n\n  // #Mention | Detect MentionedLabel modified\n  const useMentionedLabelDetection = useCallback(() => {\n    const textField = ref?.current;\n    if (isMentionEnabled) {\n      const newMentionedUserIds = [...textField.getElementsByClassName('sendbird-mention-user-label')].map((node) => node?.dataset?.userid);\n      if (!arrayEqual(mentionedUserIds, newMentionedUserIds) || newMentionedUserIds.length === 0) {\n        onMentionedUserIdsUpdated(newMentionedUserIds);\n        setMentionedUserIds(newMentionedUserIds);\n      }\n    }\n    setIsInput(textField.innerText.length > 0);\n  }, [targetStringInfo, isMentionEnabled]);\n\n  // #Mention | Replace selected user nickname to the MentionedUserLabel\n  useEffect(() => {\n    if (isMentionEnabled && mentionSelectedUser) {\n      const {\n        targetString,\n        startNodeIndex,\n        startOffsetIndex,\n        endNodeIndex,\n        endOffsetIndex,\n      } = targetStringInfo;\n      if (targetString && startNodeIndex !== null && startOffsetIndex !== null) {\n        // const textField = document.getElementById(textFieldId);\n        const textField = ref?.current;\n        const childNodes = [...textField?.childNodes];\n        const frontTextNode = document?.createTextNode(\n          childNodes[startNodeIndex]?.textContent.slice(0, startOffsetIndex),\n        );\n        const backTextNode = document?.createTextNode(\n          `\\u00A0${childNodes[endNodeIndex]?.textContent.slice(endOffsetIndex)}`,\n        );\n        const mentionLabel = renderToString(\n          <MentionUserLabel userId={mentionSelectedUser?.userId}>\n            {`${USER_MENTION_TEMP_CHAR}${mentionSelectedUser?.nickname || stringSet.MENTION_NAME__NO_NAME}`}\n          </MentionUserLabel>,\n        );\n        const div = document.createElement('div');\n        div.innerHTML = mentionLabel;\n        const newNodes = [\n          ...childNodes.slice(0, startNodeIndex),\n          frontTextNode,\n          div.childNodes[0],\n          backTextNode,\n          ...childNodes.slice(endNodeIndex + 1),\n        ];\n        textField.innerHTML = '';\n        newNodes.forEach((newNode) => {\n          textField.appendChild(newNode);\n        });\n        onUserMentioned(mentionSelectedUser);\n        if (window.getSelection || document.getSelection) {\n          // set caret postion\n          const selection = window.getSelection() || document.getSelection();\n          selection.removeAllRanges();\n          const range = new Range();\n          range.selectNodeContents(textField);\n          range.setStart(textField.childNodes[startNodeIndex + 2], 1);\n          range.setEnd(textField.childNodes[startNodeIndex + 2], 1);\n          range.collapse(false);\n          selection.addRange(range);\n          textField.focus();\n        }\n        setTargetStringInfo({ ...initialTargetStringInfo });\n        setHeight();\n        useMentionedLabelDetection();\n      }\n    }\n  }, [mentionSelectedUser, isMentionEnabled]);\n\n  // #Mention | Detect mentioning user nickname\n  const useMentionInputDetection = useCallback(() => {\n    const selection = window?.getSelection?.() || document?.getSelection?.();\n    const textField = ref?.current;\n    if (selection.anchorNode === textField) {\n      onMentionStringChange('');\n    }\n    if (isMentionEnabled && selection\n      && selection.anchorNode === selection.focusNode\n      && selection.anchorOffset === selection.focusOffset\n    ) {\n      let textStack = '';\n      let startNodeIndex = null;\n      let startOffsetIndex = null;\n      for (let index = 0; index < textField.childNodes.length; index += 1) {\n        const currentNode = textField.childNodes[index];\n        if (currentNode.nodeType === NodeTypes.TextNode) {\n          /* text node */\n          const textContent = (currentNode === selection.anchorNode)\n            ? currentNode?.textContent.slice(0, selection.anchorOffset) || ''\n            : currentNode?.textContent || '';\n          if (textStack.length > 0) {\n            textStack += textContent;\n          } else {\n            let charLastIndex = textContent.lastIndexOf(USER_MENTION_TEMP_CHAR);\n            for (let i = charLastIndex - 1; i > -1; i -= 1) {\n              if (textContent[i] === USER_MENTION_TEMP_CHAR) {\n                charLastIndex = i;\n              } else {\n                break;\n              }\n            }\n            if (charLastIndex > -1) {\n              textStack = textContent;\n              startNodeIndex = index;\n              startOffsetIndex = charLastIndex;\n            }\n          }\n        } else {\n          /* other nodes */\n          textStack = '';\n          startNodeIndex = null;\n          startOffsetIndex = null;\n        }\n        if (currentNode === selection.anchorNode) {\n          /**\n           * targetString could be ''\n           * startNodeIndex and startOffsetIndex could be null\n           */\n          const targetString = textStack ? textStack.slice(startOffsetIndex) : '';// include template character\n          setTargetStringInfo({\n            targetString,\n            startNodeIndex,\n            startOffsetIndex,\n            endNodeIndex: index,\n            endOffsetIndex: selection.anchorOffset,\n          });\n          onMentionStringChange(targetString);\n          return;\n        }\n      }\n    }\n  }, [isMentionEnabled]);\n\n  const sendMessage = () => {\n    const textField = ref?.current;\n    if (!isEdit && textField?.innerText) {\n      let messageText = '';\n      let mentionTemplate = '';\n      textField.childNodes.forEach((node) => {\n        if (node.nodeType === NodeTypes.ElementNode && node.nodeName === NodeNames.Span) {\n          const { innerText, dataset = {} } = node;\n          const { userid = '' } = dataset;\n          messageText += innerText;\n          mentionTemplate += `${USER_MENTION_TEMP_CHAR}{${userid}}`;\n        } else if (node.nodeType === NodeTypes.ElementNode && node.nodeName === NodeNames.Br) {\n          messageText += '\\n';\n          mentionTemplate += '\\n';\n        } else { // other nodes including text node\n          const { textContent = '' } = node;\n          messageText += textContent;\n          mentionTemplate += textContent;\n        }\n      });\n      const params = { message: messageText, mentionTemplate };\n      onSendMessage(params);\n      resetInput(ref);\n      setIsInput(false);\n      setHeight();\n    }\n  };\n  const isEditDisabled = !(ref?.current?.innerText?.trim());\n  const editMessage = () => {\n    const textField = ref?.current;\n    const messageId = message?.messageId;\n    if (isEdit && messageId) {\n      let messageText = '';\n      let mentionTemplate = '';\n      textField.childNodes.forEach((node) => {\n        if (node.nodeType === NodeTypes.ElementNode && node.nodeName === NodeNames.Span) {\n          const { innerText, dataset = {} } = node;\n          const { userid = '' } = dataset;\n          messageText += innerText;\n          mentionTemplate += `${USER_MENTION_TEMP_CHAR}{${userid}}`;\n        } else if (node.nodeType === NodeTypes.ElementNode && node.nodeName === NodeNames.Span) {\n          messageText += '\\n';\n          mentionTemplate += '\\n';\n        } else { // other nodes including text node\n          const { textContent = '' } = node;\n          messageText += textContent;\n          mentionTemplate += textContent;\n        }\n      });\n      const params = { messageId, message: messageText, mentionTemplate };\n      onUpdateMessage(params);\n      resetInput(ref);\n    }\n  };\n  const onPaste = usePaste({\n    ref,\n    setMentionedUserIds,\n    setMentionedUsers,\n    channel,\n    setIsInput,\n    setHeight,\n  });\n\n  return (\n    <form\n      className={getClassName([\n        className,\n        isEdit ? 'sendbird-message-input__edit' : '',\n        disabled ? 'sendbird-message-input-form__disabled' : '',\n      ])}\n    >\n      <div\n        className={getClassName([\n          'sendbird-message-input',\n          disabled ? 'sendbird-message-input__disabled' : '',\n        ])}\n      >\n        <div\n          id={`${textFieldId}${isEdit ? message?.messageId : ''}`}\n          className={`sendbird-message-input--textarea ${textFieldId}`}\n          contentEditable={!disabled}\n          role=\"textbox\"\n          aria-label=\"Text Input\"\n          disabled={disabled}\n          ref={ref}\n          maxLength={maxLength}\n          onKeyDown={(e) => {\n            const preventEvent = onKeyDown(e);\n            if (preventEvent) {\n              e.preventDefault();\n            } else {\n              if (!e.shiftKey && e.key === MessageInputKeys.Enter && e?.nativeEvent?.isComposing !== true) {\n                e.preventDefault();\n                sendMessage();\n              }\n              if (e.key === MessageInputKeys.Backspace\n                && ref?.current?.childNodes?.length === 2\n                && !ref?.current?.childNodes?.[0]?.textContent\n                && ref?.current.childNodes?.[1]?.nodeType === NodeTypes.ElementNode\n              ) {\n                ref?.current.removeChild(ref?.current.childNodes[1]);\n              }\n            }\n          }}\n          onKeyUp={(e) => {\n            const preventEvent = onKeyUp(e);\n            if (preventEvent) {\n              e.preventDefault();\n            } else {\n              useMentionInputDetection();\n            }\n          }}\n          onClick={() => {\n            useMentionInputDetection();\n          }}\n          onInput={() => {\n            setHeight();\n            onStartTyping();\n            setIsInput(ref?.current?.innerText?.length > 0);\n            useMentionedLabelDetection();\n          }}\n          onPaste={onPaste}\n        />\n        {/* placeholder */}\n        {!isInput && (\n          <Label\n            className=\"sendbird-message-input--placeholder\"\n            type={LabelTypography.BODY_1}\n            color={disabled? LabelColors.ONBACKGROUND_4 : LabelColors.ONBACKGROUND_3}\n          >\n            {placeholder || stringSet.MESSAGE_INPUT__PLACE_HOLDER}\n          </Label>\n        )}\n        {/* send icon */}\n        {\n          (!isEdit && isInput) && (\n            <IconButton\n              className=\"sendbird-message-input--send\"\n              height=\"32px\"\n              width=\"32px\"\n              onClick={() => sendMessage()}\n            >\n              {\n                renderSendMessageIcon?.() || (\n                  <Icon\n                    type={IconTypes.SEND}\n                    fillColor={disabled ? IconColors.ON_BACKGROUND_4 : IconColors.PRIMARY}\n                    width=\"20px\"\n                    height=\"20px\"\n                  />\n                )\n              }\n            </IconButton>\n          )\n        }\n        {/* file upload icon */}\n        {\n          (!isEdit && !isInput) && (\n            (renderFileUploadIcon?.() || (\n              <IconButton\n                className={`sendbird-message-input--attach ${isVoiceMessageEnabled ? 'is-voice-message-enabled' : ''}`}\n                height=\"32px\"\n                width=\"32px\"\n                onClick={() => {\n                  // todo: clear previous input\n                  fileInputRef?.current?.click?.();\n                }}\n              >\n                <Icon\n                  type={IconTypes.ATTACH}\n                  fillColor={disabled ? IconColors.ON_BACKGROUND_4 : IconColors.CONTENT_INVERSE}\n                  width=\"20px\"\n                  height=\"20px\"\n                />\n                <input\n                  className=\"sendbird-message-input--attach-input\"\n                  type=\"file\"\n                  ref={fileInputRef}\n                  onChange={handleUploadFile(onFileUpload)}\n                />\n              </IconButton>\n            ))\n          )\n        }\n        {/* voice message input trigger */}\n        {(isVoiceMessageEnabled && !isEdit && !isInput) && (\n          <IconButton\n            className=\"sendbird-message-input--voice-message\"\n            width=\"32px\"\n            height=\"32px\"\n            onClick={onVoiceMessageIconClick}\n          >\n            {\n              renderVoiceMessageIcon?.() || (\n                <Icon\n                  type={IconTypes.AUDIO_ON_LINED}\n                  fillColor={disabled ? IconColors.ON_BACKGROUND_4 : IconColors.CONTENT_INVERSE}\n                  width=\"20px\"\n                  height=\"20px\"\n                />\n              )\n            }\n          </IconButton>\n        )}\n      </div>\n      {/* Edit */}\n      {\n        isEdit && (\n          <div className=\"sendbird-message-input--edit-action\">\n            <Button\n              className=\"sendbird-message-input--edit-action__cancel\"\n              type={ButtonTypes.SECONDARY}\n              size={ButtonSizes.SMALL}\n              onClick={onCancelEdit}\n            >\n              {stringSet.BUTTON__CANCEL}\n            </Button>\n            <Button\n              className=\"sendbird-message-input--edit-action__save\"\n              type={ButtonTypes.PRIMARY}\n              size={ButtonSizes.SMALL}\n              disabled={isEditDisabled}\n              onClick={() => editMessage()}\n            >\n              {stringSet.BUTTON__SAVE}\n            </Button>\n          </div>\n        )\n      }\n    </form>\n  );\n});\n\nMessageInput.propTypes = {\n  className: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.arrayOf(PropTypes.string),\n  ]),\n  messageFieldId: PropTypes.string,\n  placeholder: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.bool,\n  ]),\n  value: PropTypes.string,\n  isEdit: PropTypes.bool,\n  isMentionEnabled: PropTypes.bool,\n  isVoiceMessageEnabled: PropTypes.bool,\n  onVoiceMessageIconClick: PropTypes.func,\n  message: PropTypes.shape({\n    messageId: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n    message: PropTypes.string,\n    mentionedMessageTemplate: PropTypes.string,\n    mentionedUsers: PropTypes.arrayOf(PropTypes.shape({})),\n  }),\n  disabled: PropTypes.bool,\n  maxLength: PropTypes.number,\n  onFileUpload: PropTypes.func,\n  onSendMessage: PropTypes.func,\n  onUpdateMessage: PropTypes.func,\n  onStartTyping: PropTypes.func,\n  onCancelEdit: PropTypes.func,\n  channelUrl: PropTypes.string,\n  mentionSelectedUser: PropTypes.shape({\n    userId: PropTypes.string,\n    nickname: PropTypes.string,\n  }),\n  setMentionedUsers: PropTypes.func,\n  onUserMentioned: PropTypes.func,\n  onMentionStringChange: PropTypes.func,\n  onMentionedUserIdsUpdated: PropTypes.func,\n  onKeyUp: PropTypes.func,\n  onKeyDown: PropTypes.func,\n};\n\nMessageInput.defaultProps = {\n  className: '',\n  messageFieldId: '',\n  channelUrl: '',\n  onSendMessage: noop,\n  onUpdateMessage: noop,\n  value: null,\n  message: null,\n  isEdit: false,\n  isMentionEnabled: false,\n  isVoiceMessageEnabled: true,\n  onVoiceMessageIconClick: noop,\n  disabled: false,\n  placeholder: '',\n  maxLength: 5000,\n  onFileUpload: noop,\n  onCancelEdit: noop,\n  onStartTyping: noop,\n  mentionSelectedUser: null,\n  onUserMentioned: noop,\n  onMentionStringChange: noop,\n  onMentionedUserIdsUpdated: noop,\n  onKeyUp: noop,\n  onKeyDown: noop,\n};\n\nexport default MessageInput;\n"],"names":["sanitizeString","str","replace","i","concat","charCodeAt","inserTemplateToDOM","templateList","nodes","map","template","text","userId","renderToString","React","MentionUserLabel","join","document","execCommand","PASTE_NODE","TEXT_MESSAGE_CLASS","MENTION_CLASS","MENTION_CLASS_IN_INPUT","MENTION_CLASS_COMBINED_QUERY","createPasteNode","pasteNode","body","querySelector","remove","node","createElement","id","style","display","hasMention","parent","extractTextFromNodes","forEach","textNodes","querySelectorAll","length","Array","from","innerText","domToMessageTemplate","nodeArray","templates","reduce","accumulator","currentValue","mentionNode","classList","contains","_a","dataset","userid","__spreadArray","getUsersFromWords","channel","userMap","users","members","find","user","Object","values","usePaste","ref","setIsInput","setHeight","setMentionedUsers","useCallback","e","preventDefault","html","clipboardData","getData","purifier","DOMPurify","window","clean","sanitize","innerHTML","children","childNodes","words","mentionedUsers","TEXT_FIELD_ID","LINE_HEIGHT","noop","handleUploadFile","callback","event","target","files","value","displayCaret","element","position","range","createRange","sel","getSelection","setStart","collapse","removeAllRanges","addRange","focus","resetInput","current","initialTargetStringInfo","targetString","startNodeIndex","startOffsetIndex","endNodeIndex","endOffsetIndex","MessageInput","forwardRef","props","className","messageFieldId","isEdit","isMentionEnabled","isVoiceMessageEnabled","disabled","message","placeholder","maxLength","onFileUpload","onSendMessage","onUpdateMessage","onCancelEdit","onStartTyping","channelUrl","mentionSelectedUser","onUserMentioned","onMentionStringChange","onMentionedUserIdsUpdated","onVoiceMessageIconClick","onKeyUp","onKeyDown","renderFileUploadIcon","renderVoiceMessageIcon","renderSendMessageIcon","textFieldId","stringSet","useContext","LocalizationContext","fileInputRef","useRef","isInput","useState","mentionedUserIds","setMentionedUserIds","targetStringInfo","setTargetStringInfo","_objectSpread","useMemo","elem","MAX_HEIGHT","offsetHeight","scrollHeight","height","error","initialValue","useEffect","textField","messageId","mentionedMessageTemplate","split","word","convertWordToStringObj","stringObj","type","StringObjType","mention","some","USER_MENTION_TEMP_CHAR","nickname","MENTION_NAME__NO_NAME","useMentionedLabelDetection","newMentionedUserIds","getElementsByClassName","arrayEqual","frontTextNode","createTextNode","textContent","slice","backTextNode","mentionLabel","div","newNodes","newNode","appendChild","selection","Range","selectNodeContents","setEnd","useMentionInputDetection","anchorNode","focusNode","anchorOffset","focusOffset","textStack","index","currentNode","nodeType","NodeTypes","TextNode","charLastIndex","lastIndexOf","sendMessage","messageText","mentionTemplate","ElementNode","nodeName","NodeNames","Span","Br","params","isEditDisabled","trim","editMessage","onPaste","getClassName","preventEvent","shiftKey","key","MessageInputKeys","Enter","nativeEvent","isComposing","Backspace","removeChild","Label","LabelTypography","BODY_1","LabelColors","ONBACKGROUND_4","ONBACKGROUND_3","MESSAGE_INPUT__PLACE_HOLDER","IconButton","Icon","IconTypes","SEND","IconColors","ON_BACKGROUND_4","PRIMARY","click","ATTACH","CONTENT_INVERSE","AUDIO_ON_LINED","Button","ButtonTypes","SECONDARY","ButtonSizes","SMALL","BUTTON__CANCEL","BUTTON__SAVE","propTypes","PropTypes","oneOfType","string","arrayOf","bool","func","shape","number","defaultProps"],"mappings":"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"}
\ No newline at end of file
diff --git a/node_modules/@sendbird/uikit-react/dist/index.css b/node_modules/@sendbird/uikit-react/dist/index.css
index e0404fa..024b4ab 100644
--- a/node_modules/@sendbird/uikit-react/dist/index.css
+++ b/node_modules/@sendbird/uikit-react/dist/index.css
@@ -1,3 +1,5 @@
+@import url("https://fonts.googleapis.com/css?family=Open+Sans:400,600,700&display=swap");
+
 .sendbird-openchannel-conversation-header {
   position: relative;
   min-height: 64px;
@@ -324,7 +326,7 @@
 .sendbird-theme--dark .sendbird-open-channel-list-ui__channel-list--place-holder--loading {
   background-color: var(--sendbird-dark-background-500);
 }
-@import url("https://fonts.googleapis.com/css?family=Open+Sans:400,600,700&display=swap");
+
 :root {
   --sendbird-light-primary-500: #491389;
   --sendbird-light-primary-400: #6211c8;
@@ -1060,7 +1062,7 @@
 .sendbird--mobile-mode .sendbird-modal--full-mobile .sendbird-modal__content {
   height: -moz-available; /* WebKit-based browsers will ignore this. */
   height: -webkit-fill-available; /* Mozilla-based browsers will ignore this. */
-  height: fill-available;
+  height: stretch;
 }
 
 .sendbird-modal {
@@ -5527,7 +5529,7 @@ div.sendbird-og-message-item-body__text-bubble {
   width: 100%;
   height: 42px;
   display: inline-flex;
-  justify-content: start;
+  justify-content: flex-start;
   align-items: center;
   padding: 16px 11px;
 }
diff --git a/node_modules/@sendbird/uikit-react/index.js b/node_modules/@sendbird/uikit-react/index.js
index bfc5c08..bea7f06 100644
--- a/node_modules/@sendbird/uikit-react/index.js
+++ b/node_modules/@sendbird/uikit-react/index.js
@@ -78,7 +78,7 @@ import './ui/MessageItemMenu.js';
 import './types-5cc94910.js';
 import './ui/MessageItemReactionMenu.js';
 import './ui/MessageInput.js';
-import 'react-dom/server';
+import 'react-dom/server.js';
 import './ui/MentionUserLabel.js';
 import 'dompurify';
 import './Thread/components/ThreadHeader.js';
diff --git a/node_modules/@sendbird/uikit-react/ui/MessageInput.js b/node_modules/@sendbird/uikit-react/ui/MessageInput.js
index 6eca09f..da5a1c5 100644
--- a/node_modules/@sendbird/uikit-react/ui/MessageInput.js
+++ b/node_modules/@sendbird/uikit-react/ui/MessageInput.js
@@ -1,6 +1,6 @@
 import { _ as _objectSpread2 } from '../_rollupPluginBabelHelpers-945410b2.js';
 import React__default, { useCallback, useContext, useRef, useState, useMemo, useEffect } from 'react';
-import { renderToString } from 'react-dom/server';
+import { renderToString } from 'react-dom/server.js';
 import PropTypes from 'prop-types';
 import { N as NodeTypes, M as MessageInputKeys, a as NodeNames } from '../const-0f759572.js';
 import { U as USER_MENTION_TEMP_CHAR } from '../const-85535a89.js';
diff --git a/node_modules/@sendbird/uikit-react/ui/MessageInput.js.map b/node_modules/@sendbird/uikit-react/ui/MessageInput.js.map
index 20cb87e..c398b8f 100644
--- a/node_modules/@sendbird/uikit-react/ui/MessageInput.js.map
+++ b/node_modules/@sendbird/uikit-react/ui/MessageInput.js.map
@@ -1 +1 @@
-{"version":3,"file":"MessageInput.js","sources":["../../src/ui/MessageInput/utils.js","../../src/ui/MessageInput/hooks/usePaste/insertTemplate.tsx","../../src/ui/MessageInput/hooks/usePaste/consts.ts","../../src/ui/MessageInput/hooks/usePaste/utils.ts","../../src/ui/MessageInput/hooks/usePaste/index.ts","../../src/ui/MessageInput/index.jsx"],"sourcesContent":["// https://davidwalsh.name/javascript-debounce-function\n// Returns a function, that, as long as it continues to be invoked, will not\n// be triggered. The function will be called after it stops being called for\n// N milliseconds. If `immediate` is passed, trigger the function on the\n// leading edge, instead of the trailing.\nexport function debounce(func, wait, immediate) {\n  let timeout;\n  return function _debounce() {\n    const context = this;\n    // eslint-disable-next-line prefer-rest-params\n    const args = arguments;\n    const later = () => {\n      timeout = null;\n      if (!immediate) func.apply(context, args);\n    };\n    const callNow = immediate && !timeout;\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n    if (callNow) func.apply(context, args);\n  };\n}\n\n// Sanitize that special characters of HTML tags cause XSS issue\nexport const sanitizeString = (str) => (\n  str?.replace(/[\\u00A0-\\u9999<>]/gim, (i) => ''.concat('&#', i.charCodeAt(0), ';'))\n);\n\nexport default debounce;\n","import React from 'react';\nimport { renderToString } from 'react-dom/server';\n\nimport { Word } from './types';\nimport { sanitizeString } from '../../utils';\nimport MentionUserLabel from '../../../MentionUserLabel';\n\nexport function inserTemplateToDOM(templateList: Word[]): void {\n  const nodes = templateList.map((template) => {\n    const { text, userId } = template;\n    if (userId) {\n      return (\n        renderToString(\n          <>\n            <MentionUserLabel userId={userId}>\n              {text}\n            </MentionUserLabel>\n          </>\n        )\n      );\n    }\n    return sanitizeString(text);\n  })\n  .join(' ')\n  // add a space at the end of the mention, else cursor/caret wont work\n  .concat(' ');\n  document.execCommand('insertHTML', false, nodes);\n}\n","export const PASTE_NODE = 'sendbird-uikit__paste-node';\nexport const TEXT_MESSAGE_CLASS = 'sendbird-word';\nexport const MENTION_CLASS = 'sendbird-word__mention';\nexport const MENTION_CLASS_IN_INPUT = 'sendbird-mention-user-label';\nexport const MENTION_CLASS_COMBINED_QUERY = `.${MENTION_CLASS}, .${MENTION_CLASS_IN_INPUT}`;\n","import { GroupChannel } from '@sendbird/chat/groupChannel';\nimport { User } from '@sendbird/chat';\n\nimport {\n  PASTE_NODE,\n  MENTION_CLASS,\n  TEXT_MESSAGE_CLASS,\n  MENTION_CLASS_COMBINED_QUERY,\n  MENTION_CLASS_IN_INPUT,\n} from './consts';\nimport { Word } from './types';\n\nexport function createPasteNode(): HTMLDivElement | null {\n  const pasteNode = document.body.querySelector(`#${PASTE_NODE}`);\n  // remove existing paste node\n  if (pasteNode) {\n    pasteNode?.remove();\n  }\n\n  // create new paste node and return\n  const node = document.createElement('div');\n  node.id = PASTE_NODE;\n  node.style.display = 'none';\n  return node;\n}\n\nexport function hasMention(parent: HTMLDivElement): boolean {\n  return parent?.querySelector(MENTION_CLASS_COMBINED_QUERY) ? true : false;\n}\n\nexport const extractTextFromNodes = (nodes: HTMLSpanElement[]): string => {\n  let text = '';\n  nodes.forEach((node) => {\n    // to preserve space between words\n    const textNodes = node.querySelectorAll(`.${TEXT_MESSAGE_CLASS}`);\n    if (textNodes.length > 0) {\n      text += ((extractTextFromNodes(Array.from(textNodes) as HTMLSpanElement[])) + ' ');\n    }\n    text += (node.innerText + ' ');\n  });\n  return text;\n}\n\nexport function domToMessageTemplate(nodeArray: HTMLSpanElement[]): Word[] {\n  const templates: Word[] = nodeArray?.reduce((accumulator, currentValue) => {\n    let mentionNode = currentValue.querySelector(MENTION_CLASS_COMBINED_QUERY) as HTMLSpanElement;\n    // sometimes the mention node is the parent node\n    // in this case querySelector will return null\n    if (!mentionNode) {\n      mentionNode = (\n        currentValue.classList.contains(MENTION_CLASS)  // for nodes copied from message\n        || currentValue.classList.contains(MENTION_CLASS_IN_INPUT) // for nodes copied from input\n      ) ? currentValue : null;\n    }\n    const text = currentValue.innerText;\n    if (mentionNode) {\n      const userId = mentionNode.dataset?.userid;\n      return [\n        ...accumulator,\n        {\n          text,\n          userId,\n        },\n      ];\n    }\n\n    return [\n      ...accumulator,\n      {\n        text,\n      },\n    ];\n  }, [] as Word[]);\n  return templates;\n}\n\nexport function getUsersFromWords(templates: Word[], channel: GroupChannel): User[] {\n  const userMap = {};\n  const users = channel.members;\n  templates.forEach((template) => {\n    if (template.userId) {\n      userMap[template.userId] = users.find((user) => user.userId === template.userId);\n    }\n  });\n  return Object.values(userMap);\n}\n","import { useCallback } from 'react';\nimport DOMPurify from 'dompurify';\n\nimport { inserTemplateToDOM } from './insertTemplate';\nimport { sanitizeString } from '../../utils';\nimport { DynamicProps } from './types';\nimport { MENTION_CLASS_COMBINED_QUERY, MENTION_CLASS_IN_INPUT, TEXT_MESSAGE_CLASS } from './consts';\nimport {\n  createPasteNode,\n  hasMention,\n  domToMessageTemplate,\n  getUsersFromWords,\n  extractTextFromNodes,\n} from './utils';\n\n// conditions to test:\n// 1. paste simple text\n// 2. paste text with mention\n// 3. paste text with mention and text\n// 4. paste text with mention and text and paste again before and after\n// 5. copy message with mention(only one mention, no other text) and paste\n// 6. copy message with mention from input and paste(before and after)\nexport default function usePaste({\n  ref,\n  setIsInput,\n  setHeight,\n  channel,\n  setMentionedUsers,\n}: DynamicProps): (e: React.ClipboardEvent<HTMLDivElement>) => void {\n  return useCallback((e) => {\n    e.preventDefault();\n    const html = e?.clipboardData.getData('text/html');\n    // simple text, continue as normal\n    if (!html) {\n      const text = e?.clipboardData.getData('text');\n      document.execCommand('insertHTML', false, sanitizeString(text));\n      setIsInput(true);\n      setHeight();\n      return;\n    }\n\n    // has html, check if there are mentions, sanitize and insert\n    const purifier = DOMPurify(window);\n    const clean = purifier.sanitize(html);\n    const pasteNode = createPasteNode();\n    pasteNode.innerHTML = clean;\n    // does not have mention, continue as normal\n    if (!hasMention(pasteNode)) {\n      // to preserve space between words\n      const text = extractTextFromNodes(Array.from(pasteNode.children) as HTMLSpanElement[]);\n      document.execCommand('insertHTML', false, sanitizeString(text));\n      pasteNode.remove();\n      setIsInput(true);\n      setHeight();\n      return;\n    }\n\n    // has mention, sanitize and insert\n    let childNodes = pasteNode.querySelectorAll(`.${TEXT_MESSAGE_CLASS}`) as NodeListOf<HTMLSpanElement>;\n    if (pasteNode.querySelectorAll(`.${MENTION_CLASS_IN_INPUT}`).length > 0) {\n      // @ts-ignore\n      childNodes = pasteNode.children;\n    }\n    let nodeArray = Array.from(childNodes);\n    // handle paste when there is only one child\n    if (pasteNode.children.length === 1 && pasteNode.querySelectorAll(MENTION_CLASS_COMBINED_QUERY).length === 1) {\n      nodeArray = Array.from(pasteNode.children) as HTMLSpanElement[];\n    }\n    const words = domToMessageTemplate(nodeArray);\n\n    const mentionedUsers = getUsersFromWords(words, channel);\n    setMentionedUsers(mentionedUsers);\n    inserTemplateToDOM(words);\n    pasteNode.remove();\n    setIsInput(true);\n    setHeight();\n    return;\n\n  }, [ref, setIsInput, setHeight, channel, setMentionedUsers]);\n}\n","import React, {\n  useRef,\n  useMemo,\n  useState,\n  useEffect,\n  useCallback,\n  useContext,\n} from 'react';\nimport { renderToString } from 'react-dom/server';\nimport PropTypes from 'prop-types';\n\nimport './index.scss';\nimport { MessageInputKeys, NodeNames, NodeTypes } from './const';\n\nimport { USER_MENTION_TEMP_CHAR } from '../../smart-components/Channel/context/const';\nimport IconButton from '../IconButton';\nimport Button, { ButtonTypes, ButtonSizes } from '../Button';\nimport MentionUserLabel from '../MentionUserLabel';\nimport Icon, { IconTypes, IconColors } from '../Icon';\nimport Label, { LabelTypography, LabelColors } from '../Label';\nimport { LocalizationContext } from '../../lib/LocalizationContext';\nimport { sanitizeString } from './utils';\nimport {\n  arrayEqual,\n  getClassName,\n  StringObjType,\n  convertWordToStringObj,\n} from '../../utils';\nimport usePaste from './hooks/usePaste';\n\nconst TEXT_FIELD_ID = 'sendbird-message-input-text-field';\nconst LINE_HEIGHT = 76;\nconst noop = () => { };\nconst handleUploadFile = (callback) => (event) => {\n  if (event.target.files && event.target.files[0]) {\n    callback(event.target.files[0]);\n  }\n  // eslint-disable-next-line no-param-reassign\n  event.target.value = '';\n};\n\nconst displayCaret = (element, position) => {\n  const range = document.createRange();\n  const sel = window.getSelection();\n  range.setStart(element.childNodes[0], position);\n  range.collapse(true);\n  sel.removeAllRanges();\n  sel.addRange(range);\n  element.focus();\n}\n\nconst resetInput = (ref) => {\n  try {\n    ref.current.innerHTML = '';\n  } catch {\n    //\n  }\n}\n\nconst initialTargetStringInfo = {\n  targetString: '',\n  startNodeIndex: null,\n  startOffsetIndex: null,\n  endNodeIndex: null,\n  endOffsetIndex: null,\n};\n\nconst MessageInput = React.forwardRef((props, ref) => {\n  const {\n    className,\n    messageFieldId,\n    isEdit,\n    isMentionEnabled,\n    isVoiceMessageEnabled,\n    disabled,\n    message,\n    placeholder,\n    maxLength,\n    onFileUpload,\n    onSendMessage,\n    onUpdateMessage,\n    onCancelEdit,\n    onStartTyping,\n    channelUrl,\n    channel,\n    mentionSelectedUser,\n    onUserMentioned,\n    onMentionStringChange,\n    onMentionedUserIdsUpdated,\n    onVoiceMessageIconClick,\n    onKeyUp,\n    onKeyDown,\n    renderFileUploadIcon,\n    renderVoiceMessageIcon,\n    renderSendMessageIcon,\n    setMentionedUsers,\n  } = props;\n  const textFieldId = messageFieldId || TEXT_FIELD_ID;\n  const { stringSet } = useContext(LocalizationContext);\n  const fileInputRef = useRef(null);\n  const [isInput, setIsInput] = useState(false);\n  const [mentionedUserIds, setMentionedUserIds] = useState([]);\n  const [targetStringInfo, setTargetStringInfo] = useState({ ...initialTargetStringInfo });\n  const setHeight = useMemo(() => (\n    () => {\n      try {\n        const elem = ref?.current;\n        const MAX_HEIGHT = window.document.body.offsetHeight * 0.6;\n        if (elem && elem.scrollHeight >= LINE_HEIGHT) {\n          if (MAX_HEIGHT < elem.scrollHeight) {\n            elem.style.height = 'auto';\n            elem.style.height = `${MAX_HEIGHT}px`;\n          } else {\n            elem.style.height = 'auto';\n            elem.style.height = `${elem.scrollHeight}px`;\n          }\n        } else {\n          elem.style.height = '';\n        }\n      } catch (error) {\n        // error\n      }\n    }\n  ), []);\n\n  // #Edit mode\n  // for easilly initialize input value from outside, but\n  // useEffect(_, [channelUrl]) erase it\n  const initialValue = props?.value;\n  useEffect(() => {\n    const textField = ref?.current;\n    try {\n      textField.innerHTML = initialValue;\n      displayCaret(textField, initialValue?.length);\n    } catch { }\n    setMentionedUserIds([]);\n    setIsInput(textField?.innerText?.length > 0);\n    setHeight();\n  }, [initialValue]);\n\n  // #Mention | Clear input value when channel changes\n  useEffect(() => {\n    if (!isEdit) {\n      setIsInput(false);\n      resetInput(ref);\n    }\n  }, [channelUrl]);\n\n  // #Mention & #Edit | Fill message input values\n  useEffect(() => {\n    if (isEdit && message?.messageId) {\n      // const textField = document.getElementById(textFieldId);\n      const textField = ref?.current;\n      if (isMentionEnabled\n        && message?.mentionedUsers?.length > 0\n        && message?.mentionedMessageTemplate?.length > 0\n      ) {\n        /* mention enabled */\n        const { mentionedUsers = [] } = message;\n        textField.innerHTML = message?.mentionedMessageTemplate?.split(' ').map((word) => (\n          convertWordToStringObj(word, mentionedUsers).map((stringObj) => {\n            const { type, value, userId } = stringObj;\n            if (type === StringObjType.mention && mentionedUsers.some((user) => user?.userId === userId)) {\n              return renderToString(\n                <MentionUserLabel userId={userId}>\n                  {\n                    `${USER_MENTION_TEMP_CHAR}${mentionedUsers.find((user) => user?.userId === userId)?.nickname\n                    || value\n                    || stringSet.MENTION_NAME__NO_NAME\n                    }`\n                  }\n                </MentionUserLabel>,\n              );\n            }\n            return sanitizeString(value);\n          }).join('')\n        )).join(' ');\n      } else {\n        /* mention disabled */\n        try {\n          textField.innerHTML = sanitizeString(message?.message);\n        } catch { }\n        setMentionedUserIds([]);\n      }\n      setIsInput(textField?.innerText?.length > 0);\n      setHeight();\n    }\n  }, [isEdit, message]);\n\n  // #Mention | Detect MentionedLabel modified\n  const useMentionedLabelDetection = useCallback(() => {\n    const textField = ref?.current;\n    if (isMentionEnabled) {\n      const newMentionedUserIds = [...textField.getElementsByClassName('sendbird-mention-user-label')].map((node) => node?.dataset?.userid);\n      if (!arrayEqual(mentionedUserIds, newMentionedUserIds) || newMentionedUserIds.length === 0) {\n        onMentionedUserIdsUpdated(newMentionedUserIds);\n        setMentionedUserIds(newMentionedUserIds);\n      }\n    }\n    setIsInput(textField.innerText.length > 0);\n  }, [targetStringInfo, isMentionEnabled]);\n\n  // #Mention | Replace selected user nickname to the MentionedUserLabel\n  useEffect(() => {\n    if (isMentionEnabled && mentionSelectedUser) {\n      const {\n        targetString,\n        startNodeIndex,\n        startOffsetIndex,\n        endNodeIndex,\n        endOffsetIndex,\n      } = targetStringInfo;\n      if (targetString && startNodeIndex !== null && startOffsetIndex !== null) {\n        // const textField = document.getElementById(textFieldId);\n        const textField = ref?.current;\n        const childNodes = [...textField?.childNodes];\n        const frontTextNode = document?.createTextNode(\n          childNodes[startNodeIndex]?.textContent.slice(0, startOffsetIndex),\n        );\n        const backTextNode = document?.createTextNode(\n          `\\u00A0${childNodes[endNodeIndex]?.textContent.slice(endOffsetIndex)}`,\n        );\n        const mentionLabel = renderToString(\n          <MentionUserLabel userId={mentionSelectedUser?.userId}>\n            {`${USER_MENTION_TEMP_CHAR}${mentionSelectedUser?.nickname || stringSet.MENTION_NAME__NO_NAME}`}\n          </MentionUserLabel>,\n        );\n        const div = document.createElement('div');\n        div.innerHTML = mentionLabel;\n        const newNodes = [\n          ...childNodes.slice(0, startNodeIndex),\n          frontTextNode,\n          div.childNodes[0],\n          backTextNode,\n          ...childNodes.slice(endNodeIndex + 1),\n        ];\n        textField.innerHTML = '';\n        newNodes.forEach((newNode) => {\n          textField.appendChild(newNode);\n        });\n        onUserMentioned(mentionSelectedUser);\n        if (window.getSelection || document.getSelection) {\n          // set caret postion\n          const selection = window.getSelection() || document.getSelection();\n          selection.removeAllRanges();\n          const range = new Range();\n          range.selectNodeContents(textField);\n          range.setStart(textField.childNodes[startNodeIndex + 2], 1);\n          range.setEnd(textField.childNodes[startNodeIndex + 2], 1);\n          range.collapse(false);\n          selection.addRange(range);\n          textField.focus();\n        }\n        setTargetStringInfo({ ...initialTargetStringInfo });\n        setHeight();\n        useMentionedLabelDetection();\n      }\n    }\n  }, [mentionSelectedUser, isMentionEnabled]);\n\n  // #Mention | Detect mentioning user nickname\n  const useMentionInputDetection = useCallback(() => {\n    const selection = window?.getSelection?.() || document?.getSelection?.();\n    const textField = ref?.current;\n    if (selection.anchorNode === textField) {\n      onMentionStringChange('');\n    }\n    if (isMentionEnabled && selection\n      && selection.anchorNode === selection.focusNode\n      && selection.anchorOffset === selection.focusOffset\n    ) {\n      let textStack = '';\n      let startNodeIndex = null;\n      let startOffsetIndex = null;\n      for (let index = 0; index < textField.childNodes.length; index += 1) {\n        const currentNode = textField.childNodes[index];\n        if (currentNode.nodeType === NodeTypes.TextNode) {\n          /* text node */\n          const textContent = (currentNode === selection.anchorNode)\n            ? currentNode?.textContent.slice(0, selection.anchorOffset) || ''\n            : currentNode?.textContent || '';\n          if (textStack.length > 0) {\n            textStack += textContent;\n          } else {\n            let charLastIndex = textContent.lastIndexOf(USER_MENTION_TEMP_CHAR);\n            for (let i = charLastIndex - 1; i > -1; i -= 1) {\n              if (textContent[i] === USER_MENTION_TEMP_CHAR) {\n                charLastIndex = i;\n              } else {\n                break;\n              }\n            }\n            if (charLastIndex > -1) {\n              textStack = textContent;\n              startNodeIndex = index;\n              startOffsetIndex = charLastIndex;\n            }\n          }\n        } else {\n          /* other nodes */\n          textStack = '';\n          startNodeIndex = null;\n          startOffsetIndex = null;\n        }\n        if (currentNode === selection.anchorNode) {\n          /**\n           * targetString could be ''\n           * startNodeIndex and startOffsetIndex could be null\n           */\n          const targetString = textStack ? textStack.slice(startOffsetIndex) : '';// include template character\n          setTargetStringInfo({\n            targetString,\n            startNodeIndex,\n            startOffsetIndex,\n            endNodeIndex: index,\n            endOffsetIndex: selection.anchorOffset,\n          });\n          onMentionStringChange(targetString);\n          return;\n        }\n      }\n    }\n  }, [isMentionEnabled]);\n\n  const sendMessage = () => {\n    const textField = ref?.current;\n    if (!isEdit && textField?.innerText) {\n      let messageText = '';\n      let mentionTemplate = '';\n      textField.childNodes.forEach((node) => {\n        if (node.nodeType === NodeTypes.ElementNode && node.nodeName === NodeNames.Span) {\n          const { innerText, dataset = {} } = node;\n          const { userid = '' } = dataset;\n          messageText += innerText;\n          mentionTemplate += `${USER_MENTION_TEMP_CHAR}{${userid}}`;\n        } else if (node.nodeType === NodeTypes.ElementNode && node.nodeName === NodeNames.Br) {\n          messageText += '\\n';\n          mentionTemplate += '\\n';\n        } else { // other nodes including text node\n          const { textContent = '' } = node;\n          messageText += textContent;\n          mentionTemplate += textContent;\n        }\n      });\n      const params = { message: messageText, mentionTemplate };\n      onSendMessage(params);\n      resetInput(ref);\n      setIsInput(false);\n      setHeight();\n    }\n  };\n  const isEditDisabled = !(ref?.current?.innerText?.trim());\n  const editMessage = () => {\n    const textField = ref?.current;\n    const messageId = message?.messageId;\n    if (isEdit && messageId) {\n      let messageText = '';\n      let mentionTemplate = '';\n      textField.childNodes.forEach((node) => {\n        if (node.nodeType === NodeTypes.ElementNode && node.nodeName === NodeNames.Span) {\n          const { innerText, dataset = {} } = node;\n          const { userid = '' } = dataset;\n          messageText += innerText;\n          mentionTemplate += `${USER_MENTION_TEMP_CHAR}{${userid}}`;\n        } else if (node.nodeType === NodeTypes.ElementNode && node.nodeName === NodeNames.Span) {\n          messageText += '\\n';\n          mentionTemplate += '\\n';\n        } else { // other nodes including text node\n          const { textContent = '' } = node;\n          messageText += textContent;\n          mentionTemplate += textContent;\n        }\n      });\n      const params = { messageId, message: messageText, mentionTemplate };\n      onUpdateMessage(params);\n      resetInput(ref);\n    }\n  };\n  const onPaste = usePaste({\n    ref,\n    setMentionedUserIds,\n    setMentionedUsers,\n    channel,\n    setIsInput,\n    setHeight,\n  });\n\n  return (\n    <form\n      className={getClassName([\n        className,\n        isEdit ? 'sendbird-message-input__edit' : '',\n        disabled ? 'sendbird-message-input-form__disabled' : '',\n      ])}\n    >\n      <div\n        className={getClassName([\n          'sendbird-message-input',\n          disabled ? 'sendbird-message-input__disabled' : '',\n        ])}\n      >\n        <div\n          id={`${textFieldId}${isEdit ? message?.messageId : ''}`}\n          className={`sendbird-message-input--textarea ${textFieldId}`}\n          contentEditable={!disabled}\n          role=\"textbox\"\n          aria-label=\"Text Input\"\n          disabled={disabled}\n          ref={ref}\n          maxLength={maxLength}\n          onKeyDown={(e) => {\n            const preventEvent = onKeyDown(e);\n            if (preventEvent) {\n              e.preventDefault();\n            } else {\n              if (!e.shiftKey && e.key === MessageInputKeys.Enter && e?.nativeEvent?.isComposing !== true) {\n                e.preventDefault();\n                sendMessage();\n              }\n              if (e.key === MessageInputKeys.Backspace\n                && ref?.current?.childNodes?.length === 2\n                && !ref?.current?.childNodes?.[0]?.textContent\n                && ref?.current.childNodes?.[1]?.nodeType === NodeTypes.ElementNode\n              ) {\n                ref?.current.removeChild(ref?.current.childNodes[1]);\n              }\n            }\n          }}\n          onKeyUp={(e) => {\n            const preventEvent = onKeyUp(e);\n            if (preventEvent) {\n              e.preventDefault();\n            } else {\n              useMentionInputDetection();\n            }\n          }}\n          onClick={() => {\n            useMentionInputDetection();\n          }}\n          onInput={() => {\n            setHeight();\n            onStartTyping();\n            setIsInput(ref?.current?.innerText?.length > 0);\n            useMentionedLabelDetection();\n          }}\n          onPaste={onPaste}\n        />\n        {/* placeholder */}\n        {!isInput && (\n          <Label\n            className=\"sendbird-message-input--placeholder\"\n            type={LabelTypography.BODY_1}\n            color={disabled? LabelColors.ONBACKGROUND_4 : LabelColors.ONBACKGROUND_3}\n          >\n            {placeholder || stringSet.MESSAGE_INPUT__PLACE_HOLDER}\n          </Label>\n        )}\n        {/* send icon */}\n        {\n          (!isEdit && isInput) && (\n            <IconButton\n              className=\"sendbird-message-input--send\"\n              height=\"32px\"\n              width=\"32px\"\n              onClick={() => sendMessage()}\n            >\n              {\n                renderSendMessageIcon?.() || (\n                  <Icon\n                    type={IconTypes.SEND}\n                    fillColor={disabled ? IconColors.ON_BACKGROUND_4 : IconColors.PRIMARY}\n                    width=\"20px\"\n                    height=\"20px\"\n                  />\n                )\n              }\n            </IconButton>\n          )\n        }\n        {/* file upload icon */}\n        {\n          (!isEdit && !isInput) && (\n            (renderFileUploadIcon?.() || (\n              <IconButton\n                className={`sendbird-message-input--attach ${isVoiceMessageEnabled ? 'is-voice-message-enabled' : ''}`}\n                height=\"32px\"\n                width=\"32px\"\n                onClick={() => {\n                  // todo: clear previous input\n                  fileInputRef?.current?.click?.();\n                }}\n              >\n                <Icon\n                  type={IconTypes.ATTACH}\n                  fillColor={disabled ? IconColors.ON_BACKGROUND_4 : IconColors.CONTENT_INVERSE}\n                  width=\"20px\"\n                  height=\"20px\"\n                />\n                <input\n                  className=\"sendbird-message-input--attach-input\"\n                  type=\"file\"\n                  ref={fileInputRef}\n                  onChange={handleUploadFile(onFileUpload)}\n                />\n              </IconButton>\n            ))\n          )\n        }\n        {/* voice message input trigger */}\n        {(isVoiceMessageEnabled && !isEdit && !isInput) && (\n          <IconButton\n            className=\"sendbird-message-input--voice-message\"\n            width=\"32px\"\n            height=\"32px\"\n            onClick={onVoiceMessageIconClick}\n          >\n            {\n              renderVoiceMessageIcon?.() || (\n                <Icon\n                  type={IconTypes.AUDIO_ON_LINED}\n                  fillColor={disabled ? IconColors.ON_BACKGROUND_4 : IconColors.CONTENT_INVERSE}\n                  width=\"20px\"\n                  height=\"20px\"\n                />\n              )\n            }\n          </IconButton>\n        )}\n      </div>\n      {/* Edit */}\n      {\n        isEdit && (\n          <div className=\"sendbird-message-input--edit-action\">\n            <Button\n              className=\"sendbird-message-input--edit-action__cancel\"\n              type={ButtonTypes.SECONDARY}\n              size={ButtonSizes.SMALL}\n              onClick={onCancelEdit}\n            >\n              {stringSet.BUTTON__CANCEL}\n            </Button>\n            <Button\n              className=\"sendbird-message-input--edit-action__save\"\n              type={ButtonTypes.PRIMARY}\n              size={ButtonSizes.SMALL}\n              disabled={isEditDisabled}\n              onClick={() => editMessage()}\n            >\n              {stringSet.BUTTON__SAVE}\n            </Button>\n          </div>\n        )\n      }\n    </form>\n  );\n});\n\nMessageInput.propTypes = {\n  className: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.arrayOf(PropTypes.string),\n  ]),\n  messageFieldId: PropTypes.string,\n  placeholder: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.bool,\n  ]),\n  value: PropTypes.string,\n  isEdit: PropTypes.bool,\n  isMentionEnabled: PropTypes.bool,\n  isVoiceMessageEnabled: PropTypes.bool,\n  onVoiceMessageIconClick: PropTypes.func,\n  message: PropTypes.shape({\n    messageId: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n    message: PropTypes.string,\n    mentionedMessageTemplate: PropTypes.string,\n    mentionedUsers: PropTypes.arrayOf(PropTypes.shape({})),\n  }),\n  disabled: PropTypes.bool,\n  maxLength: PropTypes.number,\n  onFileUpload: PropTypes.func,\n  onSendMessage: PropTypes.func,\n  onUpdateMessage: PropTypes.func,\n  onStartTyping: PropTypes.func,\n  onCancelEdit: PropTypes.func,\n  channelUrl: PropTypes.string,\n  mentionSelectedUser: PropTypes.shape({\n    userId: PropTypes.string,\n    nickname: PropTypes.string,\n  }),\n  setMentionedUsers: PropTypes.func,\n  onUserMentioned: PropTypes.func,\n  onMentionStringChange: PropTypes.func,\n  onMentionedUserIdsUpdated: PropTypes.func,\n  onKeyUp: PropTypes.func,\n  onKeyDown: PropTypes.func,\n};\n\nMessageInput.defaultProps = {\n  className: '',\n  messageFieldId: '',\n  channelUrl: '',\n  onSendMessage: noop,\n  onUpdateMessage: noop,\n  value: null,\n  message: null,\n  isEdit: false,\n  isMentionEnabled: false,\n  isVoiceMessageEnabled: true,\n  onVoiceMessageIconClick: noop,\n  disabled: false,\n  placeholder: '',\n  maxLength: 5000,\n  onFileUpload: noop,\n  onCancelEdit: noop,\n  onStartTyping: noop,\n  mentionSelectedUser: null,\n  onUserMentioned: noop,\n  onMentionStringChange: noop,\n  onMentionedUserIdsUpdated: noop,\n  onKeyUp: noop,\n  onKeyDown: noop,\n};\n\nexport default MessageInput;\n"],"names":["sanitizeString","str","replace","i","concat","charCodeAt","inserTemplateToDOM","templateList","nodes","map","template","text","userId","renderToString","React","join","document","execCommand","PASTE_NODE","TEXT_MESSAGE_CLASS","MENTION_CLASS","MENTION_CLASS_IN_INPUT","MENTION_CLASS_COMBINED_QUERY","createPasteNode","pasteNode","body","querySelector","remove","node","createElement","id","style","display","hasMention","parent","extractTextFromNodes","forEach","textNodes","querySelectorAll","length","Array","from","innerText","domToMessageTemplate","nodeArray","templates","reduce","accumulator","currentValue","mentionNode","classList","contains","_a","dataset","userid","__spreadArray","getUsersFromWords","channel","userMap","users","members","find","user","Object","values","usePaste","ref","setIsInput","setHeight","setMentionedUsers","useCallback","e","preventDefault","html","clipboardData","getData","purifier","DOMPurify","window","clean","sanitize","innerHTML","children","childNodes","words","mentionedUsers","TEXT_FIELD_ID","LINE_HEIGHT","noop","handleUploadFile","callback","event","target","files","value","displayCaret","element","position","range","createRange","sel","getSelection","setStart","collapse","removeAllRanges","addRange","focus","resetInput","current","initialTargetStringInfo","targetString","startNodeIndex","startOffsetIndex","endNodeIndex","endOffsetIndex","MessageInput","forwardRef","props","className","messageFieldId","isEdit","isMentionEnabled","isVoiceMessageEnabled","disabled","message","placeholder","maxLength","onFileUpload","onSendMessage","onUpdateMessage","onCancelEdit","onStartTyping","channelUrl","mentionSelectedUser","onUserMentioned","onMentionStringChange","onMentionedUserIdsUpdated","onVoiceMessageIconClick","onKeyUp","onKeyDown","renderFileUploadIcon","renderVoiceMessageIcon","renderSendMessageIcon","textFieldId","stringSet","useContext","LocalizationContext","fileInputRef","useRef","isInput","useState","mentionedUserIds","setMentionedUserIds","targetStringInfo","setTargetStringInfo","_objectSpread","useMemo","elem","MAX_HEIGHT","offsetHeight","scrollHeight","height","error","initialValue","useEffect","textField","messageId","mentionedMessageTemplate","split","word","convertWordToStringObj","stringObj","type","StringObjType","mention","some","USER_MENTION_TEMP_CHAR","nickname","MENTION_NAME__NO_NAME","useMentionedLabelDetection","newMentionedUserIds","getElementsByClassName","arrayEqual","frontTextNode","createTextNode","textContent","slice","backTextNode","mentionLabel","div","newNodes","newNode","appendChild","selection","Range","selectNodeContents","setEnd","useMentionInputDetection","anchorNode","focusNode","anchorOffset","focusOffset","textStack","index","currentNode","nodeType","NodeTypes","TextNode","charLastIndex","lastIndexOf","sendMessage","messageText","mentionTemplate","ElementNode","nodeName","NodeNames","Span","Br","params","isEditDisabled","trim","editMessage","onPaste","getClassName","preventEvent","shiftKey","key","MessageInputKeys","Enter","nativeEvent","isComposing","Backspace","removeChild","LabelTypography","BODY_1","LabelColors","ONBACKGROUND_4","ONBACKGROUND_3","MESSAGE_INPUT__PLACE_HOLDER","IconTypes","SEND","IconColors","ON_BACKGROUND_4","PRIMARY","click","ATTACH","CONTENT_INVERSE","AUDIO_ON_LINED","ButtonTypes","SECONDARY","ButtonSizes","SMALL","BUTTON__CANCEL","BUTTON__SAVE","propTypes","PropTypes","oneOfType","string","arrayOf","bool","func","shape","number","defaultProps"],"mappings":"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"}
\ No newline at end of file
+{"version":3,"file":"MessageInput.js","sources":["../../src/ui/MessageInput/utils.js","../../src/ui/MessageInput/hooks/usePaste/insertTemplate.tsx","../../src/ui/MessageInput/hooks/usePaste/consts.ts","../../src/ui/MessageInput/hooks/usePaste/utils.ts","../../src/ui/MessageInput/hooks/usePaste/index.ts","../../src/ui/MessageInput/index.jsx"],"sourcesContent":["// https://davidwalsh.name/javascript-debounce-function\n// Returns a function, that, as long as it continues to be invoked, will not\n// be triggered. The function will be called after it stops being called for\n// N milliseconds. If `immediate` is passed, trigger the function on the\n// leading edge, instead of the trailing.\nexport function debounce(func, wait, immediate) {\n  let timeout;\n  return function _debounce() {\n    const context = this;\n    // eslint-disable-next-line prefer-rest-params\n    const args = arguments;\n    const later = () => {\n      timeout = null;\n      if (!immediate) func.apply(context, args);\n    };\n    const callNow = immediate && !timeout;\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n    if (callNow) func.apply(context, args);\n  };\n}\n\n// Sanitize that special characters of HTML tags cause XSS issue\nexport const sanitizeString = (str) => (\n  str?.replace(/[\\u00A0-\\u9999<>]/gim, (i) => ''.concat('&#', i.charCodeAt(0), ';'))\n);\n\nexport default debounce;\n","import React from 'react';\nimport { renderToString } from 'react-dom/server.js';\n\nimport { Word } from './types';\nimport { sanitizeString } from '../../utils';\nimport MentionUserLabel from '../../../MentionUserLabel';\n\nexport function inserTemplateToDOM(templateList: Word[]): void {\n  const nodes = templateList.map((template) => {\n    const { text, userId } = template;\n    if (userId) {\n      return (\n        renderToString(\n          <>\n            <MentionUserLabel userId={userId}>\n              {text}\n            </MentionUserLabel>\n          </>\n        )\n      );\n    }\n    return sanitizeString(text);\n  })\n  .join(' ')\n  // add a space at the end of the mention, else cursor/caret wont work\n  .concat(' ');\n  document.execCommand('insertHTML', false, nodes);\n}\n","export const PASTE_NODE = 'sendbird-uikit__paste-node';\nexport const TEXT_MESSAGE_CLASS = 'sendbird-word';\nexport const MENTION_CLASS = 'sendbird-word__mention';\nexport const MENTION_CLASS_IN_INPUT = 'sendbird-mention-user-label';\nexport const MENTION_CLASS_COMBINED_QUERY = `.${MENTION_CLASS}, .${MENTION_CLASS_IN_INPUT}`;\n","import { GroupChannel } from '@sendbird/chat/groupChannel';\nimport { User } from '@sendbird/chat';\n\nimport {\n  PASTE_NODE,\n  MENTION_CLASS,\n  TEXT_MESSAGE_CLASS,\n  MENTION_CLASS_COMBINED_QUERY,\n  MENTION_CLASS_IN_INPUT,\n} from './consts';\nimport { Word } from './types';\n\nexport function createPasteNode(): HTMLDivElement | null {\n  const pasteNode = document.body.querySelector(`#${PASTE_NODE}`);\n  // remove existing paste node\n  if (pasteNode) {\n    pasteNode?.remove();\n  }\n\n  // create new paste node and return\n  const node = document.createElement('div');\n  node.id = PASTE_NODE;\n  node.style.display = 'none';\n  return node;\n}\n\nexport function hasMention(parent: HTMLDivElement): boolean {\n  return parent?.querySelector(MENTION_CLASS_COMBINED_QUERY) ? true : false;\n}\n\nexport const extractTextFromNodes = (nodes: HTMLSpanElement[]): string => {\n  let text = '';\n  nodes.forEach((node) => {\n    // to preserve space between words\n    const textNodes = node.querySelectorAll(`.${TEXT_MESSAGE_CLASS}`);\n    if (textNodes.length > 0) {\n      text += ((extractTextFromNodes(Array.from(textNodes) as HTMLSpanElement[])) + ' ');\n    }\n    text += (node.innerText + ' ');\n  });\n  return text;\n}\n\nexport function domToMessageTemplate(nodeArray: HTMLSpanElement[]): Word[] {\n  const templates: Word[] = nodeArray?.reduce((accumulator, currentValue) => {\n    let mentionNode = currentValue.querySelector(MENTION_CLASS_COMBINED_QUERY) as HTMLSpanElement;\n    // sometimes the mention node is the parent node\n    // in this case querySelector will return null\n    if (!mentionNode) {\n      mentionNode = (\n        currentValue.classList.contains(MENTION_CLASS)  // for nodes copied from message\n        || currentValue.classList.contains(MENTION_CLASS_IN_INPUT) // for nodes copied from input\n      ) ? currentValue : null;\n    }\n    const text = currentValue.innerText;\n    if (mentionNode) {\n      const userId = mentionNode.dataset?.userid;\n      return [\n        ...accumulator,\n        {\n          text,\n          userId,\n        },\n      ];\n    }\n\n    return [\n      ...accumulator,\n      {\n        text,\n      },\n    ];\n  }, [] as Word[]);\n  return templates;\n}\n\nexport function getUsersFromWords(templates: Word[], channel: GroupChannel): User[] {\n  const userMap = {};\n  const users = channel.members;\n  templates.forEach((template) => {\n    if (template.userId) {\n      userMap[template.userId] = users.find((user) => user.userId === template.userId);\n    }\n  });\n  return Object.values(userMap);\n}\n","import { useCallback } from 'react';\nimport DOMPurify from 'dompurify';\n\nimport { inserTemplateToDOM } from './insertTemplate';\nimport { sanitizeString } from '../../utils';\nimport { DynamicProps } from './types';\nimport { MENTION_CLASS_COMBINED_QUERY, MENTION_CLASS_IN_INPUT, TEXT_MESSAGE_CLASS } from './consts';\nimport {\n  createPasteNode,\n  hasMention,\n  domToMessageTemplate,\n  getUsersFromWords,\n  extractTextFromNodes,\n} from './utils';\n\n// conditions to test:\n// 1. paste simple text\n// 2. paste text with mention\n// 3. paste text with mention and text\n// 4. paste text with mention and text and paste again before and after\n// 5. copy message with mention(only one mention, no other text) and paste\n// 6. copy message with mention from input and paste(before and after)\nexport default function usePaste({\n  ref,\n  setIsInput,\n  setHeight,\n  channel,\n  setMentionedUsers,\n}: DynamicProps): (e: React.ClipboardEvent<HTMLDivElement>) => void {\n  return useCallback((e) => {\n    e.preventDefault();\n    const html = e?.clipboardData.getData('text/html');\n    // simple text, continue as normal\n    if (!html) {\n      const text = e?.clipboardData.getData('text');\n      document.execCommand('insertHTML', false, sanitizeString(text));\n      setIsInput(true);\n      setHeight();\n      return;\n    }\n\n    // has html, check if there are mentions, sanitize and insert\n    const purifier = DOMPurify(window);\n    const clean = purifier.sanitize(html);\n    const pasteNode = createPasteNode();\n    pasteNode.innerHTML = clean;\n    // does not have mention, continue as normal\n    if (!hasMention(pasteNode)) {\n      // to preserve space between words\n      const text = extractTextFromNodes(Array.from(pasteNode.children) as HTMLSpanElement[]);\n      document.execCommand('insertHTML', false, sanitizeString(text));\n      pasteNode.remove();\n      setIsInput(true);\n      setHeight();\n      return;\n    }\n\n    // has mention, sanitize and insert\n    let childNodes = pasteNode.querySelectorAll(`.${TEXT_MESSAGE_CLASS}`) as NodeListOf<HTMLSpanElement>;\n    if (pasteNode.querySelectorAll(`.${MENTION_CLASS_IN_INPUT}`).length > 0) {\n      // @ts-ignore\n      childNodes = pasteNode.children;\n    }\n    let nodeArray = Array.from(childNodes);\n    // handle paste when there is only one child\n    if (pasteNode.children.length === 1 && pasteNode.querySelectorAll(MENTION_CLASS_COMBINED_QUERY).length === 1) {\n      nodeArray = Array.from(pasteNode.children) as HTMLSpanElement[];\n    }\n    const words = domToMessageTemplate(nodeArray);\n\n    const mentionedUsers = getUsersFromWords(words, channel);\n    setMentionedUsers(mentionedUsers);\n    inserTemplateToDOM(words);\n    pasteNode.remove();\n    setIsInput(true);\n    setHeight();\n    return;\n\n  }, [ref, setIsInput, setHeight, channel, setMentionedUsers]);\n}\n","import React, {\n  useRef,\n  useMemo,\n  useState,\n  useEffect,\n  useCallback,\n  useContext,\n} from 'react';\nimport { renderToString } from 'react-dom/server';\nimport PropTypes from 'prop-types';\n\nimport './index.scss';\nimport { MessageInputKeys, NodeNames, NodeTypes } from './const';\n\nimport { USER_MENTION_TEMP_CHAR } from '../../smart-components/Channel/context/const';\nimport IconButton from '../IconButton';\nimport Button, { ButtonTypes, ButtonSizes } from '../Button';\nimport MentionUserLabel from '../MentionUserLabel';\nimport Icon, { IconTypes, IconColors } from '../Icon';\nimport Label, { LabelTypography, LabelColors } from '../Label';\nimport { LocalizationContext } from '../../lib/LocalizationContext';\nimport { sanitizeString } from './utils';\nimport {\n  arrayEqual,\n  getClassName,\n  StringObjType,\n  convertWordToStringObj,\n} from '../../utils';\nimport usePaste from './hooks/usePaste';\n\nconst TEXT_FIELD_ID = 'sendbird-message-input-text-field';\nconst LINE_HEIGHT = 76;\nconst noop = () => { };\nconst handleUploadFile = (callback) => (event) => {\n  if (event.target.files && event.target.files[0]) {\n    callback(event.target.files[0]);\n  }\n  // eslint-disable-next-line no-param-reassign\n  event.target.value = '';\n};\n\nconst displayCaret = (element, position) => {\n  const range = document.createRange();\n  const sel = window.getSelection();\n  range.setStart(element.childNodes[0], position);\n  range.collapse(true);\n  sel.removeAllRanges();\n  sel.addRange(range);\n  element.focus();\n}\n\nconst resetInput = (ref) => {\n  try {\n    ref.current.innerHTML = '';\n  } catch {\n    //\n  }\n}\n\nconst initialTargetStringInfo = {\n  targetString: '',\n  startNodeIndex: null,\n  startOffsetIndex: null,\n  endNodeIndex: null,\n  endOffsetIndex: null,\n};\n\nconst MessageInput = React.forwardRef((props, ref) => {\n  const {\n    className,\n    messageFieldId,\n    isEdit,\n    isMentionEnabled,\n    isVoiceMessageEnabled,\n    disabled,\n    message,\n    placeholder,\n    maxLength,\n    onFileUpload,\n    onSendMessage,\n    onUpdateMessage,\n    onCancelEdit,\n    onStartTyping,\n    channelUrl,\n    channel,\n    mentionSelectedUser,\n    onUserMentioned,\n    onMentionStringChange,\n    onMentionedUserIdsUpdated,\n    onVoiceMessageIconClick,\n    onKeyUp,\n    onKeyDown,\n    renderFileUploadIcon,\n    renderVoiceMessageIcon,\n    renderSendMessageIcon,\n    setMentionedUsers,\n  } = props;\n  const textFieldId = messageFieldId || TEXT_FIELD_ID;\n  const { stringSet } = useContext(LocalizationContext);\n  const fileInputRef = useRef(null);\n  const [isInput, setIsInput] = useState(false);\n  const [mentionedUserIds, setMentionedUserIds] = useState([]);\n  const [targetStringInfo, setTargetStringInfo] = useState({ ...initialTargetStringInfo });\n  const setHeight = useMemo(() => (\n    () => {\n      try {\n        const elem = ref?.current;\n        const MAX_HEIGHT = window.document.body.offsetHeight * 0.6;\n        if (elem && elem.scrollHeight >= LINE_HEIGHT) {\n          if (MAX_HEIGHT < elem.scrollHeight) {\n            elem.style.height = 'auto';\n            elem.style.height = `${MAX_HEIGHT}px`;\n          } else {\n            elem.style.height = 'auto';\n            elem.style.height = `${elem.scrollHeight}px`;\n          }\n        } else {\n          elem.style.height = '';\n        }\n      } catch (error) {\n        // error\n      }\n    }\n  ), []);\n\n  // #Edit mode\n  // for easilly initialize input value from outside, but\n  // useEffect(_, [channelUrl]) erase it\n  const initialValue = props?.value;\n  useEffect(() => {\n    const textField = ref?.current;\n    try {\n      textField.innerHTML = initialValue;\n      displayCaret(textField, initialValue?.length);\n    } catch { }\n    setMentionedUserIds([]);\n    setIsInput(textField?.innerText?.length > 0);\n    setHeight();\n  }, [initialValue]);\n\n  // #Mention | Clear input value when channel changes\n  useEffect(() => {\n    if (!isEdit) {\n      setIsInput(false);\n      resetInput(ref);\n    }\n  }, [channelUrl]);\n\n  // #Mention & #Edit | Fill message input values\n  useEffect(() => {\n    if (isEdit && message?.messageId) {\n      // const textField = document.getElementById(textFieldId);\n      const textField = ref?.current;\n      if (isMentionEnabled\n        && message?.mentionedUsers?.length > 0\n        && message?.mentionedMessageTemplate?.length > 0\n      ) {\n        /* mention enabled */\n        const { mentionedUsers = [] } = message;\n        textField.innerHTML = message?.mentionedMessageTemplate?.split(' ').map((word) => (\n          convertWordToStringObj(word, mentionedUsers).map((stringObj) => {\n            const { type, value, userId } = stringObj;\n            if (type === StringObjType.mention && mentionedUsers.some((user) => user?.userId === userId)) {\n              return renderToString(\n                <MentionUserLabel userId={userId}>\n                  {\n                    `${USER_MENTION_TEMP_CHAR}${mentionedUsers.find((user) => user?.userId === userId)?.nickname\n                    || value\n                    || stringSet.MENTION_NAME__NO_NAME\n                    }`\n                  }\n                </MentionUserLabel>,\n              );\n            }\n            return sanitizeString(value);\n          }).join('')\n        )).join(' ');\n      } else {\n        /* mention disabled */\n        try {\n          textField.innerHTML = sanitizeString(message?.message);\n        } catch { }\n        setMentionedUserIds([]);\n      }\n      setIsInput(textField?.innerText?.length > 0);\n      setHeight();\n    }\n  }, [isEdit, message]);\n\n  // #Mention | Detect MentionedLabel modified\n  const useMentionedLabelDetection = useCallback(() => {\n    const textField = ref?.current;\n    if (isMentionEnabled) {\n      const newMentionedUserIds = [...textField.getElementsByClassName('sendbird-mention-user-label')].map((node) => node?.dataset?.userid);\n      if (!arrayEqual(mentionedUserIds, newMentionedUserIds) || newMentionedUserIds.length === 0) {\n        onMentionedUserIdsUpdated(newMentionedUserIds);\n        setMentionedUserIds(newMentionedUserIds);\n      }\n    }\n    setIsInput(textField.innerText.length > 0);\n  }, [targetStringInfo, isMentionEnabled]);\n\n  // #Mention | Replace selected user nickname to the MentionedUserLabel\n  useEffect(() => {\n    if (isMentionEnabled && mentionSelectedUser) {\n      const {\n        targetString,\n        startNodeIndex,\n        startOffsetIndex,\n        endNodeIndex,\n        endOffsetIndex,\n      } = targetStringInfo;\n      if (targetString && startNodeIndex !== null && startOffsetIndex !== null) {\n        // const textField = document.getElementById(textFieldId);\n        const textField = ref?.current;\n        const childNodes = [...textField?.childNodes];\n        const frontTextNode = document?.createTextNode(\n          childNodes[startNodeIndex]?.textContent.slice(0, startOffsetIndex),\n        );\n        const backTextNode = document?.createTextNode(\n          `\\u00A0${childNodes[endNodeIndex]?.textContent.slice(endOffsetIndex)}`,\n        );\n        const mentionLabel = renderToString(\n          <MentionUserLabel userId={mentionSelectedUser?.userId}>\n            {`${USER_MENTION_TEMP_CHAR}${mentionSelectedUser?.nickname || stringSet.MENTION_NAME__NO_NAME}`}\n          </MentionUserLabel>,\n        );\n        const div = document.createElement('div');\n        div.innerHTML = mentionLabel;\n        const newNodes = [\n          ...childNodes.slice(0, startNodeIndex),\n          frontTextNode,\n          div.childNodes[0],\n          backTextNode,\n          ...childNodes.slice(endNodeIndex + 1),\n        ];\n        textField.innerHTML = '';\n        newNodes.forEach((newNode) => {\n          textField.appendChild(newNode);\n        });\n        onUserMentioned(mentionSelectedUser);\n        if (window.getSelection || document.getSelection) {\n          // set caret postion\n          const selection = window.getSelection() || document.getSelection();\n          selection.removeAllRanges();\n          const range = new Range();\n          range.selectNodeContents(textField);\n          range.setStart(textField.childNodes[startNodeIndex + 2], 1);\n          range.setEnd(textField.childNodes[startNodeIndex + 2], 1);\n          range.collapse(false);\n          selection.addRange(range);\n          textField.focus();\n        }\n        setTargetStringInfo({ ...initialTargetStringInfo });\n        setHeight();\n        useMentionedLabelDetection();\n      }\n    }\n  }, [mentionSelectedUser, isMentionEnabled]);\n\n  // #Mention | Detect mentioning user nickname\n  const useMentionInputDetection = useCallback(() => {\n    const selection = window?.getSelection?.() || document?.getSelection?.();\n    const textField = ref?.current;\n    if (selection.anchorNode === textField) {\n      onMentionStringChange('');\n    }\n    if (isMentionEnabled && selection\n      && selection.anchorNode === selection.focusNode\n      && selection.anchorOffset === selection.focusOffset\n    ) {\n      let textStack = '';\n      let startNodeIndex = null;\n      let startOffsetIndex = null;\n      for (let index = 0; index < textField.childNodes.length; index += 1) {\n        const currentNode = textField.childNodes[index];\n        if (currentNode.nodeType === NodeTypes.TextNode) {\n          /* text node */\n          const textContent = (currentNode === selection.anchorNode)\n            ? currentNode?.textContent.slice(0, selection.anchorOffset) || ''\n            : currentNode?.textContent || '';\n          if (textStack.length > 0) {\n            textStack += textContent;\n          } else {\n            let charLastIndex = textContent.lastIndexOf(USER_MENTION_TEMP_CHAR);\n            for (let i = charLastIndex - 1; i > -1; i -= 1) {\n              if (textContent[i] === USER_MENTION_TEMP_CHAR) {\n                charLastIndex = i;\n              } else {\n                break;\n              }\n            }\n            if (charLastIndex > -1) {\n              textStack = textContent;\n              startNodeIndex = index;\n              startOffsetIndex = charLastIndex;\n            }\n          }\n        } else {\n          /* other nodes */\n          textStack = '';\n          startNodeIndex = null;\n          startOffsetIndex = null;\n        }\n        if (currentNode === selection.anchorNode) {\n          /**\n           * targetString could be ''\n           * startNodeIndex and startOffsetIndex could be null\n           */\n          const targetString = textStack ? textStack.slice(startOffsetIndex) : '';// include template character\n          setTargetStringInfo({\n            targetString,\n            startNodeIndex,\n            startOffsetIndex,\n            endNodeIndex: index,\n            endOffsetIndex: selection.anchorOffset,\n          });\n          onMentionStringChange(targetString);\n          return;\n        }\n      }\n    }\n  }, [isMentionEnabled]);\n\n  const sendMessage = () => {\n    const textField = ref?.current;\n    if (!isEdit && textField?.innerText) {\n      let messageText = '';\n      let mentionTemplate = '';\n      textField.childNodes.forEach((node) => {\n        if (node.nodeType === NodeTypes.ElementNode && node.nodeName === NodeNames.Span) {\n          const { innerText, dataset = {} } = node;\n          const { userid = '' } = dataset;\n          messageText += innerText;\n          mentionTemplate += `${USER_MENTION_TEMP_CHAR}{${userid}}`;\n        } else if (node.nodeType === NodeTypes.ElementNode && node.nodeName === NodeNames.Br) {\n          messageText += '\\n';\n          mentionTemplate += '\\n';\n        } else { // other nodes including text node\n          const { textContent = '' } = node;\n          messageText += textContent;\n          mentionTemplate += textContent;\n        }\n      });\n      const params = { message: messageText, mentionTemplate };\n      onSendMessage(params);\n      resetInput(ref);\n      setIsInput(false);\n      setHeight();\n    }\n  };\n  const isEditDisabled = !(ref?.current?.innerText?.trim());\n  const editMessage = () => {\n    const textField = ref?.current;\n    const messageId = message?.messageId;\n    if (isEdit && messageId) {\n      let messageText = '';\n      let mentionTemplate = '';\n      textField.childNodes.forEach((node) => {\n        if (node.nodeType === NodeTypes.ElementNode && node.nodeName === NodeNames.Span) {\n          const { innerText, dataset = {} } = node;\n          const { userid = '' } = dataset;\n          messageText += innerText;\n          mentionTemplate += `${USER_MENTION_TEMP_CHAR}{${userid}}`;\n        } else if (node.nodeType === NodeTypes.ElementNode && node.nodeName === NodeNames.Span) {\n          messageText += '\\n';\n          mentionTemplate += '\\n';\n        } else { // other nodes including text node\n          const { textContent = '' } = node;\n          messageText += textContent;\n          mentionTemplate += textContent;\n        }\n      });\n      const params = { messageId, message: messageText, mentionTemplate };\n      onUpdateMessage(params);\n      resetInput(ref);\n    }\n  };\n  const onPaste = usePaste({\n    ref,\n    setMentionedUserIds,\n    setMentionedUsers,\n    channel,\n    setIsInput,\n    setHeight,\n  });\n\n  return (\n    <form\n      className={getClassName([\n        className,\n        isEdit ? 'sendbird-message-input__edit' : '',\n        disabled ? 'sendbird-message-input-form__disabled' : '',\n      ])}\n    >\n      <div\n        className={getClassName([\n          'sendbird-message-input',\n          disabled ? 'sendbird-message-input__disabled' : '',\n        ])}\n      >\n        <div\n          id={`${textFieldId}${isEdit ? message?.messageId : ''}`}\n          className={`sendbird-message-input--textarea ${textFieldId}`}\n          contentEditable={!disabled}\n          role=\"textbox\"\n          aria-label=\"Text Input\"\n          disabled={disabled}\n          ref={ref}\n          maxLength={maxLength}\n          onKeyDown={(e) => {\n            const preventEvent = onKeyDown(e);\n            if (preventEvent) {\n              e.preventDefault();\n            } else {\n              if (!e.shiftKey && e.key === MessageInputKeys.Enter && e?.nativeEvent?.isComposing !== true) {\n                e.preventDefault();\n                sendMessage();\n              }\n              if (e.key === MessageInputKeys.Backspace\n                && ref?.current?.childNodes?.length === 2\n                && !ref?.current?.childNodes?.[0]?.textContent\n                && ref?.current.childNodes?.[1]?.nodeType === NodeTypes.ElementNode\n              ) {\n                ref?.current.removeChild(ref?.current.childNodes[1]);\n              }\n            }\n          }}\n          onKeyUp={(e) => {\n            const preventEvent = onKeyUp(e);\n            if (preventEvent) {\n              e.preventDefault();\n            } else {\n              useMentionInputDetection();\n            }\n          }}\n          onClick={() => {\n            useMentionInputDetection();\n          }}\n          onInput={() => {\n            setHeight();\n            onStartTyping();\n            setIsInput(ref?.current?.innerText?.length > 0);\n            useMentionedLabelDetection();\n          }}\n          onPaste={onPaste}\n        />\n        {/* placeholder */}\n        {!isInput && (\n          <Label\n            className=\"sendbird-message-input--placeholder\"\n            type={LabelTypography.BODY_1}\n            color={disabled? LabelColors.ONBACKGROUND_4 : LabelColors.ONBACKGROUND_3}\n          >\n            {placeholder || stringSet.MESSAGE_INPUT__PLACE_HOLDER}\n          </Label>\n        )}\n        {/* send icon */}\n        {\n          (!isEdit && isInput) && (\n            <IconButton\n              className=\"sendbird-message-input--send\"\n              height=\"32px\"\n              width=\"32px\"\n              onClick={() => sendMessage()}\n            >\n              {\n                renderSendMessageIcon?.() || (\n                  <Icon\n                    type={IconTypes.SEND}\n                    fillColor={disabled ? IconColors.ON_BACKGROUND_4 : IconColors.PRIMARY}\n                    width=\"20px\"\n                    height=\"20px\"\n                  />\n                )\n              }\n            </IconButton>\n          )\n        }\n        {/* file upload icon */}\n        {\n          (!isEdit && !isInput) && (\n            (renderFileUploadIcon?.() || (\n              <IconButton\n                className={`sendbird-message-input--attach ${isVoiceMessageEnabled ? 'is-voice-message-enabled' : ''}`}\n                height=\"32px\"\n                width=\"32px\"\n                onClick={() => {\n                  // todo: clear previous input\n                  fileInputRef?.current?.click?.();\n                }}\n              >\n                <Icon\n                  type={IconTypes.ATTACH}\n                  fillColor={disabled ? IconColors.ON_BACKGROUND_4 : IconColors.CONTENT_INVERSE}\n                  width=\"20px\"\n                  height=\"20px\"\n                />\n                <input\n                  className=\"sendbird-message-input--attach-input\"\n                  type=\"file\"\n                  ref={fileInputRef}\n                  onChange={handleUploadFile(onFileUpload)}\n                />\n              </IconButton>\n            ))\n          )\n        }\n        {/* voice message input trigger */}\n        {(isVoiceMessageEnabled && !isEdit && !isInput) && (\n          <IconButton\n            className=\"sendbird-message-input--voice-message\"\n            width=\"32px\"\n            height=\"32px\"\n            onClick={onVoiceMessageIconClick}\n          >\n            {\n              renderVoiceMessageIcon?.() || (\n                <Icon\n                  type={IconTypes.AUDIO_ON_LINED}\n                  fillColor={disabled ? IconColors.ON_BACKGROUND_4 : IconColors.CONTENT_INVERSE}\n                  width=\"20px\"\n                  height=\"20px\"\n                />\n              )\n            }\n          </IconButton>\n        )}\n      </div>\n      {/* Edit */}\n      {\n        isEdit && (\n          <div className=\"sendbird-message-input--edit-action\">\n            <Button\n              className=\"sendbird-message-input--edit-action__cancel\"\n              type={ButtonTypes.SECONDARY}\n              size={ButtonSizes.SMALL}\n              onClick={onCancelEdit}\n            >\n              {stringSet.BUTTON__CANCEL}\n            </Button>\n            <Button\n              className=\"sendbird-message-input--edit-action__save\"\n              type={ButtonTypes.PRIMARY}\n              size={ButtonSizes.SMALL}\n              disabled={isEditDisabled}\n              onClick={() => editMessage()}\n            >\n              {stringSet.BUTTON__SAVE}\n            </Button>\n          </div>\n        )\n      }\n    </form>\n  );\n});\n\nMessageInput.propTypes = {\n  className: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.arrayOf(PropTypes.string),\n  ]),\n  messageFieldId: PropTypes.string,\n  placeholder: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.bool,\n  ]),\n  value: PropTypes.string,\n  isEdit: PropTypes.bool,\n  isMentionEnabled: PropTypes.bool,\n  isVoiceMessageEnabled: PropTypes.bool,\n  onVoiceMessageIconClick: PropTypes.func,\n  message: PropTypes.shape({\n    messageId: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n    message: PropTypes.string,\n    mentionedMessageTemplate: PropTypes.string,\n    mentionedUsers: PropTypes.arrayOf(PropTypes.shape({})),\n  }),\n  disabled: PropTypes.bool,\n  maxLength: PropTypes.number,\n  onFileUpload: PropTypes.func,\n  onSendMessage: PropTypes.func,\n  onUpdateMessage: PropTypes.func,\n  onStartTyping: PropTypes.func,\n  onCancelEdit: PropTypes.func,\n  channelUrl: PropTypes.string,\n  mentionSelectedUser: PropTypes.shape({\n    userId: PropTypes.string,\n    nickname: PropTypes.string,\n  }),\n  setMentionedUsers: PropTypes.func,\n  onUserMentioned: PropTypes.func,\n  onMentionStringChange: PropTypes.func,\n  onMentionedUserIdsUpdated: PropTypes.func,\n  onKeyUp: PropTypes.func,\n  onKeyDown: PropTypes.func,\n};\n\nMessageInput.defaultProps = {\n  className: '',\n  messageFieldId: '',\n  channelUrl: '',\n  onSendMessage: noop,\n  onUpdateMessage: noop,\n  value: null,\n  message: null,\n  isEdit: false,\n  isMentionEnabled: false,\n  isVoiceMessageEnabled: true,\n  onVoiceMessageIconClick: noop,\n  disabled: false,\n  placeholder: '',\n  maxLength: 5000,\n  onFileUpload: noop,\n  onCancelEdit: noop,\n  onStartTyping: noop,\n  mentionSelectedUser: null,\n  onUserMentioned: noop,\n  onMentionStringChange: noop,\n  onMentionedUserIdsUpdated: noop,\n  onKeyUp: noop,\n  onKeyDown: noop,\n};\n\nexport default MessageInput;\n"],"names":["sanitizeString","str","replace","i","concat","charCodeAt","inserTemplateToDOM","templateList","nodes","map","template","text","userId","renderToString","React","join","document","execCommand","PASTE_NODE","TEXT_MESSAGE_CLASS","MENTION_CLASS","MENTION_CLASS_IN_INPUT","MENTION_CLASS_COMBINED_QUERY","createPasteNode","pasteNode","body","querySelector","remove","node","createElement","id","style","display","hasMention","parent","extractTextFromNodes","forEach","textNodes","querySelectorAll","length","Array","from","innerText","domToMessageTemplate","nodeArray","templates","reduce","accumulator","currentValue","mentionNode","classList","contains","_a","dataset","userid","__spreadArray","getUsersFromWords","channel","userMap","users","members","find","user","Object","values","usePaste","ref","setIsInput","setHeight","setMentionedUsers","useCallback","e","preventDefault","html","clipboardData","getData","purifier","DOMPurify","window","clean","sanitize","innerHTML","children","childNodes","words","mentionedUsers","TEXT_FIELD_ID","LINE_HEIGHT","noop","handleUploadFile","callback","event","target","files","value","displayCaret","element","position","range","createRange","sel","getSelection","setStart","collapse","removeAllRanges","addRange","focus","resetInput","current","initialTargetStringInfo","targetString","startNodeIndex","startOffsetIndex","endNodeIndex","endOffsetIndex","MessageInput","forwardRef","props","className","messageFieldId","isEdit","isMentionEnabled","isVoiceMessageEnabled","disabled","message","placeholder","maxLength","onFileUpload","onSendMessage","onUpdateMessage","onCancelEdit","onStartTyping","channelUrl","mentionSelectedUser","onUserMentioned","onMentionStringChange","onMentionedUserIdsUpdated","onVoiceMessageIconClick","onKeyUp","onKeyDown","renderFileUploadIcon","renderVoiceMessageIcon","renderSendMessageIcon","textFieldId","stringSet","useContext","LocalizationContext","fileInputRef","useRef","isInput","useState","mentionedUserIds","setMentionedUserIds","targetStringInfo","setTargetStringInfo","_objectSpread","useMemo","elem","MAX_HEIGHT","offsetHeight","scrollHeight","height","error","initialValue","useEffect","textField","messageId","mentionedMessageTemplate","split","word","convertWordToStringObj","stringObj","type","StringObjType","mention","some","USER_MENTION_TEMP_CHAR","nickname","MENTION_NAME__NO_NAME","useMentionedLabelDetection","newMentionedUserIds","getElementsByClassName","arrayEqual","frontTextNode","createTextNode","textContent","slice","backTextNode","mentionLabel","div","newNodes","newNode","appendChild","selection","Range","selectNodeContents","setEnd","useMentionInputDetection","anchorNode","focusNode","anchorOffset","focusOffset","textStack","index","currentNode","nodeType","NodeTypes","TextNode","charLastIndex","lastIndexOf","sendMessage","messageText","mentionTemplate","ElementNode","nodeName","NodeNames","Span","Br","params","isEditDisabled","trim","editMessage","onPaste","getClassName","preventEvent","shiftKey","key","MessageInputKeys","Enter","nativeEvent","isComposing","Backspace","removeChild","LabelTypography","BODY_1","LabelColors","ONBACKGROUND_4","ONBACKGROUND_3","MESSAGE_INPUT__PLACE_HOLDER","IconTypes","SEND","IconColors","ON_BACKGROUND_4","PRIMARY","click","ATTACH","CONTENT_INVERSE","AUDIO_ON_LINED","ButtonTypes","SECONDARY","ButtonSizes","SMALL","BUTTON__CANCEL","BUTTON__SAVE","propTypes","PropTypes","oneOfType","string","arrayOf","bool","func","shape","number","defaultProps"],"mappings":"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"}
\ No newline at end of file
